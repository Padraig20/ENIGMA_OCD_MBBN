[I 2025-02-17 22:15:51,891] A new study created in memory with name: no-name-d9afbb16-8379-487a-8727-2429b9242791
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 95.71 MB
max cached memory: 116.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:09<10:10,  9.54s/it]  3%|▎         | 2/65 [00:11<05:02,  4.80s/it]  5%|▍         | 3/65 [00:12<03:24,  3.30s/it]  6%|▌         | 4/65 [00:13<02:19,  2.28s/it]  8%|▊         | 5/65 [00:13<01:39,  1.66s/it]  9%|▉         | 6/65 [00:14<01:15,  1.28s/it] 11%|█         | 7/65 [00:14<01:00,  1.04s/it] 12%|█▏        | 8/65 [00:15<00:50,  1.13it/s] 14%|█▍        | 9/65 [00:15<00:43,  1.29it/s] 15%|█▌        | 10/65 [00:16<00:43,  1.26it/s] 17%|█▋        | 11/65 [00:17<00:38,  1.39it/s] 18%|█▊        | 12/65 [00:17<00:35,  1.50it/s] 20%|██        | 13/65 [00:18<00:32,  1.58it/s] 22%|██▏       | 14/65 [00:19<00:30,  1.65it/s] 23%|██▎       | 15/65 [00:19<00:29,  1.70it/s] 25%|██▍       | 16/65 [00:20<00:28,  1.74it/s] 26%|██▌       | 17/65 [00:20<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:21<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:21<00:25,  1.79it/s] 31%|███       | 20/65 [00:22<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:23<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:23<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:24<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:24<00:22,  1.78it/s] 38%|███▊      | 25/65 [00:25<00:22,  1.80it/s] 40%|████      | 26/65 [00:25<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:26<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:26<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:27<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:28<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:28<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:29<00:19,  1.74it/s] 51%|█████     | 33/65 [00:29<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:30<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:30<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:31<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:31<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:32<00:14,  1.82it/s] 60%|██████    | 39/65 [00:33<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:33<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:34<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:34<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:35<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:35<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:36<00:11,  1.80it/s] 71%|███████   | 46/65 [00:37<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:37<00:09,  1.81it/s] 74%|███████▍  | 48/65 [00:38<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:38<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:39<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:39<00:08,  1.71it/s] 80%|████████  | 52/65 [00:40<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:41<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:41<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:42<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:42<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:43<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:43<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:44<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:45<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:45<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:46<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:46<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:47<00:00,  1.79it/s]100%|██████████| 65/65 [00:47<00:00,  1.80it/s]100%|██████████| 65/65 [00:47<00:00,  1.36it/s]

______epoch summary 1/3_____

mask_train: 2.2199590829702522
spatial_difference_train: 24.12882602398212
total_train: 26.3487850189209
time taken to perform 1: 47.83
Starting epoch 2/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:58,  4.67s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:11<00:29,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:31,  1.61it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.66it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:14<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:15<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.62it/s] 40%|████      | 26/65 [00:19<00:23,  1.67it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.71it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.62it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.68it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.74it/s] 60%|██████    | 39/65 [00:26<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.63it/s] 71%|███████   | 46/65 [00:30<00:11,  1.68it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.81it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.81it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.81it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.82it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.82it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 1.6813233100450955
spatial_difference_train: 23.729910967900203
total_train: 25.411234268775353
time taken to perform 2: 41.74
Starting epoch 3/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.28s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.47it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.63it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.68it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 1.398864781245207
spatial_difference_train: 23.323044263399563
total_train: 24.721908989930764
time taken to perform 3: 41.89
[26.3487850189209, 25.411234268775353, 24.721908989930764]
Using minimum loss from history: 24.721908989930764
[I 2025-02-17 22:18:07,407] Trial 0 finished with value: 24.721908989930764 and parameters: {'lr_init_phase2': 1.1722434965317574e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0008774428153941636, 'lr_gamma_phase2': 0.9809049978333773, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1200}. Best is trial 0 with value: 24.721908989930764.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_221555-wpils2v3
wandb: Find logs at: ./wandb/offline-run-20250217_221555-wpils2v3/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:56,  4.63s/it]  3%|▎         | 2/65 [00:05<02:24,  2.29s/it]  5%|▍         | 3/65 [00:05<01:33,  1.51s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.48it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.57it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:13<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.80it/s] 29%|██▉       | 19/65 [00:14<00:25,  1.80it/s] 31%|███       | 20/65 [00:15<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:16<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:17<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:21<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:25<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:29<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:30<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:32<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:33<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:38<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.58it/s]

______epoch summary 1/3_____

mask_train: 1.9848023542991051
spatial_difference_train: 23.968719130295973
total_train: 25.953521317702073
time taken to perform 1: 41.20
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:13,  4.89s/it]  3%|▎         | 2/65 [00:05<02:31,  2.41s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.72it/s] 20%|██        | 13/65 [00:11<00:29,  1.75it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.77it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.64it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.69it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.77it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.78it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.67it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.71it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 1.4773004463085762
spatial_difference_train: 23.39705643287072
total_train: 24.87435676868145
time taken to perform 2: 41.58
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.28s/it]  3%|▎         | 2/65 [00:05<02:38,  2.51s/it]  5%|▍         | 3/65 [00:06<01:40,  1.63s/it]  6%|▌         | 4/65 [00:07<01:14,  1.21s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.51it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.59it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.70it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 1.2187317719826332
spatial_difference_train: 22.847150323329828
total_train: 24.06588200300168
time taken to perform 3: 41.67
[25.953521317702073, 24.87435676868145, 24.06588200300168]
Using minimum loss from history: 24.06588200300168
[I 2025-02-17 22:20:13,625] Trial 1 finished with value: 24.06588200300168 and parameters: {'lr_init_phase2': 1.672024701971242e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.008973730005458112, 'lr_gamma_phase2': 0.9351511336908593, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 1300}. Best is trial 1 with value: 24.06588200300168.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_221807-1gbdopn1
wandb: Find logs at: ./wandb/offline-run-20250217_221807-1gbdopn1/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<04:59,  4.69s/it]  3%|▎         | 2/65 [00:05<02:39,  2.54s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]finished warmup
  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 2.141154540502108
spatial_difference_train: 24.073128509521485
total_train: 26.214283018845776
time taken to perform 1: 41.57
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:05,  4.77s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<01:02,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 1.7437813208653377
spatial_difference_train: 23.844476949251614
total_train: 25.588258244441107
time taken to perform 2: 41.87
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:30,  5.17s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:42,  1.35it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.57it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 1.5527027741456643
spatial_difference_train: 23.694603602091473
total_train: 25.247306344447992
time taken to perform 3: 41.62
[26.214283018845776, 25.588258244441107, 25.247306344447992]
Using minimum loss from history: 25.247306344447992
[I 2025-02-17 22:22:20,494] Trial 2 finished with value: 25.247306344447992 and parameters: {'lr_init_phase2': 2.169344753604355e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0001014871873311902, 'lr_gamma_phase2': 0.9203720962569288, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 800}. Best is trial 1 with value: 24.06588200300168.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_222013-7867fe5p
wandb: Find logs at: ./wandb/offline-run-20250217_222013-7867fe5p/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:14,  4.92s/it]  3%|▎         | 2/65 [00:05<02:31,  2.41s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:48,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:15<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.505981393960806
spatial_difference_train: 23.287765414898214
total_train: 24.793746830866887
time taken to perform 1: 41.61
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:10,  4.84s/it]  3%|▎         | 2/65 [00:05<02:42,  2.57s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:06<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<01:03,  1.06s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 1.1865254438840427
spatial_difference_train: 22.665511556772085
total_train: 23.852037004324107
time taken to perform 2: 41.93
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:12,  5.83s/it]  3%|▎         | 2/65 [00:06<02:52,  2.74s/it]  5%|▍         | 3/65 [00:06<01:48,  1.75s/it]  6%|▌         | 4/65 [00:07<01:18,  1.28s/it]  8%|▊         | 5/65 [00:08<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:09<00:44,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:11<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:12<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.70it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.80it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:16<00:27,  1.67it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.71it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:20<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:21<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:22<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.75it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:25<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.82it/s] 60%|██████    | 39/65 [00:27<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:31<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.81it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.81it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 1.0341676919888227
spatial_difference_train: 22.286331333258214
total_train: 23.320499019133738
time taken to perform 3: 41.96
[24.793746830866887, 23.852037004324107, 23.320499019133738]
Using minimum loss from history: 23.320499019133738
[I 2025-02-17 22:24:27,677] Trial 3 finished with value: 23.320499019133738 and parameters: {'lr_init_phase2': 6.090601611387484e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0009609909815159225, 'lr_gamma_phase2': 0.9451609484668305, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 1800}. Best is trial 3 with value: 23.320499019133738.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_222220-u2bc301t
wandb: Find logs at: ./wandb/offline-run-20250217_222220-u2bc301t/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:17,  4.95s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.81it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.67it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.81it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:32<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 1/3_____

mask_train: 2.5153121544764594
spatial_difference_train: 24.24390106201172
total_train: 26.75921322749211
time taken to perform 1: 41.45
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.32s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.64it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.65it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 2.1532032654835627
spatial_difference_train: 24.114420700073243
total_train: 26.267623945382926
time taken to perform 2: 42.06
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:59,  5.62s/it]  3%|▎         | 2/65 [00:06<02:47,  2.65s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:16,  1.26s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:09<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.79it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 1.9540774736648951
spatial_difference_train: 24.029120724017805
total_train: 25.983198205018656
time taken to perform 3: 42.06
[26.75921322749211, 26.267623945382926, 25.983198205018656]
Using minimum loss from history: 25.983198205018656
[I 2025-02-17 22:26:35,059] Trial 4 finished with value: 25.983198205018656 and parameters: {'lr_init_phase2': 1.284869449205551e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0023138641714912063, 'lr_gamma_phase2': 0.9201710765494341, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 400}. Best is trial 3 with value: 23.320499019133738.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_222427-376buyph
wandb: Find logs at: ./wandb/offline-run-20250217_222427-376buyph/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.91s/it]  3%|▎         | 2/65 [00:05<02:29,  2.37s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:48,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.59it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:15<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:25<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:29<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.81it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:32<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.71it/s] 80%|████████  | 52/65 [00:33<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.81it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.58it/s]

______epoch summary 1/3_____

mask_train: 1.7799810042748085
spatial_difference_train: 23.756999646700347
total_train: 25.536980526263896
time taken to perform 1: 41.27
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:27,  5.12s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.76it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.77it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.63it/s] 71%|███████   | 46/65 [00:31<00:11,  1.68it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 1.309715345272651
spatial_difference_train: 22.986257655803975
total_train: 24.295972970815804
time taken to perform 2: 41.89
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:57,  5.59s/it]  3%|▎         | 2/65 [00:06<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:45,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:09<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.70it/s] 23%|██▎       | 15/65 [00:13<00:29,  1.72it/s] 25%|██▍       | 16/65 [00:14<00:28,  1.74it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.75it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.76it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.67it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.71it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.73it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.74it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.74it/s] 40%|████      | 26/65 [00:20<00:22,  1.76it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.77it/s] 43%|████▎     | 28/65 [00:21<00:20,  1.77it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.63it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.71it/s] 51%|█████     | 33/65 [00:24<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.75it/s] 54%|█████▍    | 35/65 [00:25<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.77it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:28<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:30<00:12,  1.75it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:31<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:33<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 3/3_____

mask_train: 1.074437212332701
spatial_difference_train: 22.29113179720365
total_train: 23.365569002200395
time taken to perform 3: 42.34
[25.536980526263896, 24.295972970815804, 23.365569002200395]
Using minimum loss from history: 23.365569002200395
[I 2025-02-17 22:28:42,363] Trial 5 finished with value: 23.365569002200395 and parameters: {'lr_init_phase2': 2.3203528099028477e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.005801381550226112, 'lr_gamma_phase2': 0.9075135706967907, 'lr_step_phase2': 4000, 'lr_warmup_phase2': 900}. Best is trial 3 with value: 23.320499019133738.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_222635-3tqwjeqc
wandb: Find logs at: ./wandb/offline-run-20250217_222635-3tqwjeqc/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<04:58,  4.66s/it]  3%|▎         | 2/65 [00:05<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:16,  1.26s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]finished warmup
  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.47it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.078946771988502
spatial_difference_train: 20.763435657207783
total_train: 21.842382431030273
time taken to perform 1: 41.77
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:28,  5.13s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<01:02,  1.05s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.61it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.81it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.67it/s] 71%|███████   | 46/65 [00:31<00:11,  1.71it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.74it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.78it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.80it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.81it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.67it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.71it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.80it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.829235431781182
spatial_difference_train: 19.48184859936054
total_train: 20.31108405773456
time taken to perform 2: 41.84
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.95s/it]  3%|▎         | 2/65 [00:05<02:29,  2.38s/it]  5%|▍         | 3/65 [00:06<01:36,  1.55s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:42,  1.36it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.48it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.57it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.51it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:15<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:32<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 3/3_____

mask_train: 0.7288523563971886
spatial_difference_train: 18.817761846689077
total_train: 19.54661420186361
time taken to perform 3: 41.42
[21.842382431030273, 20.31108405773456, 19.54661420186361]
Using minimum loss from history: 19.54661420186361
[I 2025-02-17 22:30:49,130] Trial 6 finished with value: 19.54661420186361 and parameters: {'lr_init_phase2': 0.00022669686002118336, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0014140810451737753, 'lr_gamma_phase2': 0.9002040343338874, 'lr_step_phase2': 5000, 'lr_warmup_phase2': 1100}. Best is trial 6 with value: 19.54661420186361.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_222842-fbucvt5h
wandb: Find logs at: ./wandb/offline-run-20250217_222842-fbucvt5h/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:07,  4.80s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 1/3_____

mask_train: 0.9561658446605389
spatial_difference_train: 19.985383605957033
total_train: 20.94154941852276
time taken to perform 1: 41.48
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.36s/it]  3%|▎         | 2/65 [00:05<02:40,  2.54s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.77it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.81it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.81it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.82it/s]100%|██████████| 65/65 [00:41<00:00,  1.67it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7382986339238974
spatial_difference_train: 17.991615456801195
total_train: 18.72991404900184
time taken to perform 2: 41.96
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:49,  5.47s/it]  3%|▎         | 2/65 [00:06<02:43,  2.59s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6303425437364822
spatial_difference_train: 16.816528467031624
total_train: 17.44687095055213
time taken to perform 3: 42.01
[20.94154941852276, 18.72991404900184, 17.44687095055213]
Using minimum loss from history: 17.44687095055213
[I 2025-02-17 22:32:56,325] Trial 7 finished with value: 17.44687095055213 and parameters: {'lr_init_phase2': 0.00019294051230230746, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00013974937080757686, 'lr_gamma_phase2': 0.919491531284208, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 2000}. Best is trial 7 with value: 17.44687095055213.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_223049-ol157ltz
wandb: Find logs at: ./wandb/offline-run-20250217_223049-ol157ltz/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:16,  4.95s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.73it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9906293337161725
spatial_difference_train: 20.565495857825645
total_train: 21.556125053992638
time taken to perform 1: 41.56
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.19s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<01:02,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:12<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.71it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.80it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.81it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.67it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.71it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.78it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.80it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.81it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.67it/s] 71%|███████   | 46/65 [00:30<00:11,  1.71it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.74it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.78it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.80it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.81it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.67it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.71it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.80it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.81it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.67it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7568707936085187
spatial_difference_train: 18.62135481467614
total_train: 19.37822553194486
time taken to perform 2: 41.68
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:51,  5.50s/it]  3%|▎         | 2/65 [00:06<02:44,  2.60s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:31,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.71it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.75it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.76it/s] 40%|████      | 26/65 [00:19<00:22,  1.77it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.78it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.78it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.73it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:25<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:31<00:10,  1.77it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.77it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.78it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.78it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.63it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.68it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 3/3_____

mask_train: 0.6445014053430312
spatial_difference_train: 17.42974657890124
total_train: 18.074247922652805
time taken to perform 3: 42.18
[21.556125053992638, 19.37822553194486, 18.074247922652805]
Using minimum loss from history: 18.074247922652805
[I 2025-02-17 22:35:03,621] Trial 8 finished with value: 18.074247922652805 and parameters: {'lr_init_phase2': 0.0001553037929166341, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.000603117283311924, 'lr_gamma_phase2': 0.9690786366116868, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1500}. Best is trial 7 with value: 17.44687095055213.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_223256-cmw2thgy
wandb: Find logs at: ./wandb/offline-run-20250217_223256-cmw2thgy/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:59,  4.67s/it]  3%|▎         | 2/65 [00:05<02:27,  2.35s/it]  5%|▍         | 3/65 [00:05<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:42,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:11<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.70it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.75it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:15<00:27,  1.62it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.67it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.70it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.73it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.75it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.76it/s] 40%|████      | 26/65 [00:19<00:22,  1.77it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.78it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.78it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.63it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.71it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.77it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.63it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:30<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.75it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.8442366178219134
spatial_difference_train: 23.830322265625
total_train: 25.674558962308442
time taken to perform 1: 41.65
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:56,  5.56s/it]  3%|▎         | 2/65 [00:06<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:16,  1.26s/it]  8%|▊         | 5/65 [00:08<01:04,  1.08s/it]  9%|▉         | 6/65 [00:08<00:53,  1.11it/s] 11%|█         | 7/65 [00:09<00:45,  1.27it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.40it/s] 14%|█▍        | 9/65 [00:10<00:37,  1.50it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.58it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.64it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.69it/s] 20%|██        | 13/65 [00:12<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.74it/s] 23%|██▎       | 15/65 [00:13<00:31,  1.60it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.66it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.70it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.72it/s] 29%|██▉       | 19/65 [00:16<00:26,  1.74it/s] 31%|███       | 20/65 [00:16<00:25,  1.76it/s] 32%|███▏      | 21/65 [00:17<00:24,  1.77it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.78it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.63it/s] 40%|████      | 26/65 [00:20<00:23,  1.68it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.71it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.75it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.76it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.78it/s] 51%|█████     | 33/65 [00:24<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.63it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.68it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.71it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.74it/s] 60%|██████    | 39/65 [00:27<00:14,  1.75it/s] 62%|██████▏   | 40/65 [00:28<00:14,  1.77it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.78it/s] 65%|██████▍   | 42/65 [00:29<00:12,  1.78it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:31<00:12,  1.64it/s] 71%|███████   | 46/65 [00:31<00:11,  1.68it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.77it/s] 80%|████████  | 52/65 [00:34<00:07,  1.78it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.64it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.68it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.71it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.74it/s] 91%|█████████ | 59/65 [00:39<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.77it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.78it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.78it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:42<00:00,  1.64it/s]100%|██████████| 65/65 [00:42<00:00,  1.53it/s]

______epoch summary 2/3_____

mask_train: 1.359321701526642
spatial_difference_train: 23.125035960857684
total_train: 24.484357716487004
time taken to perform 2: 42.55
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:02,  5.66s/it]  3%|▎         | 2/65 [00:06<02:48,  2.67s/it]  5%|▍         | 3/65 [00:06<01:46,  1.72s/it]  6%|▌         | 4/65 [00:07<01:17,  1.27s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:09<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.59it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.70it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.74it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.80it/s] 28%|██▊       | 18/65 [00:15<00:25,  1.81it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:16<00:26,  1.67it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.71it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.75it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:20<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 1.1149161644470997
spatial_difference_train: 22.47555876511794
total_train: 23.590474974803435
time taken to perform 3: 42.04
[25.674558962308442, 24.484357716487004, 23.590474974803435]
Using minimum loss from history: 23.590474974803435
[I 2025-02-17 22:37:11,924] Trial 9 finished with value: 23.590474974803435 and parameters: {'lr_init_phase2': 2.096353954836268e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.004509971707466343, 'lr_gamma_phase2': 0.9600082569964201, 'lr_step_phase2': 5000, 'lr_warmup_phase2': 300}. Best is trial 7 with value: 17.44687095055213.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_223504-ud4giunr
wandb: Find logs at: ./wandb/offline-run-20250217_223504-ud4giunr/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:44,  5.39s/it]  3%|▎         | 2/65 [00:06<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:38,  1.44it/s] 17%|█▋        | 11/65 [00:11<00:35,  1.53it/s] 18%|█▊        | 12/65 [00:11<00:33,  1.60it/s] 20%|██        | 13/65 [00:12<00:31,  1.65it/s] 22%|██▏       | 14/65 [00:13<00:30,  1.69it/s] 23%|██▎       | 15/65 [00:13<00:29,  1.71it/s] 25%|██▍       | 16/65 [00:14<00:28,  1.73it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.74it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:27,  1.62it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.67it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.70it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.72it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.73it/s] 38%|███▊      | 25/65 [00:19<00:23,  1.74it/s] 40%|████      | 26/65 [00:19<00:22,  1.75it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.76it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.74it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.60it/s] 48%|████▊     | 31/65 [00:23<00:20,  1.66it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.69it/s] 51%|█████     | 33/65 [00:24<00:18,  1.71it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.72it/s] 54%|█████▍    | 35/65 [00:25<00:17,  1.75it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.75it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.75it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.77it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:28<00:15,  1.63it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.73it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:31<00:11,  1.77it/s] 71%|███████   | 46/65 [00:31<00:10,  1.77it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.77it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.77it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:34<00:09,  1.63it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.68it/s] 80%|████████  | 52/65 [00:35<00:07,  1.71it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.75it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.78it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:39<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.71it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.72it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.75it/s]100%|██████████| 65/65 [00:42<00:00,  1.75it/s]100%|██████████| 65/65 [00:42<00:00,  1.53it/s]

______epoch summary 1/3_____

mask_train: 1.099166303414565
spatial_difference_train: 21.637091651329627
total_train: 22.73625802260179
time taken to perform 1: 42.56
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:03,  5.68s/it]  3%|▎         | 2/65 [00:06<02:48,  2.67s/it]  5%|▍         | 3/65 [00:06<01:46,  1.72s/it]  6%|▌         | 4/65 [00:07<01:17,  1.26s/it]  8%|▊         | 5/65 [00:08<01:04,  1.07s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:09<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:37,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:16<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:17<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.79it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:20<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:28<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:29<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.78it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.65it/s]100%|██████████| 65/65 [00:42<00:00,  1.53it/s]

______epoch summary 2/3_____

mask_train: 0.816790040410482
spatial_difference_train: 19.85821716602032
total_train: 20.67500726259672
time taken to perform 2: 42.38
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:03,  5.67s/it]  3%|▎         | 2/65 [00:06<02:48,  2.67s/it]  5%|▍         | 3/65 [00:06<01:46,  1.71s/it]  6%|▌         | 4/65 [00:07<01:17,  1.27s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:09<00:44,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:12<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.66it/s] 22%|██▏       | 14/65 [00:13<00:30,  1.69it/s] 23%|██▎       | 15/65 [00:13<00:29,  1.72it/s] 25%|██▍       | 16/65 [00:14<00:28,  1.73it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.75it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.76it/s] 29%|██▉       | 19/65 [00:16<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.71it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.73it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.73it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.74it/s] 40%|████      | 26/65 [00:20<00:22,  1.74it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.75it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.63it/s] 48%|████▊     | 31/65 [00:23<00:20,  1.67it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.70it/s] 51%|█████     | 33/65 [00:24<00:18,  1.73it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.75it/s] 54%|█████▍    | 35/65 [00:25<00:17,  1.76it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:28<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:31<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:33<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:35<00:07,  1.71it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.53it/s]

______epoch summary 3/3_____

mask_train: 0.6889605827820606
spatial_difference_train: 18.71734222998986
total_train: 19.40630280910394
time taken to perform 3: 42.47
[22.73625802260179, 20.67500726259672, 19.40630280910394]
Using minimum loss from history: 19.40630280910394
[I 2025-02-17 22:39:21,100] Trial 10 finished with value: 19.40630280910394 and parameters: {'lr_init_phase2': 9.973869826964519e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00012411232725782653, 'lr_gamma_phase2': 0.9367243322292942, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 2000}. Best is trial 7 with value: 17.44687095055213.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_223712-mkp2zqby
wandb: Find logs at: ./wandb/offline-run-20250217_223712-mkp2zqby/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:05,  4.77s/it]  3%|▎         | 2/65 [00:05<02:35,  2.46s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:10<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.66it/s] 22%|██▏       | 14/65 [00:12<00:30,  1.70it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.74it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.81it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.81it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9113246000730074
spatial_difference_train: 18.799658349844126
total_train: 19.710982953585113
time taken to perform 1: 41.57
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:13,  4.90s/it]  3%|▎         | 2/65 [00:05<02:38,  2.51s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:06<01:14,  1.21s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:12<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.77it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.78it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.64it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.80it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7115127166876426
spatial_difference_train: 16.788732367295484
total_train: 17.50024507229145
time taken to perform 2: 41.85
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:22,  5.04s/it]  3%|▎         | 2/65 [00:05<02:32,  2.41s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:42,  1.36it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.57it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:15<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.67it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 3/3_____

mask_train: 0.6096270695710794
spatial_difference_train: 15.770253959068885
total_train: 16.379881012745393
time taken to perform 3: 41.45
[19.710982953585113, 17.50024507229145, 16.379881012745393]
Using minimum loss from history: 16.379881012745393
[I 2025-02-17 22:41:27,812] Trial 11 finished with value: 16.379881012745393 and parameters: {'lr_init_phase2': 0.00029336019487410014, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0003091896624693162, 'lr_gamma_phase2': 0.9832565295185788, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1600}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_223921-cr0qwslf
wandb: Find logs at: ./wandb/offline-run-20250217_223921-cr0qwslf/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.84s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:06<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.76it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.77it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.78it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.91385234777744
spatial_difference_train: 18.81751462496244
total_train: 19.73136702317458
time taken to perform 1: 41.90
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:11,  4.87s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<01:02,  1.05s/it]  9%|▉         | 6/65 [00:08<00:51,  1.13it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.64it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7162697714108687
spatial_difference_train: 16.805666974874644
total_train: 17.52193673940805
time taken to perform 2: 41.77
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.30s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.6143955238354512
spatial_difference_train: 15.783967086596366
total_train: 16.39836259988638
time taken to perform 3: 41.71
[19.73136702317458, 17.52193673940805, 16.39836259988638]
Using minimum loss from history: 16.39836259988638
[I 2025-02-17 22:43:35,201] Trial 12 finished with value: 16.39836259988638 and parameters: {'lr_init_phase2': 0.000291560094718895, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00029323418569627836, 'lr_gamma_phase2': 0.9823161723539258, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 1700}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_224128-u9o7071k
wandb: Find logs at: ./wandb/offline-run-20250217_224128-u9o7071k/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:23,  5.06s/it]  3%|▎         | 2/65 [00:05<02:32,  2.42s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.81it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.81it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9175914608515225
spatial_difference_train: 18.986690403864934
total_train: 19.90428179227389
time taken to perform 1: 41.54
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.91s/it]  3%|▎         | 2/65 [00:05<02:29,  2.37s/it]  5%|▍         | 3/65 [00:06<01:35,  1.55s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:07<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.72it/s] 20%|██        | 13/65 [00:11<00:29,  1.75it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.78it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.65it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.70it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.73it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.76it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:15<00:25,  1.80it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.81it/s] 34%|███▍      | 22/65 [00:16<00:23,  1.81it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.82it/s] 37%|███▋      | 24/65 [00:17<00:22,  1.82it/s] 38%|███▊      | 25/65 [00:18<00:23,  1.67it/s] 40%|████      | 26/65 [00:19<00:22,  1.71it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.80it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.81it/s] 51%|█████     | 33/65 [00:23<00:17,  1.82it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.82it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.68it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.72it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.75it/s] 58%|█████▊    | 38/65 [00:25<00:15,  1.77it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.80it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.81it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.82it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.82it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.83it/s] 69%|██████▉   | 45/65 [00:29<00:11,  1.68it/s] 71%|███████   | 46/65 [00:30<00:11,  1.72it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.75it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.77it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.81it/s] 80%|████████  | 52/65 [00:33<00:07,  1.82it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.82it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.82it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.68it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.72it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.75it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.77it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:38<00:02,  1.81it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.82it/s] 97%|█████████▋| 63/65 [00:39<00:01,  1.82it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.82it/s]100%|██████████| 65/65 [00:41<00:00,  1.68it/s]100%|██████████| 65/65 [00:41<00:00,  1.58it/s]

______epoch summary 2/3_____

mask_train: 0.7176582909547365
spatial_difference_train: 16.968266560481144
total_train: 17.68592483813946
time taken to perform 2: 41.22
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:30,  5.17s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.81it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.71it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:19<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.82it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.83it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 3/3_____

mask_train: 0.6162884310269967
spatial_difference_train: 15.916933426490196
total_train: 16.533221851251064
time taken to perform 3: 41.39
[19.90428179227389, 17.68592483813946, 16.533221851251064]
Using minimum loss from history: 16.533221851251064
[I 2025-02-17 22:45:41,158] Trial 13 finished with value: 16.533221851251064 and parameters: {'lr_init_phase2': 0.00027499192781197144, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00032335860756052987, 'lr_gamma_phase2': 0.9845290476343946, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 1600}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_224335-le7qyg3o
wandb: Find logs at: ./wandb/offline-run-20250217_224335-le7qyg3o/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:07,  4.80s/it]  3%|▎         | 2/65 [00:05<02:30,  2.38s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:11<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:15<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.81it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 1/3_____

mask_train: 1.0408583210064815
spatial_difference_train: 21.131963524451624
total_train: 22.17282186654898
time taken to perform 1: 41.42
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:39,  5.30s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<01:03,  1.06s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7855929216513267
spatial_difference_train: 19.259995607229378
total_train: 20.04558858137864
time taken to perform 2: 41.96
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:26,  5.09s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:38,  1.60s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.70it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.80it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 3/3_____

mask_train: 0.6686999715291537
spatial_difference_train: 18.087180362603604
total_train: 18.755880380288147
time taken to perform 3: 41.51
[22.17282186654898, 20.04558858137864, 18.755880380288147]
Using minimum loss from history: 18.755880380288147
[I 2025-02-17 22:47:47,809] Trial 14 finished with value: 18.755880380288147 and parameters: {'lr_init_phase2': 0.00012398302937760477, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00030340149458938845, 'lr_gamma_phase2': 0.9894672351490666, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 1600}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_224541-mjrteud6
wandb: Find logs at: ./wandb/offline-run-20250217_224541-mjrteud6/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.94s/it]  3%|▎         | 2/65 [00:05<02:29,  2.38s/it]  5%|▍         | 3/65 [00:06<01:36,  1.55s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:48,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.47it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:11<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.61it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.66it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.70it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.73it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.75it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.75it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.73it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.74it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.76it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.77it/s] 60%|██████    | 39/65 [00:26<00:14,  1.78it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.63it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.67it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.75it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.76it/s] 71%|███████   | 46/65 [00:30<00:10,  1.77it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.78it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.2260001182556153
spatial_difference_train: 22.341220591618466
total_train: 23.567220658522388
time taken to perform 1: 41.80
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:49,  5.45s/it]  3%|▎         | 2/65 [00:06<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<01:03,  1.06s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:09<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:29,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:42<00:00,  1.66it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.8952898057607505
spatial_difference_train: 20.76080925281231
total_train: 21.656098996675933
time taken to perform 2: 42.07
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:57,  5.58s/it]  3%|▎         | 2/65 [00:06<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:45,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.80it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.71it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.75it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:20<00:20,  1.82it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:22<00:20,  1.68it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.72it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.75it/s] 51%|█████     | 33/65 [00:23<00:18,  1.78it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.82it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.72it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.83it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.68it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.7523648349138407
spatial_difference_train: 19.679283924591846
total_train: 20.431648743458283
time taken to perform 3: 41.70
[23.567220658522388, 21.656098996675933, 20.431648743458283]
Using minimum loss from history: 20.431648743458283
[I 2025-02-17 22:49:55,252] Trial 15 finished with value: 20.431648743458283 and parameters: {'lr_init_phase2': 7.058495823056196e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00029939493147588994, 'lr_gamma_phase2': 0.9684345804775747, 'lr_step_phase2': 4000, 'lr_warmup_phase2': 1400}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_224748-o72ez6wc
wandb: Find logs at: ./wandb/offline-run-20250217_224748-o72ez6wc/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:07,  4.81s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:06<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.5412901850847098
spatial_difference_train: 23.357493884746845
total_train: 24.898784138606146
time taken to perform 1: 41.80
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:28,  5.13s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:31,  1.61it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.66it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.64it/s] 40%|████      | 26/65 [00:19<00:23,  1.68it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.78it/s] 51%|█████     | 33/65 [00:23<00:17,  1.78it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.64it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.68it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.74it/s] 60%|██████    | 39/65 [00:27<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.77it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.78it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.78it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.78it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.63it/s] 71%|███████   | 46/65 [00:31<00:11,  1.68it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.78it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.64it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.68it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.73it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.75it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.76it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.78it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.78it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.78it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:42<00:00,  1.65it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 1.1163028891269977
spatial_difference_train: 22.281956555293156
total_train: 23.398259456341084
time taken to perform 2: 42.06
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.20s/it]  3%|▎         | 2/65 [00:05<02:36,  2.48s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.9232287526130676
spatial_difference_train: 21.402354920216094
total_train: 22.325583668244192
time taken to perform 3: 41.74
[24.898784138606146, 23.398259456341084, 22.325583668244192]
Using minimum loss from history: 22.325583668244192
[I 2025-02-17 22:52:02,601] Trial 16 finished with value: 22.325583668244192 and parameters: {'lr_init_phase2': 3.556250952686009e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0004827617632740829, 'lr_gamma_phase2': 0.957376389332941, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 1800}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_224955-hvfjdt8c
wandb: Find logs at: ./wandb/offline-run-20250217_224955-hvfjdt8c/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:28,  5.14s/it]  3%|▎         | 2/65 [00:05<02:35,  2.46s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:14,  1.21s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.77it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.78it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9120556501241831
spatial_difference_train: 18.952414292555588
total_train: 19.864469762948843
time taken to perform 1: 41.86
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.82s/it]  3%|▎         | 2/65 [00:05<02:26,  2.33s/it]  5%|▍         | 3/65 [00:05<01:34,  1.53s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:07<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:08<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.72it/s] 20%|██        | 13/65 [00:11<00:29,  1.75it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.77it/s] 23%|██▎       | 15/65 [00:12<00:30,  1.64it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.69it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.73it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.80it/s] 34%|███▍      | 22/65 [00:16<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.81it/s] 37%|███▋      | 24/65 [00:17<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.71it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.76it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.80it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.81it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:24<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:25<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:33<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 2/3_____

mask_train: 0.7143280428189498
spatial_difference_train: 16.93501114478478
total_train: 17.64933908169086
time taken to perform 2: 41.41
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:41,  5.33s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6125420567316887
spatial_difference_train: 15.889546052003519
total_train: 16.502088038126626
time taken to perform 3: 41.81
[19.864469762948843, 17.64933908169086, 16.502088038126626]
Using minimum loss from history: 16.502088038126626
[I 2025-02-17 22:54:09,542] Trial 17 finished with value: 16.502088038126626 and parameters: {'lr_init_phase2': 0.00027827865880237736, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0002156507430567688, 'lr_gamma_phase2': 0.9742519197816701, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 800}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_225202-i4ehwkw8
wandb: Find logs at: ./wandb/offline-run-20250217_225202-i4ehwkw8/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:06<06:34,  6.17s/it]  3%|▎         | 2/65 [00:06<03:01,  2.88s/it]  5%|▍         | 3/65 [00:07<01:53,  1.83s/it]  6%|▌         | 4/65 [00:07<01:21,  1.33s/it]  8%|▊         | 5/65 [00:08<01:03,  1.06s/it]finished warmup
  9%|▉         | 6/65 [00:09<00:52,  1.13it/s] 11%|█         | 7/65 [00:09<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:10<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:11<00:38,  1.44it/s] 17%|█▋        | 11/65 [00:12<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:12<00:32,  1.61it/s] 20%|██        | 13/65 [00:13<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:14<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:15<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:16<00:25,  1.78it/s] 31%|███       | 20/65 [00:17<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:18<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:19<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:20<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:21<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:21<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:22<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:23<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:24<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:25<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:25<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:26<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:27<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:28<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:29<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:30<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:31<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:33<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:34<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:35<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:37<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:38<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:39<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:41<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:42<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.52it/s]

______epoch summary 1/3_____

mask_train: 1.3410407084685105
spatial_difference_train: 22.708260198739858
total_train: 24.049300854022686
time taken to perform 1: 42.71
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:39,  5.31s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.69it/s] 20%|██        | 13/65 [00:12<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.61it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.66it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.70it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.64it/s] 40%|████      | 26/65 [00:19<00:23,  1.68it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.78it/s] 51%|█████     | 33/65 [00:23<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.64it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.68it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.74it/s] 60%|██████    | 39/65 [00:27<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.77it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.77it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.78it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.64it/s] 71%|███████   | 46/65 [00:31<00:11,  1.68it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.78it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.78it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.66it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 2/3_____

mask_train: 1.0365062287220588
spatial_difference_train: 21.864894485473634
total_train: 22.901400654132548
time taken to perform 2: 42.18
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:48,  5.45s/it]  3%|▎         | 2/65 [00:06<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:15,  1.25s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.8964158528890365
spatial_difference_train: 21.37073239057492
total_train: 22.267148208618163
time taken to perform 3: 42.04
[24.049300854022686, 22.901400654132548, 22.267148208618163]
Using minimum loss from history: 22.267148208618163
[I 2025-02-17 22:56:18,650] Trial 18 finished with value: 22.267148208618163 and parameters: {'lr_init_phase2': 9.168330852426539e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.00020277227476958977, 'lr_gamma_phase2': 0.9529817784675455, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 1800}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_225410-1glydlhd
wandb: Find logs at: ./wandb/offline-run-20250217_225410-1glydlhd/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:57,  4.64s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:11<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:15<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:30<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.68it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.4435448325597322
spatial_difference_train: 23.12961598909818
total_train: 24.573160758385292
time taken to perform 1: 41.63
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:29,  5.15s/it]  3%|▎         | 2/65 [00:05<02:36,  2.48s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<01:02,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:29,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 1.04204716361486
spatial_difference_train: 21.911773549593413
total_train: 22.953820727421686
time taken to perform 2: 41.79
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.20s/it]  3%|▎         | 2/65 [00:05<02:37,  2.49s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.8663182523006048
spatial_difference_train: 20.962744825314253
total_train: 21.829063073182716
time taken to perform 3: 41.70
[24.573160758385292, 22.953820727421686, 21.829063073182716]
Using minimum loss from history: 21.829063073182716
[I 2025-02-17 22:58:25,538] Trial 19 finished with value: 21.829063073182716 and parameters: {'lr_init_phase2': 4.286726472465325e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0005081545190912984, 'lr_gamma_phase2': 0.9787118231578859, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 600}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_225618-tqk3c78r
wandb: Find logs at: ./wandb/offline-run-20250217_225618-tqk3c78r/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:02,  4.73s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:08<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.65it/s] 22%|██▏       | 14/65 [00:12<00:30,  1.68it/s] 23%|██▎       | 15/65 [00:13<00:29,  1.70it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.72it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.73it/s] 28%|██▊       | 18/65 [00:14<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:28,  1.60it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.65it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.69it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.71it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.73it/s] 38%|███▊      | 25/65 [00:19<00:23,  1.74it/s] 40%|████      | 26/65 [00:19<00:22,  1.74it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.75it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.62it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.67it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.70it/s] 51%|█████     | 33/65 [00:23<00:18,  1.72it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.74it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.76it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.77it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.63it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.73it/s] 68%|██████▊   | 44/65 [00:30<00:12,  1.74it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.76it/s] 71%|███████   | 46/65 [00:31<00:10,  1.76it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.77it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.77it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.78it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.68it/s] 80%|████████  | 52/65 [00:34<00:07,  1.71it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.75it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.76it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.77it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.78it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.63it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.71it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.73it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.72it/s]100%|██████████| 65/65 [00:42<00:00,  1.73it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 1/3_____

mask_train: 0.9808132813527034
spatial_difference_train: 20.393758568396937
total_train: 21.374571932279146
time taken to perform 1: 42.13
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.83s/it]  3%|▎         | 2/65 [00:05<02:27,  2.34s/it]  5%|▍         | 3/65 [00:06<01:35,  1.53s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:07<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.77it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.64it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.69it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:16<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:17<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:24<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.78it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.80it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.81it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.67it/s] 71%|███████   | 46/65 [00:30<00:11,  1.71it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.74it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.78it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.80it/s] 80%|████████  | 52/65 [00:33<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.81it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.71it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.80it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 2/3_____

mask_train: 0.7511806510961972
spatial_difference_train: 18.432679579808163
total_train: 19.183860272627612
time taken to perform 2: 41.41
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:43,  5.37s/it]  3%|▎         | 2/65 [00:05<02:40,  2.55s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:31<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.78it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6396330179312291
spatial_difference_train: 17.24155715062068
total_train: 17.88119020706568
time taken to perform 3: 42.03
[21.374571932279146, 19.183860272627612, 17.88119020706568]
Using minimum loss from history: 17.88119020706568
[I 2025-02-17 23:00:32,999] Trial 20 finished with value: 17.88119020706568 and parameters: {'lr_init_phase2': 0.00016580700966452192, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0018777221187783468, 'lr_gamma_phase2': 0.9650117290427058, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 1700}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_225825-e36d9t7x
wandb: Find logs at: ./wandb/offline-run-20250217_225825-e36d9t7x/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:11,  4.86s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9127346167197594
spatial_difference_train: 18.908216945941632
total_train: 19.820951637854943
time taken to perform 1: 41.77
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.96s/it]  3%|▎         | 2/65 [00:05<02:29,  2.38s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7142899242731241
spatial_difference_train: 16.892384066948523
total_train: 17.606674025608942
time taken to perform 2: 41.62
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:05,  5.71s/it]  3%|▎         | 2/65 [00:06<02:49,  2.69s/it]  5%|▍         | 3/65 [00:06<01:46,  1.72s/it]  6%|▌         | 4/65 [00:07<01:17,  1.27s/it]  8%|▊         | 5/65 [00:07<01:00,  1.02s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:09<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:11<00:38,  1.44it/s] 17%|█▋        | 11/65 [00:11<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:12<00:33,  1.60it/s] 20%|██        | 13/65 [00:12<00:31,  1.65it/s] 22%|██▏       | 14/65 [00:13<00:30,  1.68it/s] 23%|██▎       | 15/65 [00:13<00:29,  1.71it/s] 25%|██▍       | 16/65 [00:14<00:28,  1.74it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.74it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:16<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:28,  1.59it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.65it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.68it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.71it/s] 37%|███▋      | 24/65 [00:19<00:23,  1.73it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.75it/s] 40%|████      | 26/65 [00:20<00:22,  1.76it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.76it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.61it/s] 48%|████▊     | 31/65 [00:23<00:20,  1.66it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.69it/s] 51%|█████     | 33/65 [00:24<00:18,  1.73it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.75it/s] 54%|█████▍    | 35/65 [00:25<00:17,  1.76it/s] 55%|█████▌    | 36/65 [00:26<00:16,  1.76it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.77it/s] 58%|█████▊    | 38/65 [00:27<00:15,  1.78it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:28<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:30<00:12,  1.73it/s] 68%|██████▊   | 44/65 [00:30<00:12,  1.75it/s] 69%|██████▉   | 45/65 [00:31<00:11,  1.77it/s] 71%|███████   | 46/65 [00:31<00:10,  1.76it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.77it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.78it/s] 75%|███████▌  | 49/65 [00:33<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:34<00:09,  1.63it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.68it/s] 80%|████████  | 52/65 [00:35<00:07,  1.71it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.77it/s] 88%|████████▊ | 57/65 [00:38<00:04,  1.77it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.77it/s] 91%|█████████ | 59/65 [00:39<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.62it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.67it/s] 95%|█████████▌| 62/65 [00:41<00:01,  1.71it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:42<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.52it/s]

______epoch summary 3/3_____

mask_train: 0.6152010897795359
spatial_difference_train: 15.854589555202386
total_train: 16.469790668976614
time taken to perform 3: 42.77
[19.820951637854943, 17.606674025608942, 16.469790668976614]
Using minimum loss from history: 16.469790668976614
[I 2025-02-17 23:02:40,924] Trial 21 finished with value: 16.469790668976614 and parameters: {'lr_init_phase2': 0.00028256522792314106, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00020789509068837983, 'lr_gamma_phase2': 0.9748568086715175, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 900}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_230033-re2stgnm
wandb: Find logs at: ./wandb/offline-run-20250217_230033-re2stgnm/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.96s/it]  3%|▎         | 2/65 [00:05<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.91314346240117
spatial_difference_train: 18.898625755310057
total_train: 19.81176919203538
time taken to perform 1: 41.87
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:25,  5.08s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:14<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.78it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.78it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.77it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.78it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7150489520568114
spatial_difference_train: 16.883163393460787
total_train: 17.598212322821983
time taken to perform 2: 41.87
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:53,  5.52s/it]  3%|▎         | 2/65 [00:06<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:16,  1.26s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.77it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.77it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.78it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.62it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.67it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.71it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6158527601987888
spatial_difference_train: 15.847049277868026
total_train: 16.462902015294784
time taken to perform 3: 42.06
[19.81176919203538, 17.598212322821983, 16.462902015294784]
Using minimum loss from history: 16.462902015294784
[I 2025-02-17 23:04:48,551] Trial 22 finished with value: 16.462902015294784 and parameters: {'lr_init_phase2': 0.0002835051832347542, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0001869158386023698, 'lr_gamma_phase2': 0.989521308374038, 'lr_step_phase2': 4500, 'lr_warmup_phase2': 1000}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_230241-iz0lga3n
wandb: Find logs at: ./wandb/offline-run-20250217_230241-iz0lga3n/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.84s/it]  3%|▎         | 2/65 [00:05<02:27,  2.35s/it]  5%|▍         | 3/65 [00:06<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:11<00:30,  1.70it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.80it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:15<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:16<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.78it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:19<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.75it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:25<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.72it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:29<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:30<00:09,  1.81it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:33<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:38<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.58it/s]

______epoch summary 1/3_____

mask_train: 0.94713062781554
spatial_difference_train: 19.79573584336501
total_train: 20.74286639873798
time taken to perform 1: 41.14
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:10,  4.85s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<01:03,  1.06s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7339024839492945
spatial_difference_train: 17.790553547785834
total_train: 18.52445595081036
time taken to perform 2: 41.82
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:20,  5.01s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:42,  1.36it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:15<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.78it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 3/3_____

mask_train: 0.6279147057961195
spatial_difference_train: 16.630361004364797
total_train: 17.25827567760761
time taken to perform 3: 41.51
[20.74286639873798, 18.52445595081036, 17.25827567760761]
Using minimum loss from history: 17.25827567760761
[I 2025-02-17 23:06:54,943] Trial 23 finished with value: 17.25827567760761 and parameters: {'lr_init_phase2': 0.00020668029310348923, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0001636441554469811, 'lr_gamma_phase2': 0.9877861362905237, 'lr_step_phase2': 4500, 'lr_warmup_phase2': 1300}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_230448-plgjr6h6
wandb: Find logs at: ./wandb/offline-run-20250217_230448-plgjr6h6/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:04,  4.76s/it]  3%|▎         | 2/65 [00:06<02:53,  2.75s/it]  5%|▍         | 3/65 [00:06<01:48,  1.76s/it]  6%|▌         | 4/65 [00:07<01:18,  1.29s/it]  8%|▊         | 5/65 [00:07<01:02,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 1.0323047995567323
spatial_difference_train: 21.0472532419058
total_train: 22.079557947012095
time taken to perform 1: 42.07
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:05,  4.77s/it]  3%|▎         | 2/65 [00:05<02:42,  2.57s/it]  5%|▍         | 3/65 [00:06<01:43,  1.66s/it]  6%|▌         | 4/65 [00:06<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<01:03,  1.06s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.69it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.64it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.68it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.74it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.77it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.78it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.78it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7816871796662991
spatial_difference_train: 19.162647907550518
total_train: 19.944335101200984
time taken to perform 2: 41.93
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.29s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:14,  1.21s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6662776947021485
spatial_difference_train: 17.985477056258762
total_train: 18.651754770523464
time taken to perform 3: 41.84
[22.079557947012095, 19.944335101200984, 18.651754770523464]
Using minimum loss from history: 18.651754770523464
[I 2025-02-17 23:09:02,555] Trial 24 finished with value: 18.651754770523464 and parameters: {'lr_init_phase2': 0.00012836883808337892, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00040155141512648624, 'lr_gamma_phase2': 0.980245161450623, 'lr_step_phase2': 4000, 'lr_warmup_phase2': 100}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_230655-pya4cxwh
wandb: Find logs at: ./wandb/offline-run-20250217_230655-pya4cxwh/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:04,  4.76s/it]  3%|▎         | 2/65 [00:05<02:33,  2.43s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:11<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9397480286084688
spatial_difference_train: 19.59633434002216
total_train: 20.536082399808443
time taken to perform 1: 41.62
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:43,  5.37s/it]  3%|▎         | 2/65 [00:05<02:40,  2.55s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.61it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.70it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.79it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.63it/s] 40%|████      | 26/65 [00:19<00:23,  1.67it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.71it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.64it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.74it/s] 60%|██████    | 39/65 [00:27<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.77it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.78it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.64it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.64it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.68it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.74it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.77it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.78it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.78it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.65it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 2/3_____

mask_train: 0.7280576630280569
spatial_difference_train: 17.58204559179453
total_train: 18.310103291731615
time taken to perform 2: 42.21
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:51,  5.49s/it]  3%|▎         | 2/65 [00:06<02:43,  2.60s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.621581872457113
spatial_difference_train: 16.44236900623028
total_train: 17.063950910323705
time taken to perform 3: 42.03
[20.536082399808443, 18.310103291731615, 17.063950910323705]
Using minimum loss from history: 17.063950910323705
[I 2025-02-17 23:11:10,170] Trial 25 finished with value: 17.063950910323705 and parameters: {'lr_init_phase2': 0.0002219948435055485, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0006787071181030656, 'lr_gamma_phase2': 0.9894474139402529, 'lr_step_phase2': 4500, 'lr_warmup_phase2': 1100}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_230902-t6u6oeij
wandb: Find logs at: ./wandb/offline-run-20250217_230902-t6u6oeij/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:06,  4.79s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.22236543068519
spatial_difference_train: 22.06480272733248
total_train: 23.287168180025542
time taken to perform 1: 41.66
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:13,  4.89s/it]  3%|▎         | 2/65 [00:05<02:28,  2.36s/it]  5%|▍         | 3/65 [00:06<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:07<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:16<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.78it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:30<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.64it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.9348856536241678
spatial_difference_train: 21.026899205721342
total_train: 21.961784846966083
time taken to perform 2: 41.63
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:31,  5.17s/it]  3%|▎         | 2/65 [00:05<02:35,  2.48s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.8099423631643637
spatial_difference_train: 20.444314174163036
total_train: 21.254256497896634
time taken to perform 3: 41.59
[23.287168180025542, 21.961784846966083, 21.254256497896634]
Using minimum loss from history: 21.254256497896634
[I 2025-02-17 23:13:16,791] Trial 26 finished with value: 21.254256497896634 and parameters: {'lr_init_phase2': 0.00012996861097728282, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0002752442465887692, 'lr_gamma_phase2': 0.971896340428598, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1400}. Best is trial 11 with value: 16.379881012745393.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_231110-j3pb5nv6
wandb: Find logs at: ./wandb/offline-run-20250217_231110-j3pb5nv6/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:34,  5.22s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9117690489842342
spatial_difference_train: 18.76367897620568
total_train: 19.67544805086576
time taken to perform 1: 41.82
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:23,  5.06s/it]  3%|▎         | 2/65 [00:05<02:33,  2.43s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.72it/s] 20%|██        | 13/65 [00:11<00:29,  1.75it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.77it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.77it/s] 31%|███       | 20/65 [00:16<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.80it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.81it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.81it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.82it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7118963525845454
spatial_difference_train: 16.75473577792828
total_train: 17.46663214610173
time taken to perform 2: 41.67
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.96s/it]  3%|▎         | 2/65 [00:05<02:30,  2.39s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:42,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:11<00:31,  1.66it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.70it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.75it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.71it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.73it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.75it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.76it/s] 40%|████      | 26/65 [00:19<00:22,  1.77it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.77it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.61it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.66it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.70it/s] 51%|█████     | 33/65 [00:23<00:18,  1.72it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.74it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.75it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.76it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.78it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.76it/s] 71%|███████   | 46/65 [00:30<00:10,  1.77it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.78it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.62it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.67it/s] 80%|████████  | 52/65 [00:34<00:07,  1.70it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.73it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.75it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.63it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.71it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.73it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.75it/s]100%|██████████| 65/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6096086220863538
spatial_difference_train: 15.742791068248259
total_train: 16.352399723346416
time taken to perform 3: 41.88
[19.67544805086576, 17.46663214610173, 16.352399723346416]
Using minimum loss from history: 16.352399723346416
[I 2025-02-17 23:15:24,089] Trial 27 finished with value: 16.352399723346416 and parameters: {'lr_init_phase2': 0.0002970178685216323, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00018602100829890808, 'lr_gamma_phase2': 0.9492937743356882, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 600}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_231317-gyrqsw6z
wandb: Find logs at: ./wandb/offline-run-20250217_231317-gyrqsw6z/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:28,  5.14s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.78it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9716415359423711
spatial_difference_train: 20.273010107187126
total_train: 21.24465153033917
time taken to perform 1: 41.81
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:37,  5.27s/it]  3%|▎         | 2/65 [00:05<02:37,  2.51s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7462496088101314
spatial_difference_train: 18.301161083808314
total_train: 19.047410605503963
time taken to perform 2: 41.98
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.6361159070944175
spatial_difference_train: 17.112517581841885
total_train: 17.748633433610966
time taken to perform 3: 41.73
[21.24465153033917, 19.047410605503963, 17.748633433610966]
Using minimum loss from history: 17.748633433610966
[I 2025-02-17 23:17:31,368] Trial 28 finished with value: 17.748633433610966 and parameters: {'lr_init_phase2': 0.0001734987696166496, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00037200256862370343, 'lr_gamma_phase2': 0.9482142299249918, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 600}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_231524-1ea9yji0
wandb: Find logs at: ./wandb/offline-run-20250217_231524-1ea9yji0/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:20,  5.01s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 1.0995826528622554
spatial_difference_train: 21.6323124225323
total_train: 22.731895094651442
time taken to perform 1: 41.84
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:25,  5.09s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:31,  1.60it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.65it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.69it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.72it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.76it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.77it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.64it/s] 40%|████      | 26/65 [00:19<00:23,  1.68it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.71it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.64it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.68it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.74it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.77it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.8183260706754831
spatial_difference_train: 19.852398784344015
total_train: 20.670724868774414
time taken to perform 2: 41.94
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.28s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.66it/s] 22%|██▏       | 14/65 [00:12<00:30,  1.69it/s] 23%|██▎       | 15/65 [00:13<00:29,  1.72it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.73it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.74it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:28,  1.61it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.66it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.70it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.71it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.73it/s] 38%|███▊      | 25/65 [00:19<00:23,  1.71it/s] 40%|████      | 26/65 [00:19<00:22,  1.73it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.75it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.60it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.65it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.69it/s] 51%|█████     | 33/65 [00:23<00:18,  1.72it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.73it/s] 54%|█████▍    | 35/65 [00:25<00:17,  1.74it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.76it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.77it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.78it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:28<00:15,  1.63it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:30<00:12,  1.75it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.76it/s] 71%|███████   | 46/65 [00:31<00:10,  1.76it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.77it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.78it/s] 75%|███████▌  | 49/65 [00:33<00:08,  1.78it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.63it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.67it/s] 80%|████████  | 52/65 [00:34<00:07,  1.71it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.73it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.75it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.78it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.75it/s]100%|██████████| 65/65 [00:42<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.53it/s]

______epoch summary 3/3_____

mask_train: 0.6909834118989798
spatial_difference_train: 18.711189930255596
total_train: 19.4021733601888
time taken to perform 3: 42.37
[22.731895094651442, 20.670724868774414, 19.4021733601888]
Using minimum loss from history: 19.4021733601888
[I 2025-02-17 23:19:39,247] Trial 29 finished with value: 19.4021733601888 and parameters: {'lr_init_phase2': 9.995483588199677e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0007403680546574697, 'lr_gamma_phase2': 0.9363644019038456, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 1200}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_231731-bx1gs0jd
wandb: Find logs at: ./wandb/offline-run-20250217_231731-bx1gs0jd/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:07,  4.81s/it]  3%|▎         | 2/65 [00:05<02:32,  2.42s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:08<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:10<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:11<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.74it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.76it/s] 40%|████      | 26/65 [00:19<00:22,  1.76it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.77it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.78it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.63it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.71it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.75it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:30<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9947077063413766
spatial_difference_train: 20.61270848787748
total_train: 21.607416240985575
time taken to perform 1: 41.78
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:24,  5.06s/it]  3%|▎         | 2/65 [00:05<02:32,  2.42s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.64it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.68it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:31,  1.58it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.64it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.68it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.71it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.73it/s] 31%|███       | 20/65 [00:16<00:25,  1.74it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.75it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.76it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.62it/s] 40%|████      | 26/65 [00:19<00:23,  1.67it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.69it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.70it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.72it/s] 46%|████▌     | 30/65 [00:22<00:20,  1.74it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.75it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.76it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.61it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.65it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.69it/s] 58%|█████▊    | 38/65 [00:26<00:16,  1.69it/s] 60%|██████    | 39/65 [00:27<00:15,  1.72it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.74it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.75it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.76it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.78it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.62it/s] 71%|███████   | 46/65 [00:31<00:11,  1.66it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.70it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.73it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.75it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.68it/s] 82%|████████▏ | 53/65 [00:35<00:07,  1.67it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.71it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.58it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.56it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.62it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.67it/s] 91%|█████████ | 59/65 [00:39<00:03,  1.71it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.73it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.75it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.77it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.78it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.63it/s]100%|██████████| 65/65 [00:42<00:00,  1.53it/s]

______epoch summary 2/3_____

mask_train: 0.7585571142343375
spatial_difference_train: 18.67359616939838
total_train: 19.432153246952936
time taken to perform 2: 42.64
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:47,  5.44s/it]  3%|▎         | 2/65 [00:06<02:42,  2.59s/it]  5%|▍         | 3/65 [00:06<01:43,  1.68s/it]  6%|▌         | 4/65 [00:07<01:15,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:44,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.644820486735075
spatial_difference_train: 17.482438346667166
total_train: 18.12725881429819
time taken to perform 3: 41.88
[21.607416240985575, 19.432153246952936, 18.12725881429819]
Using minimum loss from history: 18.12725881429819
[I 2025-02-17 23:21:47,317] Trial 30 finished with value: 18.12725881429819 and parameters: {'lr_init_phase2': 0.0001525051350552765, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0012338681003743965, 'lr_gamma_phase2': 0.9617173903682307, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 600}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_231939-0gl5lq88
wandb: Find logs at: ./wandb/offline-run-20250217_231939-0gl5lq88/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:10,  4.84s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:07<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.70it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.74it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.77it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.71it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.78it/s] 43%|████▎     | 28/65 [00:20<00:23,  1.59it/s] 45%|████▍     | 29/65 [00:21<00:21,  1.65it/s] 46%|████▌     | 30/65 [00:22<00:22,  1.55it/s] 48%|████▊     | 31/65 [00:22<00:21,  1.61it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.66it/s] 51%|█████     | 33/65 [00:23<00:18,  1.70it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.73it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.76it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.77it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.915844438626216
spatial_difference_train: 18.892172446617714
total_train: 19.808016850398136
time taken to perform 1: 42.04
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:11,  5.80s/it]  3%|▎         | 2/65 [00:06<02:51,  2.73s/it]  5%|▍         | 3/65 [00:06<01:48,  1.74s/it]  6%|▌         | 4/65 [00:07<01:18,  1.28s/it]  8%|▊         | 5/65 [00:08<01:05,  1.09s/it]  9%|▉         | 6/65 [00:08<00:53,  1.10it/s] 11%|█         | 7/65 [00:09<00:46,  1.26it/s] 12%|█▏        | 8/65 [00:09<00:41,  1.38it/s] 14%|█▍        | 9/65 [00:10<00:37,  1.49it/s] 15%|█▌        | 10/65 [00:11<00:35,  1.57it/s] 17%|█▋        | 11/65 [00:11<00:33,  1.63it/s] 18%|█▊        | 12/65 [00:12<00:31,  1.67it/s] 20%|██        | 13/65 [00:12<00:30,  1.71it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:14<00:31,  1.60it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.65it/s] 26%|██▌       | 17/65 [00:15<00:28,  1.69it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.72it/s] 29%|██▉       | 19/65 [00:16<00:26,  1.74it/s] 31%|███       | 20/65 [00:16<00:25,  1.75it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.76it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.77it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.78it/s] 37%|███▋      | 24/65 [00:19<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.63it/s] 40%|████      | 26/65 [00:20<00:23,  1.68it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.71it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:22<00:20,  1.75it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:23<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:24<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:26<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:27<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:28<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:29<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:31<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.79it/s] 80%|████████  | 52/65 [00:35<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:38<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.75it/s] 91%|█████████ | 59/65 [00:39<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.65it/s]100%|██████████| 65/65 [00:42<00:00,  1.52it/s]

______epoch summary 2/3_____

mask_train: 0.718358195057282
spatial_difference_train: 16.87695947793814
total_train: 17.595317657177265
time taken to perform 2: 42.64
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:01,  5.65s/it]  3%|▎         | 2/65 [00:06<02:47,  2.66s/it]  5%|▍         | 3/65 [00:06<01:45,  1.71s/it]  6%|▌         | 4/65 [00:07<01:17,  1.26s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:09<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:12<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:21<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:25<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 3/3_____

mask_train: 0.6149749152171307
spatial_difference_train: 15.841978117135854
total_train: 16.45695303892478
time taken to perform 3: 42.13
[19.808016850398136, 17.595317657177265, 16.45695303892478]
Using minimum loss from history: 16.45695303892478
[I 2025-02-17 23:23:56,114] Trial 31 finished with value: 16.45695303892478 and parameters: {'lr_init_phase2': 0.0002841386622159176, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0001651193854399323, 'lr_gamma_phase2': 0.9799785608609716, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 400}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_232147-bvjpjjkz
wandb: Find logs at: ./wandb/offline-run-20250217_232147-bvjpjjkz/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:24,  5.07s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:38,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.75it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.77it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.78it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9378588933211106
spatial_difference_train: 19.625765785804163
total_train: 20.563624778160683
time taken to perform 1: 41.83
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:16,  4.95s/it]  3%|▎         | 2/65 [00:05<02:30,  2.39s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.80it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.81it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.71it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.77it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.77it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.78it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.64it/s] 71%|███████   | 46/65 [00:30<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7302720065300281
spatial_difference_train: 17.61260692889874
total_train: 18.342878972567046
time taken to perform 2: 41.64
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:55,  5.56s/it]  3%|▎         | 2/65 [00:06<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6278906404972077
spatial_difference_train: 16.469599058689216
total_train: 17.097489738464354
time taken to perform 3: 41.98
[20.563624778160683, 18.342878972567046, 17.097489738464354]
Using minimum loss from history: 17.097489738464354
[I 2025-02-17 23:26:03,336] Trial 32 finished with value: 17.097489738464354 and parameters: {'lr_init_phase2': 0.00021967561998348007, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00010417363070716295, 'lr_gamma_phase2': 0.9824483637632557, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 400}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_232356-pj10verl
wandb: Find logs at: ./wandb/offline-run-20250217_232356-pj10verl/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.93s/it]  3%|▎         | 2/65 [00:06<02:48,  2.67s/it]  5%|▍         | 3/65 [00:06<01:46,  1.72s/it]  6%|▌         | 4/65 [00:07<01:17,  1.27s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:51,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.91049030652413
spatial_difference_train: 18.802148730938253
total_train: 19.712638943011942
time taken to perform 1: 41.95
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:55,  4.62s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:11<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:14<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:30<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.65it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7135248321753281
spatial_difference_train: 16.791093349456787
total_train: 17.50461808718168
time taken to perform 2: 41.81
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:27,  5.11s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.75it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:27,  1.63it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.67it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.71it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.73it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.75it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.77it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.78it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.78it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.63it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.71it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.75it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.63it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:30<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.68it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6144816073087546
spatial_difference_train: 15.772163283519255
total_train: 16.386644828013885
time taken to perform 3: 41.90
[19.712638943011942, 17.50461808718168, 16.386644828013885]
Using minimum loss from history: 16.386644828013885
[I 2025-02-17 23:28:10,814] Trial 33 finished with value: 16.386644828013885 and parameters: {'lr_init_phase2': 0.0002931074871622694, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00015108878618617631, 'lr_gamma_phase2': 0.9775490666761634, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 100}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_232603-llscyic4
wandb: Find logs at: ./wandb/offline-run-20250217_232603-llscyic4/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:11,  4.86s/it]  3%|▎         | 2/65 [00:05<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.80it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:20<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.72it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.75it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.82it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.68it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.72it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.68it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.68it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 1/3_____

mask_train: 0.9300226000639108
spatial_difference_train: 19.4612795316256
total_train: 20.39130222613995
time taken to perform 1: 41.50
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.84s/it]  3%|▎         | 2/65 [00:05<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<01:03,  1.07s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:08<00:45,  1.27it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:37,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:27<00:14,  1.78it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.80it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.81it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.67it/s] 71%|███████   | 46/65 [00:31<00:11,  1.71it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.74it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.80it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7224866092205048
spatial_difference_train: 17.44278107423049
total_train: 18.16526768757747
time taken to perform 2: 41.89
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:05,  4.77s/it]  3%|▎         | 2/65 [00:05<02:25,  2.30s/it]  5%|▍         | 3/65 [00:05<01:33,  1.52s/it]  6%|▌         | 4/65 [00:06<01:09,  1.15s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:42,  1.36it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:13<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:15<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:16<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:25<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:30<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:32<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.74it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 3/3_____

mask_train: 0.6179332642983167
spatial_difference_train: 16.319620787791717
total_train: 16.937554080669695
time taken to perform 3: 41.43
[20.39130222613995, 18.16526768757747, 16.937554080669695]
Using minimum loss from history: 16.937554080669695
[I 2025-02-17 23:30:17,366] Trial 34 finished with value: 16.937554080669695 and parameters: {'lr_init_phase2': 0.00023289388366363686, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0002379895051980528, 'lr_gamma_phase2': 0.9309862631954012, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 100}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_232811-vrut7pbx
wandb: Find logs at: ./wandb/offline-run-20250217_232811-vrut7pbx/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:05<05:24,  5.07s/it]  3%|▎         | 2/65 [00:05<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:43,  1.66s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]finished warmup
  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.66it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.70it/s] 23%|██▎       | 15/65 [00:13<00:29,  1.72it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.74it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.76it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.77it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.77it/s] 31%|███       | 20/65 [00:16<00:27,  1.62it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.67it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.71it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.77it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 1.1201623889116141
spatial_difference_train: 21.227001248873197
total_train: 22.34716356717623
time taken to perform 1: 42.04
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:47,  5.42s/it]  3%|▎         | 2/65 [00:05<02:41,  2.57s/it]  5%|▍         | 3/65 [00:06<01:43,  1.66s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<01:03,  1.06s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:09<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:31,  1.61it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.66it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.70it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.64it/s] 40%|████      | 26/65 [00:19<00:23,  1.68it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.79it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.64it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.72it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.74it/s] 60%|██████    | 39/65 [00:27<00:14,  1.76it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.78it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.64it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.74it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.76it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.77it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.78it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.65it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 2/3_____

mask_train: 0.8582807352909675
spatial_difference_train: 20.01096816429725
total_train: 20.869248903714695
time taken to perform 2: 42.22
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.32s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.7505968711315057
spatial_difference_train: 19.36516844920623
total_train: 20.11576527326535
time taken to perform 3: 41.80
[22.34716356717623, 20.869248903714695, 20.11576527326535]
Using minimum loss from history: 20.11576527326535
[I 2025-02-17 23:32:25,273] Trial 35 finished with value: 20.11576527326535 and parameters: {'lr_init_phase2': 0.0001886203433241109, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.00013226983016877714, 'lr_gamma_phase2': 0.9767262819139684, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 200}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_233017-7ly698b7
wandb: Find logs at: ./wandb/offline-run-20250217_233017-7ly698b7/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.83s/it]  3%|▎         | 2/65 [00:05<02:47,  2.67s/it]  5%|▍         | 3/65 [00:06<01:46,  1.71s/it]  6%|▌         | 4/65 [00:07<01:16,  1.26s/it]  8%|▊         | 5/65 [00:07<01:00,  1.02s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.81it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:16<00:26,  1.67it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.71it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.75it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:20<00:20,  1.82it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.72it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.75it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.82it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.72it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.68it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9267821972186748
spatial_difference_train: 19.3318722651555
total_train: 20.258654550405648
time taken to perform 1: 41.58
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:03,  4.75s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7225612528049029
spatial_difference_train: 17.310938989199126
total_train: 18.033500304588905
time taken to perform 2: 41.65
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:33,  5.21s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.6210587373146644
spatial_difference_train: 16.205380317492363
total_train: 16.826439099434094
time taken to perform 3: 41.68
[20.258654550405648, 18.033500304588905, 16.826439099434094]
Using minimum loss from history: 16.826439099434094
[I 2025-02-17 23:34:31,987] Trial 36 finished with value: 16.826439099434094 and parameters: {'lr_init_phase2': 0.00024377259853738893, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0004373577769852596, 'lr_gamma_phase2': 0.9532677398128683, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 700}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_233225-caaypt1c
wandb: Find logs at: ./wandb/offline-run-20250217_233225-caaypt1c/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:05<05:45,  5.39s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]finished warmup
  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.47it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.63it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.68it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.71it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:31<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 2.548496026259202
spatial_difference_train: 24.256241548978366
total_train: 26.804737501878005
time taken to perform 1: 41.96
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:57,  5.58s/it]  3%|▎         | 2/65 [00:06<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:08<01:04,  1.07s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:09<00:45,  1.27it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.40it/s] 14%|█▍        | 9/65 [00:10<00:37,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.69it/s] 20%|██        | 13/65 [00:12<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.74it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.70it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:16<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:17<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.78it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.79it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:20<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.72it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.77it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:29<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.78it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.79it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:42<00:00,  1.65it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 2/3_____

mask_train: 2.1964996888087347
spatial_difference_train: 24.133882742661697
total_train: 26.330382361778845
time taken to perform 2: 42.31
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:35,  5.25s/it]  3%|▎         | 2/65 [00:05<02:37,  2.51s/it]  5%|▍         | 3/65 [00:06<01:40,  1.63s/it]  6%|▌         | 4/65 [00:06<01:14,  1.21s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 1.9979404718447955
spatial_difference_train: 24.053293795463368
total_train: 26.05123423062838
time taken to perform 3: 41.82
[26.804737501878005, 26.330382361778845, 26.05123423062838]
Using minimum loss from history: 26.05123423062838
[I 2025-02-17 23:36:39,869] Trial 37 finished with value: 26.05123423062838 and parameters: {'lr_init_phase2': 1.2194969654918024e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.00025000343820998067, 'lr_gamma_phase2': 0.9258584878809264, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 500}. Best is trial 27 with value: 16.352399723346416.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_233432-3e09q7h7
wandb: Find logs at: ./wandb/offline-run-20250217_233432-3e09q7h7/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:24,  5.07s/it]  3%|▎         | 2/65 [00:05<02:33,  2.43s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.75it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.9105699126537029
spatial_difference_train: 18.753731096707856
total_train: 19.664301065298226
time taken to perform 1: 41.67
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.19s/it]  3%|▎         | 2/65 [00:05<02:36,  2.48s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.81it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.80it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7099912455448738
spatial_difference_train: 16.745367416968712
total_train: 17.455358666640063
time taken to perform 2: 41.82
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:24,  5.08s/it]  3%|▎         | 2/65 [00:05<02:33,  2.43s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.48it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.58it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.53it/s] 17%|█▋        | 11/65 [00:10<00:33,  1.61it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.67it/s] 20%|██        | 13/65 [00:11<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.79it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.80it/s] 28%|██▊       | 18/65 [00:14<00:25,  1.81it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.82it/s] 31%|███       | 20/65 [00:15<00:26,  1.68it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.72it/s] 34%|███▍      | 22/65 [00:16<00:24,  1.75it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:19<00:20,  1.82it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.83it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.68it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.72it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.75it/s] 51%|█████     | 33/65 [00:23<00:18,  1.78it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.82it/s] 58%|█████▊    | 38/65 [00:25<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.83it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.68it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.72it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.76it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.78it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:29<00:11,  1.81it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:30<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.83it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.68it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:33<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.78it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.81it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.82it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.83it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.68it/s] 94%|█████████▍| 61/65 [00:38<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:39<00:01,  1.78it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.58it/s]

______epoch summary 3/3_____

mask_train: 0.6084563539578365
spatial_difference_train: 15.73523954733824
total_train: 16.34369588509584
time taken to perform 3: 41.08
[19.664301065298226, 17.455358666640063, 16.34369588509584]
Using minimum loss from history: 16.34369588509584
[I 2025-02-17 23:38:46,341] Trial 38 finished with value: 16.34369588509584 and parameters: {'lr_init_phase2': 0.00029803621047796644, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00010261220050847798, 'lr_gamma_phase2': 0.9654861755960589, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1900}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_233640-xlt9dfkv
wandb: Find logs at: ./wandb/offline-run-20250217_233640-xlt9dfkv/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.92s/it]  3%|▎         | 2/65 [00:05<02:29,  2.37s/it]  5%|▍         | 3/65 [00:06<01:52,  1.81s/it]  6%|▌         | 4/65 [00:07<01:20,  1.32s/it]  8%|▊         | 5/65 [00:07<01:03,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:37,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9950220337280861
spatial_difference_train: 20.65524632380559
total_train: 21.650268231905425
time taken to perform 1: 42.07
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:13,  4.90s/it]  3%|▎         | 2/65 [00:05<02:35,  2.46s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.72it/s] 20%|██        | 13/65 [00:11<00:29,  1.75it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.77it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.73it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.80it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.81it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.82it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.82it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.81it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.81it/s] 51%|█████     | 33/65 [00:23<00:17,  1.81it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.82it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.67it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.71it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.75it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.77it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.80it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.81it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.82it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.82it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.82it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.67it/s] 71%|███████   | 46/65 [00:30<00:11,  1.72it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.75it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.77it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.81it/s] 80%|████████  | 52/65 [00:33<00:07,  1.82it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.82it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.82it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.67it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.71it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.75it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.77it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.81it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.82it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.82it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.82it/s]100%|██████████| 65/65 [00:41<00:00,  1.67it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 2/3_____

mask_train: 0.7587858725052613
spatial_difference_train: 18.72079279239361
total_train: 19.47957860506498
time taken to perform 2: 41.43
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:18,  4.98s/it]  3%|▎         | 2/65 [00:05<02:30,  2.40s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.48it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.58it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.52it/s] 17%|█▋        | 11/65 [00:10<00:33,  1.60it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.66it/s] 20%|██        | 13/65 [00:11<00:30,  1.71it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.79it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.80it/s] 28%|██▊       | 18/65 [00:14<00:25,  1.81it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.82it/s] 31%|███       | 20/65 [00:15<00:26,  1.67it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.71it/s] 34%|███▍      | 22/65 [00:16<00:24,  1.75it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:19<00:20,  1.82it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.83it/s] 46%|████▌     | 30/65 [00:21<00:20,  1.67it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.72it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.75it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.81it/s] 55%|█████▌    | 36/65 [00:24<00:15,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.82it/s] 58%|█████▊    | 38/65 [00:25<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.83it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.72it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:29<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:30<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:31<00:08,  1.83it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.68it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:33<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.78it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:35<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.83it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:38<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:39<00:01,  1.78it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.58it/s]

______epoch summary 3/3_____

mask_train: 0.6449050817734155
spatial_difference_train: 17.53023158831474
total_train: 18.17513662484976
time taken to perform 3: 41.06
[21.650268231905425, 19.47957860506498, 18.17513662484976]
Using minimum loss from history: 18.17513662484976
[I 2025-02-17 23:40:52,766] Trial 39 finished with value: 18.17513662484976 and parameters: {'lr_init_phase2': 0.00015001301196266662, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0001050694816222442, 'lr_gamma_phase2': 0.9420029570690381, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1900}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_233846-263wiie0
wandb: Find logs at: ./wandb/offline-run-20250217_233846-263wiie0/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:06,  4.79s/it]  3%|▎         | 2/65 [00:05<02:32,  2.41s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:10<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.66it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.70it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.73it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.75it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.4151427250642044
spatial_difference_train: 23.007158338106596
total_train: 24.422301131028394
time taken to perform 1: 41.68
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:29,  5.15s/it]  3%|▎         | 2/65 [00:05<02:34,  2.46s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.81it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.71it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.78it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.80it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.81it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.67it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.71it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 1.1045450820372655
spatial_difference_train: 22.27195339202881
total_train: 23.376498530461237
time taken to perform 2: 41.75
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:44,  5.38s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:31,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.68it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.71it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.75it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.77it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.9576679199169844
spatial_difference_train: 21.832711459428836
total_train: 22.790379431308843
time taken to perform 3: 42.06
[24.422301131028394, 23.376498530461237, 22.790379431308843]
Using minimum loss from history: 22.790379431308843
[I 2025-02-17 23:43:00,125] Trial 40 finished with value: 22.790379431308843 and parameters: {'lr_init_phase2': 7.54481562195487e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0001509000008345214, 'lr_gamma_phase2': 0.9645430571084199, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1900}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_234053-31a79fvr
wandb: Find logs at: ./wandb/offline-run-20250217_234053-31a79fvr/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.96s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:44,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.79it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.80it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.81it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:20<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.81it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.82it/s] 60%|██████    | 39/65 [00:26<00:14,  1.82it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:30<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.82it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.82it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.77it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 1/3_____

mask_train: 0.9238230531032269
spatial_difference_train: 19.310434224055363
total_train: 20.23425727257362
time taken to perform 1: 41.47
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:39,  5.31s/it]  3%|▎         | 2/65 [00:05<02:39,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<01:02,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.65it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.69it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.69it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.78it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.79it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.64it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7191474162615262
spatial_difference_train: 17.289271391355076
total_train: 18.00841880945059
time taken to perform 2: 42.03
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:06<06:24,  6.00s/it]  3%|▎         | 2/65 [00:06<02:56,  2.81s/it]  5%|▍         | 3/65 [00:07<01:50,  1.79s/it]  6%|▌         | 4/65 [00:07<01:19,  1.31s/it]  8%|▊         | 5/65 [00:08<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:09<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:11<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:12<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:15<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:16<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:19<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:20<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:21<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:23<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.74it/s] 51%|█████     | 33/65 [00:24<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:25<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.78it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.79it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:28<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:31<00:11,  1.79it/s] 71%|███████   | 46/65 [00:31<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:32<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.79it/s] 75%|███████▌  | 49/65 [00:33<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.64it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:35<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:36<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.53it/s]

______epoch summary 3/3_____

mask_train: 0.6159745369202051
spatial_difference_train: 16.18679323440943
total_train: 16.80276777805426
time taken to perform 3: 42.42
[20.23425727257362, 18.00841880945059, 16.80276777805426]
Using minimum loss from history: 16.80276777805426
[I 2025-02-17 23:45:07,889] Trial 41 finished with value: 16.80276777805426 and parameters: {'lr_init_phase2': 0.00024561511429931646, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00012694769161284434, 'lr_gamma_phase2': 0.9697455344999111, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 1700}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_234300-fqeezimp
wandb: Find logs at: ./wandb/offline-run-20250217_234300-fqeezimp/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.91s/it]  3%|▎         | 2/65 [00:05<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:51,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.75it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.65it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9488950628500719
spatial_difference_train: 19.910914582472582
total_train: 20.859809494018556
time taken to perform 1: 41.89
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.30s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:14,  1.21s/it]  8%|▊         | 5/65 [00:07<01:02,  1.05s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.69it/s] 20%|██        | 13/65 [00:12<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.74it/s] 23%|██▎       | 15/65 [00:13<00:31,  1.61it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.70it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.73it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.75it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.74it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.76it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.78it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.79it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7334513077369103
spatial_difference_train: 17.912359347710243
total_train: 18.645810567415676
time taken to perform 2: 41.98
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:21,  5.02s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:42,  1.35it/s] 12%|█▏        | 8/65 [00:08<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.51it/s] 17%|█▋        | 11/65 [00:10<00:34,  1.59it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:11<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:15<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:20<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:27<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:32<00:09,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 3/3_____

mask_train: 0.6277164931480701
spatial_difference_train: 16.742554102188503
total_train: 17.37027053833008
time taken to perform 3: 41.41
[20.859809494018556, 18.645810567415676, 17.37027053833008]
Using minimum loss from history: 17.37027053833008
[I 2025-02-17 23:47:14,952] Trial 42 finished with value: 17.37027053833008 and parameters: {'lr_init_phase2': 0.00019824711774075635, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00017187385630127553, 'lr_gamma_phase2': 0.9835410745141213, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1600}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_234508-jqgnwuij
wandb: Find logs at: ./wandb/offline-run-20250217_234508-jqgnwuij/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:37,  5.27s/it]  3%|▎         | 2/65 [00:05<02:37,  2.51s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 0.912676256436568
spatial_difference_train: 18.76130937429575
total_train: 19.67398555462177
time taken to perform 1: 41.80
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:18,  4.98s/it]  3%|▎         | 2/65 [00:05<02:35,  2.46s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.29it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:14<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.65it/s] 40%|████      | 26/65 [00:19<00:23,  1.69it/s] 42%|████▏     | 27/65 [00:20<00:22,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.79it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.78it/s] 51%|█████     | 33/65 [00:23<00:17,  1.78it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.63it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.67it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.70it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.73it/s] 60%|██████    | 39/65 [00:27<00:14,  1.75it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.76it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.77it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.78it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.79it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.64it/s] 71%|███████   | 46/65 [00:31<00:11,  1.68it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.72it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.74it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.76it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.77it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.78it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.64it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.69it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.72it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 2/3_____

mask_train: 0.7145078136370733
spatial_difference_train: 16.752504854935864
total_train: 17.46701259613037
time taken to perform 2: 41.92
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:09,  5.77s/it]  3%|▎         | 2/65 [00:06<02:50,  2.71s/it]  5%|▍         | 3/65 [00:06<01:47,  1.73s/it]  6%|▌         | 4/65 [00:07<01:17,  1.28s/it]  8%|▊         | 5/65 [00:08<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:09<00:44,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:12<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.70it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.74it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.76it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.78it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.80it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.81it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.82it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.71it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.77it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.79it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.80it/s] 40%|████      | 26/65 [00:19<00:21,  1.81it/s] 42%|████▏     | 27/65 [00:20<00:20,  1.81it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.82it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.82it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.77it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.79it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.80it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.81it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.82it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.82it/s] 60%|██████    | 39/65 [00:27<00:14,  1.83it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.67it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.72it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.75it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.78it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.81it/s] 71%|███████   | 46/65 [00:31<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.83it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.72it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.77it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.83it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.68it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.78it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.615732192229002
spatial_difference_train: 15.740992477612618
total_train: 16.356724602136858
time taken to perform 3: 41.87
[19.67398555462177, 17.46701259613037, 16.356724602136858]
Using minimum loss from history: 16.356724602136858
[I 2025-02-17 23:49:22,269] Trial 43 finished with value: 16.356724602136858 and parameters: {'lr_init_phase2': 0.00029726011945056173, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00010042651869643393, 'lr_gamma_phase2': 0.9558964945135772, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 1900}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_234715-nw3nxmrh
wandb: Find logs at: ./wandb/offline-run-20250217_234715-nw3nxmrh/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:45,  5.41s/it]  3%|▎         | 2/65 [00:05<02:41,  2.57s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9290375737043527
spatial_difference_train: 19.350990207378683
total_train: 20.280027829683743
time taken to perform 1: 41.92
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:04,  4.76s/it]  3%|▎         | 2/65 [00:05<02:26,  2.33s/it]  5%|▍         | 3/65 [00:05<01:34,  1.53s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:07<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:08<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.69it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.73it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.76it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.80it/s] 34%|███▍      | 22/65 [00:16<00:23,  1.81it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.81it/s] 37%|███▋      | 24/65 [00:17<00:22,  1.82it/s] 38%|███▊      | 25/65 [00:18<00:23,  1.67it/s] 40%|████      | 26/65 [00:19<00:22,  1.71it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.74it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.77it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.81it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.81it/s] 51%|█████     | 33/65 [00:23<00:17,  1.82it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.82it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.67it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.71it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:25<00:15,  1.77it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.80it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.81it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.81it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.82it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.82it/s] 69%|██████▉   | 45/65 [00:29<00:11,  1.67it/s] 71%|███████   | 46/65 [00:30<00:11,  1.71it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.75it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.77it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.81it/s] 80%|████████  | 52/65 [00:33<00:07,  1.81it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.82it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.82it/s] 85%|████████▍ | 55/65 [00:35<00:05,  1.67it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.71it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.75it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.77it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:38<00:02,  1.80it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.81it/s] 97%|█████████▋| 63/65 [00:39<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.82it/s]100%|██████████| 65/65 [00:41<00:00,  1.67it/s]100%|██████████| 65/65 [00:41<00:00,  1.58it/s]

______epoch summary 2/3_____

mask_train: 0.7232856601476669
spatial_difference_train: 17.33030670606173
total_train: 18.053592403118426
time taken to perform 2: 41.22
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:54,  5.54s/it]  3%|▎         | 2/65 [00:06<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.64it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.67it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.6220585370675111
spatial_difference_train: 16.222042103302783
total_train: 16.84410066849146
time taken to perform 3: 41.91
[20.280027829683743, 18.053592403118426, 16.84410066849146]
Using minimum loss from history: 16.84410066849146
[I 2025-02-17 23:51:29,225] Trial 44 finished with value: 16.84410066849146 and parameters: {'lr_init_phase2': 0.00024213692727113723, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00010656908854486819, 'lr_gamma_phase2': 0.9491531495424637, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 2000}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_234922-d498jihd
wandb: Find logs at: ./wandb/offline-run-20250217_234922-d498jihd/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:51,  5.50s/it]  3%|▎         | 2/65 [00:06<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:25<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 1/3_____

mask_train: 0.9572791695594788
spatial_difference_train: 20.019256239670973
total_train: 20.97653538630559
time taken to perform 1: 42.13
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.82s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:51,  1.14it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.72it/s] 20%|██        | 13/65 [00:11<00:29,  1.75it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.78it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.64it/s] 25%|██▍       | 16/65 [00:13<00:28,  1.70it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.74it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.76it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:15<00:25,  1.80it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.81it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.81it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.82it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.82it/s] 38%|███▊      | 25/65 [00:18<00:23,  1.67it/s] 40%|████      | 26/65 [00:19<00:22,  1.71it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.75it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.77it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.81it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.82it/s] 51%|█████     | 33/65 [00:23<00:17,  1.82it/s] 52%|█████▏    | 34/65 [00:23<00:16,  1.83it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.67it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.71it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.78it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.81it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.80it/s]100%|██████████| 65/65 [00:41<00:00,  1.64it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 2/3_____

mask_train: 0.7390118179412989
spatial_difference_train: 18.02778083361112
total_train: 18.766792708176833
time taken to perform 2: 41.54
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:51,  5.49s/it]  3%|▎         | 2/65 [00:06<02:43,  2.60s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.49it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.78it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.79it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.74it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:29<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.74it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.76it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.77it/s] 71%|███████   | 46/65 [00:31<00:10,  1.78it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:38<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:42<00:00,  1.78it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 3/3_____

mask_train: 0.6316602654946156
spatial_difference_train: 16.85052797855475
total_train: 17.482188273698856
time taken to perform 3: 42.10
[20.97653538630559, 18.766792708176833, 17.482188273698856]
Using minimum loss from history: 17.482188273698856
[I 2025-02-17 23:53:36,738] Trial 45 finished with value: 17.482188273698856 and parameters: {'lr_init_phase2': 0.00019056539227811802, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00012638840098729058, 'lr_gamma_phase2': 0.9567701886373574, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1900}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_235129-pyo0a9kg
wandb: Find logs at: ./wandb/offline-run-20250217_235129-pyo0a9kg/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.82s/it]  3%|▎         | 2/65 [00:06<02:51,  2.73s/it]  5%|▍         | 3/65 [00:06<01:48,  1.74s/it]  6%|▌         | 4/65 [00:07<01:18,  1.28s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.52it/s] 15%|█▌        | 10/65 [00:10<00:38,  1.44it/s] 17%|█▋        | 11/65 [00:11<00:35,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.61it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.71it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:31<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 0.9125506575290974
spatial_difference_train: 18.746317848792444
total_train: 19.6588686136099
time taken to perform 1: 41.94
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:21,  5.03s/it]  3%|▎         | 2/65 [00:05<02:31,  2.41s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:51,  1.15it/s] 11%|█         | 7/65 [00:08<00:44,  1.30it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.63it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.77it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.79it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.81it/s] 38%|███▊      | 25/65 [00:18<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:20<00:21,  1.76it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.80it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.81it/s] 52%|█████▏    | 34/65 [00:23<00:17,  1.81it/s] 54%|█████▍    | 35/65 [00:24<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.74it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.76it/s] 60%|██████    | 39/65 [00:26<00:14,  1.78it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.80it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.81it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:09,  1.78it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.79it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.80it/s] 80%|████████  | 52/65 [00:34<00:07,  1.80it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.81it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.71it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.79it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.80it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.80it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.81it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.66it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 0.7169690918463927
spatial_difference_train: 16.738394377781795
total_train: 17.455363493699295
time taken to perform 2: 41.62
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.32s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.33it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.46it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.55it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.58it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.69it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.81it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.67it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.78it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.80it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.81it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.67it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.71it/s] 80%|████████  | 52/65 [00:34<00:07,  1.74it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.78it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.80it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.81it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.67it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.71it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.74it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 0.6175955005181142
spatial_difference_train: 15.729622474083534
total_train: 16.34721799508119
time taken to perform 3: 41.69
[19.6588686136099, 17.455363493699295, 16.34721799508119]
Using minimum loss from history: 16.34721799508119
[I 2025-02-17 23:55:43,742] Trial 46 finished with value: 16.34721799508119 and parameters: {'lr_init_phase2': 0.0002987986033429904, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00010090344522750609, 'lr_gamma_phase2': 0.9415942503661358, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1500}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_235337-6yg15p21
wandb: Find logs at: ./wandb/offline-run-20250217_235337-6yg15p21/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.94s/it]  3%|▎         | 2/65 [00:05<02:30,  2.38s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.46it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.55it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:22<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.65it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.79it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.65it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.69it/s] 80%|████████  | 52/65 [00:34<00:07,  1.72it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.76it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.76it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.78it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.79it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.79it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.64it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.68it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.76it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 2.003840508827796
spatial_difference_train: 23.983832462017354
total_train: 25.987673069880557
time taken to perform 1: 41.75
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.84s/it]  3%|▎         | 2/65 [00:05<02:27,  2.33s/it]  5%|▍         | 3/65 [00:05<01:35,  1.53s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:07<00:51,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.71it/s] 20%|██        | 13/65 [00:11<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.76it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:13<00:29,  1.68it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.72it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.75it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.80it/s] 34%|███▍      | 22/65 [00:16<00:23,  1.81it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.82it/s] 37%|███▋      | 24/65 [00:17<00:22,  1.82it/s] 38%|███▊      | 25/65 [00:18<00:23,  1.67it/s] 40%|████      | 26/65 [00:19<00:22,  1.71it/s] 42%|████▏     | 27/65 [00:19<00:21,  1.75it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.77it/s] 45%|████▍     | 29/65 [00:20<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.81it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.82it/s] 51%|█████     | 33/65 [00:23<00:17,  1.82it/s] 52%|█████▏    | 34/65 [00:23<00:16,  1.83it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.68it/s] 55%|█████▌    | 36/65 [00:24<00:16,  1.72it/s] 57%|█████▋    | 37/65 [00:25<00:16,  1.75it/s] 58%|█████▊    | 38/65 [00:25<00:15,  1.77it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.80it/s] 63%|██████▎   | 41/65 [00:27<00:13,  1.81it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.81it/s] 66%|██████▌   | 43/65 [00:28<00:12,  1.82it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.82it/s] 69%|██████▉   | 45/65 [00:29<00:12,  1.66it/s] 71%|███████   | 46/65 [00:30<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.74it/s] 74%|███████▍  | 48/65 [00:31<00:09,  1.76it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.78it/s] 77%|███████▋  | 50/65 [00:32<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.81it/s] 80%|████████  | 52/65 [00:33<00:07,  1.81it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.82it/s] 83%|████████▎ | 54/65 [00:34<00:06,  1.81it/s] 85%|████████▍ | 55/65 [00:35<00:06,  1.66it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:36<00:04,  1.74it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.76it/s] 91%|█████████ | 59/65 [00:37<00:03,  1.78it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:38<00:02,  1.81it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.81it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.82it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.82it/s]100%|██████████| 65/65 [00:41<00:00,  1.67it/s]100%|██████████| 65/65 [00:41<00:00,  1.57it/s]

______epoch summary 2/3_____

mask_train: 1.4938221711378832
spatial_difference_train: 23.42763803922213
total_train: 24.921460269047664
time taken to perform 2: 41.28
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:49,  5.46s/it]  3%|▎         | 2/65 [00:06<02:43,  2.59s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:31,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.77it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.78it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:17<00:26,  1.69it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:18<00:24,  1.74it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 1.2322669775058062
spatial_difference_train: 22.889835827167218
total_train: 24.122102815676957
time taken to perform 3: 42.01
[25.987673069880557, 24.921460269047664, 24.122102815676957]
Using minimum loss from history: 24.122102815676957
[I 2025-02-17 23:57:50,568] Trial 47 finished with value: 24.122102815676957 and parameters: {'lr_init_phase2': 1.6252358500514383e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00010119314284198529, 'lr_gamma_phase2': 0.9403892265629422, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 1500}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_235544-j8lziuvw
wandb: Find logs at: ./wandb/offline-run-20250217_235544-j8lziuvw/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.20s/it]  3%|▎         | 2/65 [00:06<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.43it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.45it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.54it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.62it/s] 20%|██        | 13/65 [00:12<00:31,  1.67it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.71it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.74it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.78it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.80it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.81it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.73it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.71it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.74it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.77it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.80it/s] 71%|███████   | 46/65 [00:31<00:10,  1.81it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.82it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.82it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.83it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.68it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.72it/s] 80%|████████  | 52/65 [00:34<00:07,  1.75it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.78it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.79it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.81it/s] 86%|████████▌ | 56/65 [00:36<00:04,  1.81it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.82it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.82it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.83it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.68it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.72it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.75it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.78it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.79it/s]100%|██████████| 65/65 [00:41<00:00,  1.81it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 1/3_____

mask_train: 1.6368423947921167
spatial_difference_train: 23.545884323120116
total_train: 25.182726698655348
time taken to perform 1: 41.77
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:55,  5.56s/it]  3%|▎         | 2/65 [00:06<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:08<01:04,  1.07s/it]  9%|▉         | 6/65 [00:08<00:52,  1.12it/s] 11%|█         | 7/65 [00:09<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.41it/s] 14%|█▍        | 9/65 [00:10<00:37,  1.51it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.65it/s] 18%|█▊        | 12/65 [00:11<00:31,  1.70it/s] 20%|██        | 13/65 [00:12<00:30,  1.73it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.75it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.62it/s] 25%|██▍       | 16/65 [00:14<00:29,  1.67it/s] 26%|██▌       | 17/65 [00:14<00:28,  1.71it/s] 28%|██▊       | 18/65 [00:15<00:27,  1.74it/s] 29%|██▉       | 19/65 [00:15<00:26,  1.76it/s] 31%|███       | 20/65 [00:16<00:25,  1.77it/s] 32%|███▏      | 21/65 [00:17<00:24,  1.78it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.79it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.80it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.80it/s] 38%|███▊      | 25/65 [00:19<00:24,  1.66it/s] 40%|████      | 26/65 [00:19<00:22,  1.70it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.73it/s] 43%|████▎     | 28/65 [00:21<00:21,  1.75it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.77it/s] 46%|████▌     | 30/65 [00:22<00:19,  1.78it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.79it/s] 49%|████▉     | 32/65 [00:23<00:18,  1.80it/s] 51%|█████     | 33/65 [00:23<00:17,  1.80it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.80it/s] 54%|█████▍    | 35/65 [00:25<00:18,  1.66it/s] 55%|█████▌    | 36/65 [00:25<00:17,  1.70it/s] 57%|█████▋    | 37/65 [00:26<00:16,  1.73it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.75it/s] 60%|██████    | 39/65 [00:27<00:14,  1.77it/s] 62%|██████▏   | 40/65 [00:27<00:14,  1.78it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.79it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.79it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.80it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.79it/s] 69%|██████▉   | 45/65 [00:30<00:12,  1.65it/s] 71%|███████   | 46/65 [00:31<00:11,  1.70it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.73it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.75it/s] 75%|███████▌  | 49/65 [00:33<00:09,  1.77it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.78it/s] 78%|███████▊  | 51/65 [00:34<00:07,  1.79it/s] 80%|████████  | 52/65 [00:34<00:07,  1.79it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.80it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.80it/s] 85%|████████▍ | 55/65 [00:36<00:06,  1.65it/s] 86%|████████▌ | 56/65 [00:37<00:05,  1.70it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.73it/s] 89%|████████▉ | 58/65 [00:38<00:04,  1.75it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.77it/s] 92%|█████████▏| 60/65 [00:39<00:02,  1.78it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.79it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.79it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.80it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.80it/s]100%|██████████| 65/65 [00:42<00:00,  1.66it/s]100%|██████████| 65/65 [00:42<00:00,  1.54it/s]

______epoch summary 2/3_____

mask_train: 1.1924212359465085
spatial_difference_train: 22.604215416541468
total_train: 23.7966366987962
time taken to perform 2: 42.23
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:56,  5.57s/it]  3%|▎         | 2/65 [00:06<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:45,  1.69s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:43,  1.32it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.45it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.48it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.57it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:30,  1.68it/s] 22%|██▏       | 14/65 [00:13<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:14<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.66it/s] 32%|███▏      | 21/65 [00:17<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:18<00:23,  1.76it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.79it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.81it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.66it/s] 48%|████▊     | 31/65 [00:22<00:19,  1.70it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.74it/s] 51%|█████     | 33/65 [00:23<00:18,  1.76it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.78it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.79it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.80it/s] 57%|█████▋    | 37/65 [00:26<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:30<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:09,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:34<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.76it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.79it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.65it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.69it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.72it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.74it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.74it/s]100%|██████████| 65/65 [00:42<00:00,  1.75it/s]100%|██████████| 65/65 [00:42<00:00,  1.55it/s]

______epoch summary 3/3_____

mask_train: 0.9805778136620155
spatial_difference_train: 21.799739612677158
total_train: 22.78031743367513
time taken to perform 3: 42.05
[25.182726698655348, 23.7966366987962, 22.78031743367513]
Using minimum loss from history: 22.78031743367513
[I 2025-02-17 23:59:58,862] Trial 48 finished with value: 22.78031743367513 and parameters: {'lr_init_phase2': 2.9683371287319676e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0001239071312201207, 'lr_gamma_phase2': 0.9464336642419237, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1800}. Best is trial 38 with value: 16.34369588509584.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_235751-vvbympkm
wandb: Find logs at: ./wandb/offline-run-20250217_235751-vvbympkm/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:23,  5.05s/it]  3%|▎         | 2/65 [00:05<02:40,  2.55s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:44,  1.31it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:36,  1.54it/s] 15%|█▌        | 10/65 [00:10<00:37,  1.47it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.56it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.63it/s] 20%|██        | 13/65 [00:12<00:31,  1.68it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.72it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.74it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.76it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.78it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.79it/s] 31%|███       | 20/65 [00:16<00:27,  1.64it/s] 32%|███▏      | 21/65 [00:16<00:26,  1.68it/s] 34%|███▍      | 22/65 [00:17<00:25,  1.72it/s] 35%|███▌      | 23/65 [00:17<00:24,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.76it/s] 38%|███▊      | 25/65 [00:19<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.79it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.80it/s] 46%|████▌     | 30/65 [00:22<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.76it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.78it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.79it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.80it/s] 60%|██████    | 39/65 [00:27<00:14,  1.80it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.64it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.69it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.72it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.75it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.78it/s] 71%|███████   | 46/65 [00:31<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.80it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:35<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.80it/s] 92%|█████████▏| 60/65 [00:39<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.75it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.55it/s]

______epoch summary 1/3_____

mask_train: 2.295042186516982
spatial_difference_train: 24.168063735961915
total_train: 26.463105949988734
time taken to perform 1: 41.89
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:44,  5.38s/it]  3%|▎         | 2/65 [00:05<02:40,  2.55s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<01:03,  1.06s/it]  9%|▉         | 6/65 [00:08<00:52,  1.13it/s] 11%|█         | 7/65 [00:08<00:45,  1.28it/s] 12%|█▏        | 8/65 [00:09<00:40,  1.42it/s] 14%|█▍        | 9/65 [00:10<00:36,  1.53it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.67it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.71it/s] 20%|██        | 13/65 [00:12<00:29,  1.75it/s] 22%|██▏       | 14/65 [00:12<00:28,  1.77it/s] 23%|██▎       | 15/65 [00:13<00:30,  1.64it/s] 25%|██▍       | 16/65 [00:14<00:28,  1.69it/s] 26%|██▌       | 17/65 [00:14<00:27,  1.73it/s] 28%|██▊       | 18/65 [00:15<00:26,  1.76it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.78it/s] 31%|███       | 20/65 [00:16<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:16<00:24,  1.80it/s] 34%|███▍      | 22/65 [00:17<00:23,  1.81it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.82it/s] 37%|███▋      | 24/65 [00:18<00:22,  1.82it/s] 38%|███▊      | 25/65 [00:19<00:23,  1.67it/s] 40%|████      | 26/65 [00:19<00:22,  1.72it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.75it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.77it/s] 45%|████▍     | 29/65 [00:21<00:20,  1.79it/s] 46%|████▌     | 30/65 [00:21<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:22<00:18,  1.81it/s] 49%|████▉     | 32/65 [00:22<00:18,  1.82it/s] 51%|█████     | 33/65 [00:23<00:17,  1.82it/s] 52%|█████▏    | 34/65 [00:24<00:16,  1.82it/s] 54%|█████▍    | 35/65 [00:24<00:17,  1.68it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.72it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.75it/s] 58%|█████▊    | 38/65 [00:26<00:15,  1.77it/s] 60%|██████    | 39/65 [00:26<00:14,  1.79it/s] 62%|██████▏   | 40/65 [00:27<00:13,  1.80it/s] 63%|██████▎   | 41/65 [00:28<00:13,  1.81it/s] 65%|██████▍   | 42/65 [00:28<00:12,  1.82it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.82it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.82it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.67it/s] 71%|███████   | 46/65 [00:30<00:11,  1.72it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.75it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.77it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.79it/s] 77%|███████▋  | 50/65 [00:33<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:33<00:07,  1.81it/s] 80%|████████  | 52/65 [00:34<00:07,  1.82it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.82it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.82it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.67it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.72it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.75it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.77it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.79it/s] 92%|█████████▏| 60/65 [00:38<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.81it/s] 95%|█████████▌| 62/65 [00:39<00:01,  1.82it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.82it/s] 98%|█████████▊| 64/65 [00:40<00:00,  1.82it/s]100%|██████████| 65/65 [00:41<00:00,  1.68it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 2/3_____

mask_train: 1.752522426385146
spatial_difference_train: 23.81431762988751
total_train: 25.566840054438664
time taken to perform 2: 41.69
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.34s/it]  3%|▎         | 2/65 [00:05<02:39,  2.54s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:43,  1.34it/s] 12%|█▏        | 8/65 [00:09<00:38,  1.47it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.56it/s] 15%|█▌        | 10/65 [00:10<00:36,  1.50it/s] 17%|█▋        | 11/65 [00:11<00:34,  1.59it/s] 18%|█▊        | 12/65 [00:11<00:32,  1.65it/s] 20%|██        | 13/65 [00:12<00:30,  1.70it/s] 22%|██▏       | 14/65 [00:12<00:29,  1.73it/s] 23%|██▎       | 15/65 [00:13<00:28,  1.75it/s] 25%|██▍       | 16/65 [00:13<00:27,  1.77it/s] 26%|██▌       | 17/65 [00:14<00:26,  1.78it/s] 28%|██▊       | 18/65 [00:14<00:26,  1.79it/s] 29%|██▉       | 19/65 [00:15<00:25,  1.80it/s] 31%|███       | 20/65 [00:16<00:27,  1.65it/s] 32%|███▏      | 21/65 [00:16<00:25,  1.70it/s] 34%|███▍      | 22/65 [00:17<00:24,  1.73it/s] 35%|███▌      | 23/65 [00:17<00:23,  1.75it/s] 37%|███▋      | 24/65 [00:18<00:23,  1.77it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.78it/s] 40%|████      | 26/65 [00:19<00:21,  1.79it/s] 42%|████▏     | 27/65 [00:20<00:21,  1.80it/s] 43%|████▎     | 28/65 [00:20<00:20,  1.80it/s] 45%|████▍     | 29/65 [00:21<00:19,  1.80it/s] 46%|████▌     | 30/65 [00:21<00:21,  1.64it/s] 48%|████▊     | 31/65 [00:22<00:20,  1.69it/s] 49%|████▉     | 32/65 [00:23<00:19,  1.72it/s] 51%|█████     | 33/65 [00:23<00:18,  1.75it/s] 52%|█████▏    | 34/65 [00:24<00:17,  1.77it/s] 54%|█████▍    | 35/65 [00:24<00:16,  1.78it/s] 55%|█████▌    | 36/65 [00:25<00:16,  1.79it/s] 57%|█████▋    | 37/65 [00:25<00:15,  1.80it/s] 58%|█████▊    | 38/65 [00:26<00:14,  1.80it/s] 60%|██████    | 39/65 [00:26<00:14,  1.81it/s] 62%|██████▏   | 40/65 [00:27<00:15,  1.66it/s] 63%|██████▎   | 41/65 [00:28<00:14,  1.70it/s] 65%|██████▍   | 42/65 [00:28<00:13,  1.73it/s] 66%|██████▌   | 43/65 [00:29<00:12,  1.76it/s] 68%|██████▊   | 44/65 [00:29<00:11,  1.77it/s] 69%|██████▉   | 45/65 [00:30<00:11,  1.79it/s] 71%|███████   | 46/65 [00:30<00:10,  1.79it/s] 72%|███████▏  | 47/65 [00:31<00:10,  1.80it/s] 74%|███████▍  | 48/65 [00:32<00:09,  1.80it/s] 75%|███████▌  | 49/65 [00:32<00:08,  1.81it/s] 77%|███████▋  | 50/65 [00:33<00:09,  1.66it/s] 78%|███████▊  | 51/65 [00:33<00:08,  1.70it/s] 80%|████████  | 52/65 [00:34<00:07,  1.73it/s] 82%|████████▏ | 53/65 [00:34<00:06,  1.75it/s] 83%|████████▎ | 54/65 [00:35<00:06,  1.77it/s] 85%|████████▍ | 55/65 [00:36<00:05,  1.78it/s] 86%|████████▌ | 56/65 [00:36<00:05,  1.79it/s] 88%|████████▊ | 57/65 [00:37<00:04,  1.80it/s] 89%|████████▉ | 58/65 [00:37<00:03,  1.80it/s] 91%|█████████ | 59/65 [00:38<00:03,  1.81it/s] 92%|█████████▏| 60/65 [00:38<00:03,  1.66it/s] 94%|█████████▍| 61/65 [00:39<00:02,  1.70it/s] 95%|█████████▌| 62/65 [00:40<00:01,  1.73it/s] 97%|█████████▋| 63/65 [00:40<00:01,  1.76it/s] 98%|█████████▊| 64/65 [00:41<00:00,  1.77it/s]100%|██████████| 65/65 [00:41<00:00,  1.78it/s]100%|██████████| 65/65 [00:41<00:00,  1.56it/s]

______epoch summary 3/3_____

mask_train: 1.4621418485274682
spatial_difference_train: 23.448199061858347
total_train: 24.91034091069148
time taken to perform 3: 41.76
[26.463105949988734, 25.566840054438664, 24.91034091069148]
Using minimum loss from history: 24.91034091069148
[I 2025-02-18 00:02:05,924] Trial 49 finished with value: 24.91034091069148 and parameters: {'lr_init_phase2': 1.0472700621080568e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00019055830017278866, 'lr_gamma_phase2': 0.9520001709874496, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1500}. Best is trial 38 with value: 16.34369588509584.
Best trial:
  Value:  16.34369588509584
  Params: 
    lr_init_phase2: 0.00029803621047796644
    lr_policy_phase3: step
    weight_decay_phase2: 0.00010261220050847798
    lr_gamma_phase2: 0.9654861755960589
    lr_step_phase2: 2000
    lr_warmup_phase2: 1900
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250217_235959-q289c9ok[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250217_235959-q289c9ok/logs[0m
