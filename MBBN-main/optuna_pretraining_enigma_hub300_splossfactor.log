[I 2025-02-18 02:28:55,422] A new study created in memory with name: no-name-b6e5c6f8-357a-4ce3-9f55-47936e1f33ec
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 95.71 MB
max cached memory: 116.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:06<07:27,  6.99s/it]  3%|▎         | 2/65 [00:08<03:48,  3.63s/it]  5%|▍         | 3/65 [00:09<02:37,  2.54s/it]  6%|▌         | 4/65 [00:10<02:04,  2.05s/it]  8%|▊         | 5/65 [00:12<01:45,  1.75s/it]  9%|▉         | 6/65 [00:12<01:18,  1.34s/it] 11%|█         | 7/65 [00:13<01:01,  1.06s/it] 12%|█▏        | 8/65 [00:13<00:50,  1.14it/s] 14%|█▍        | 9/65 [00:14<00:42,  1.32it/s] 15%|█▌        | 10/65 [00:14<00:40,  1.35it/s] 17%|█▋        | 11/65 [00:15<00:35,  1.50it/s] 18%|█▊        | 12/65 [00:15<00:32,  1.63it/s] 20%|██        | 13/65 [00:16<00:29,  1.74it/s] 22%|██▏       | 14/65 [00:16<00:28,  1.82it/s] 23%|██▎       | 15/65 [00:17<00:26,  1.88it/s] 25%|██▍       | 16/65 [00:17<00:25,  1.92it/s] 26%|██▌       | 17/65 [00:18<00:24,  1.95it/s] 28%|██▊       | 18/65 [00:18<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:19<00:23,  1.98it/s] 31%|███       | 20/65 [00:19<00:24,  1.80it/s] 32%|███▏      | 21/65 [00:20<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:20<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:21<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:21<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:22<00:20,  1.99it/s] 40%|████      | 26/65 [00:22<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:23<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:23<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:24<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:24<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:25<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:25<00:17,  1.92it/s] 51%|█████     | 33/65 [00:26<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:26<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:27<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:27<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:28<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:28<00:13,  2.01it/s] 60%|██████    | 39/65 [00:29<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:30<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:30<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:31<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:31<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:32<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:32<00:10,  1.99it/s] 71%|███████   | 46/65 [00:33<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:33<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:34<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:34<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:35<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:35<00:07,  1.87it/s] 80%|████████  | 52/65 [00:36<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:36<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:37<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:37<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:38<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:38<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:39<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:39<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:40<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:40<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:41<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:41<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:42<00:00,  1.97it/s]100%|██████████| 65/65 [00:42<00:00,  1.99it/s]100%|██████████| 65/65 [00:42<00:00,  1.52it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 22.628859329223634
total_train: 23.754142555823694
time taken to perform 1: 42.80
Starting epoch 2/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:20,  5.01s/it]  3%|▎         | 2/65 [00:05<02:30,  2.39s/it]  5%|▍         | 3/65 [00:06<01:35,  1.53s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.78it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.84it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:14<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.98it/s] 34%|███▍      | 22/65 [00:15<00:21,  1.99it/s] 35%|███▌      | 23/65 [00:16<00:21,  2.00it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:22,  1.80it/s] 40%|████      | 26/65 [00:18<00:20,  1.86it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.90it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.93it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.97it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.99it/s] 51%|█████     | 33/65 [00:21<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.81it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.86it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:11,  1.80it/s] 71%|███████   | 46/65 [00:28<00:10,  1.86it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.91it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.96it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:06,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.80it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.86it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.90it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.93it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.98it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.99it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 20.20448455810547
total_train: 21.125264637286847
time taken to perform 2: 38.20
Starting epoch 3/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:47,  5.44s/it]  3%|▎         | 2/65 [00:05<02:40,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 18.98861801929963
total_train: 19.810611177102114
time taken to perform 3: 38.16
[23.754142555823694, 21.125264637286847, 19.810611177102114]
Using minimum loss from history: 19.810611177102114
[I 2025-02-18 02:30:58,161] Trial 0 finished with value: 19.810611177102114 and parameters: {'spatial_loss_factor': 4.83141924487416}. Best is trial 0 with value: 19.810611177102114.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_022858-j492i1v9
wandb: Find logs at: ./wandb/offline-run-20250218_022858-j492i1v9/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:30,  5.17s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.89it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.92it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.94it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.96it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.98it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.89it/s] 51%|█████     | 33/65 [00:21<00:16,  1.92it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.95it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.98it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.99it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.86it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.90it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.93it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.97it/s] 71%|███████   | 46/65 [00:28<00:09,  1.98it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.99it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:08,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.86it/s] 80%|████████  | 52/65 [00:31<00:06,  1.90it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.93it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.98it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:03,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.86it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 15.100382306025578
total_train: 16.225665752704327
time taken to perform 1: 38.42
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:45,  5.39s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.75it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.81it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.85it/s] 20%|██        | 13/65 [00:11<00:27,  1.89it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.83it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.88it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.91it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.94it/s] 31%|███       | 20/65 [00:15<00:22,  1.96it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.97it/s] 34%|███▍      | 22/65 [00:16<00:21,  1.99it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.99it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.99it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.97it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.98it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.99it/s] 51%|█████     | 33/65 [00:21<00:16,  2.00it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:25<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.98it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.99it/s] 97%|█████████▋| 63/65 [00:37<00:01,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 13.482582701169527
total_train: 14.403362861046425
time taken to perform 2: 38.48
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:59,  5.62s/it]  3%|▎         | 2/65 [00:06<02:45,  2.62s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:07<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 12.67122451586601
total_train: 13.493217727465508
time taken to perform 3: 38.31
[16.225665752704327, 14.403362861046425, 13.493217727465508]
Using minimum loss from history: 13.493217727465508
[I 2025-02-18 02:32:55,091] Trial 1 finished with value: 13.493217727465508 and parameters: {'spatial_loss_factor': 3.2240328721605276}. Best is trial 1 with value: 13.493217727465508.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_023058-9dsbvx6z
wandb: Find logs at: ./wandb/offline-run-20250218_023058-9dsbvx6z/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:04,  4.76s/it]  3%|▎         | 2/65 [00:05<02:22,  2.26s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.00it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 7.848762350815993
total_train: 8.974045790158785
time taken to perform 1: 37.68
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.19s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:09,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 7.007883985225971
total_train: 7.928664170778715
time taken to perform 2: 38.18
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:59,  5.62s/it]  3%|▎         | 2/65 [00:06<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 6.5861615767845745
total_train: 7.408154822618533
time taken to perform 3: 38.33
[8.974045790158785, 7.928664170778715, 7.408154822618533]
Using minimum loss from history: 7.408154822618533
[I 2025-02-18 02:34:50,992] Trial 2 finished with value: 7.408154822618533 and parameters: {'spatial_loss_factor': 1.6757607319096208}. Best is trial 2 with value: 7.408154822618533.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_023255-g462nrok
wandb: Find logs at: ./wandb/offline-run-20250218_023255-g462nrok/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:04,  4.75s/it]  3%|▎         | 2/65 [00:05<02:30,  2.39s/it]  5%|▍         | 3/65 [00:06<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:09,  1.13s/it]  8%|▊         | 5/65 [00:07<00:54,  1.10it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:22<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 20.602094679612378
total_train: 21.727377935556266
time taken to perform 1: 37.82
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 18.394860348334678
total_train: 19.315640471531793
time taken to perform 2: 38.23
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:58,  5.60s/it]  3%|▎         | 2/65 [00:06<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.96it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 17.287890805953587
total_train: 18.109883993099896
time taken to perform 3: 38.45
[21.727377935556266, 19.315640471531793, 18.109883993099896]
Using minimum loss from history: 18.109883993099896
[I 2025-02-18 02:36:47,213] Trial 3 finished with value: 18.109883993099896 and parameters: {'spatial_loss_factor': 4.398689029792946}. Best is trial 2 with value: 7.408154822618533.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_023451-921db6ol
wandb: Find logs at: ./wandb/offline-run-20250218_023451-921db6ol/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:22,  5.04s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:24,  2.00it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.01it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.02it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.03it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.86it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.91it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.95it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.98it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.04it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.86it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.95it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.04it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.91it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.95it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 15.627760446988619
total_train: 16.75304384965163
time taken to perform 1: 37.80
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:35,  5.25s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 13.953458940065824
total_train: 14.874239063262939
time taken to perform 2: 38.17
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:44,  5.39s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.83it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.02it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.03it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 13.113764112423627
total_train: 13.935757304460575
time taken to perform 3: 37.90
[16.75304384965163, 14.874239063262939, 13.935757304460575]
Using minimum loss from history: 13.935757304460575
[I 2025-02-18 02:38:42,837] Trial 4 finished with value: 13.935757304460575 and parameters: {'spatial_loss_factor': 3.3366319904371933}. Best is trial 2 with value: 7.408154822618533.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_023647-eax5cu18
wandb: Find logs at: ./wandb/offline-run-20250218_023647-eax5cu18/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.82s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.92it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 7.554125353006216
total_train: 8.679408821692833
time taken to perform 1: 38.12
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:19,  5.00s/it]  3%|▎         | 2/65 [00:05<02:40,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.94it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.01it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.02it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.03it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.85it/s] 40%|████      | 26/65 [00:18<00:20,  1.90it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.94it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.02it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 6.744813335858859
total_train: 7.665593528747559
time taken to perform 2: 38.05
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:37,  5.28s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.02it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.00it/s] 40%|████      | 26/65 [00:18<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.02it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.03it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.03it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 6.338922412578876
total_train: 7.160915663303473
time taken to perform 3: 37.88
[8.679408821692833, 7.665593528747559, 7.160915663303473]
Using minimum loss from history: 7.160915663303473
[I 2025-02-18 02:40:38,616] Trial 5 finished with value: 7.160915663303473 and parameters: {'spatial_loss_factor': 1.6128537855405174}. Best is trial 5 with value: 7.160915663303473.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_023843-9q8vgako
wandb: Find logs at: ./wandb/offline-run-20250218_023843-9q8vgako/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:19,  4.99s/it]  3%|▎         | 2/65 [00:05<02:41,  2.57s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:03,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.95it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 20.996510696411132
total_train: 22.121793981698843
time taken to perform 1: 38.22
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:04,  5.70s/it]  3%|▎         | 2/65 [00:06<02:46,  2.65s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:11<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.94it/s] 22%|██▏       | 14/65 [00:12<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.92it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.95it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.01it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.02it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.03it/s] 38%|███▊      | 25/65 [00:18<00:21,  1.85it/s] 40%|████      | 26/65 [00:18<00:20,  1.90it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.94it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.00it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.01it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.02it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.85it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.90it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.94it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.97it/s] 60%|██████    | 39/65 [00:25<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:26<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.03it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.04it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.85it/s] 71%|███████   | 46/65 [00:28<00:09,  1.90it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.94it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.97it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.99it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.00it/s] 78%|███████▊  | 51/65 [00:31<00:06,  2.02it/s] 80%|████████  | 52/65 [00:31<00:06,  2.02it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.03it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.03it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.85it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.90it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.94it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.97it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.01it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.02it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.03it/s]100%|██████████| 65/65 [00:38<00:00,  1.85it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 18.74701858667227
total_train: 19.667798731877255
time taken to perform 2: 38.30
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:43,  5.36s/it]  3%|▎         | 2/65 [00:05<02:37,  2.51s/it]  5%|▍         | 3/65 [00:06<01:38,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 17.618856674585587
total_train: 18.440849900856996
time taken to perform 3: 38.05
[22.121793981698843, 19.667798731877255, 18.440849900856996]
Using minimum loss from history: 18.440849900856996
[I 2025-02-18 02:42:35,080] Trial 6 finished with value: 18.440849900856996 and parameters: {'spatial_loss_factor': 4.482898815835419}. Best is trial 5 with value: 7.160915663303473.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_024038-2pog67de
wandb: Find logs at: ./wandb/offline-run-20250218_024038-2pog67de/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:13,  4.91s/it]  3%|▎         | 2/65 [00:05<02:27,  2.34s/it]  5%|▍         | 3/65 [00:05<01:34,  1.52s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:54,  1.11it/s]  9%|▉         | 6/65 [00:07<00:45,  1.30it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:17<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:22<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 14.366797007047213
total_train: 15.492080395038311
time taken to perform 1: 37.78
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:24,  5.06s/it]  3%|▎         | 2/65 [00:05<02:30,  2.39s/it]  5%|▍         | 3/65 [00:06<01:35,  1.53s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 12.827591096437894
total_train: 13.748371234306923
time taken to perform 2: 38.05
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.35s/it]  3%|▎         | 2/65 [00:05<02:38,  2.51s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:28,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.80it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.89it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.92it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.94it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.96it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:21<00:16,  1.93it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.95it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.98it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.99it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.99it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.99it/s] 91%|█████████ | 59/65 [00:35<00:03,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.90it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.93it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.95it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 12.055648999336439
total_train: 12.877642206045298
time taken to perform 3: 38.41
[15.492080395038311, 13.748371234306923, 12.877642206045298]
Using minimum loss from history: 12.877642206045298
[I 2025-02-18 02:44:31,042] Trial 7 finished with value: 12.877642206045298 and parameters: {'spatial_loss_factor': 3.0674066588869042}. Best is trial 5 with value: 7.160915663303473.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_024235-qt88zguj
wandb: Find logs at: ./wandb/offline-run-20250218_024235-qt88zguj/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:10,  4.86s/it]  3%|▎         | 2/65 [00:05<02:42,  2.57s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 7.662019164745624
total_train: 8.787302640768198
time taken to perform 1: 38.13
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:46,  4.48s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.38it/s] 12%|█▏        | 8/65 [00:08<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 6.841146527803861
total_train: 7.761926717024583
time taken to perform 2: 38.05
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:34,  5.23s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:45,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 6.429457862560565
total_train: 7.251451110839843
time taken to perform 3: 38.07
[8.787302640768198, 7.761926717024583, 7.251451110839843]
Using minimum loss from history: 7.251451110839843
[I 2025-02-18 02:46:27,130] Trial 8 finished with value: 7.251451110839843 and parameters: {'spatial_loss_factor': 1.6358890738017982}. Best is trial 5 with value: 7.160915663303473.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_024431-hb3u7bbp
wandb: Find logs at: ./wandb/offline-run-20250218_024431-hb3u7bbp/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:00,  4.70s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:14<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 21.99079680809608
total_train: 23.11608009338379
time taken to perform 1: 37.94
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:11,  4.86s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:07<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.38it/s] 12%|█▏        | 8/65 [00:08<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.65it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.75it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.91it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.82it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.96it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 19.634786239037147
total_train: 20.55556634756235
time taken to perform 2: 38.23
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:43,  5.36s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 18.453203044793543
total_train: 19.275196222158577
time taken to perform 3: 38.16
[23.11608009338379, 20.55556634756235, 19.275196222158577]
Using minimum loss from history: 19.275196222158577
[I 2025-02-18 02:48:23,344] Trial 9 finished with value: 19.275196222158577 and parameters: {'spatial_loss_factor': 4.695188813356453}. Best is trial 5 with value: 7.160915663303473.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_024627-apenu34t
wandb: Find logs at: ./wandb/offline-run-20250218_024627-apenu34t/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.92s/it]  3%|▎         | 2/65 [00:05<02:27,  2.34s/it]  5%|▍         | 3/65 [00:06<01:36,  1.55s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:54,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:14<00:24,  1.80it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.95it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.96it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.97it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.99it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:08,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.86it/s] 80%|████████  | 52/65 [00:31<00:06,  1.89it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.93it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 4.888468529627874
total_train: 6.01375193962684
time taken to perform 1: 38.00
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.01it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 4.364744690748362
total_train: 5.285524841455313
time taken to perform 2: 38.13
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:56,  5.56s/it]  3%|▎         | 2/65 [00:06<02:43,  2.59s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 4.102080689943754
total_train: 4.924073916215163
time taken to perform 3: 38.26
[6.01375193962684, 5.285524841455313, 4.924073916215163]
Using minimum loss from history: 4.924073916215163
[I 2025-02-18 02:50:19,549] Trial 10 finished with value: 4.924073916215163 and parameters: {'spatial_loss_factor': 1.0437153926116352}. Best is trial 10 with value: 4.924073916215163.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_024823-y3mfwb5a
wandb: Find logs at: ./wandb/offline-run-20250218_024823-y3mfwb5a/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.92s/it]  3%|▎         | 2/65 [00:05<02:26,  2.33s/it]  5%|▍         | 3/65 [00:05<01:33,  1.50s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:06<00:53,  1.11it/s]  9%|▉         | 6/65 [00:07<00:45,  1.30it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:24,  2.00it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.01it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.02it/s] 31%|███       | 20/65 [00:14<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:19<00:18,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  2.00it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  2.00it/s] 71%|███████   | 46/65 [00:27<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:32<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:33<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 5.162785104604867
total_train: 6.288068565955529
time taken to perform 1: 37.61
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.97s/it]  3%|▎         | 2/65 [00:05<02:27,  2.35s/it]  5%|▍         | 3/65 [00:05<01:33,  1.51s/it]  6%|▌         | 4/65 [00:06<01:07,  1.11s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:17<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.81it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.97it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.98it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.99it/s] 66%|██████▌   | 43/65 [00:26<00:11,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:11,  1.82it/s] 71%|███████   | 46/65 [00:28<00:10,  1.87it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.91it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.96it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.97it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.98it/s] 80%|████████  | 52/65 [00:31<00:06,  1.98it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.99it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.81it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.86it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.90it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.93it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.97it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.99it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 4.609673081911527
total_train: 5.530453271132249
time taken to perform 2: 38.06
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:33,  5.21s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:37,  1.56s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:21<00:16,  1.93it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.95it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.96it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.99it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.98it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.99it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.99it/s] 75%|███████▌  | 49/65 [00:29<00:08,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.86it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.98it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.98it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.98it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.86it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 4.332270079392654
total_train: 5.1542633105547
time taken to perform 3: 38.25
[6.288068565955529, 5.530453271132249, 5.1542633105547]
Using minimum loss from history: 5.1542633105547
[I 2025-02-18 02:52:15,170] Trial 11 finished with value: 5.1542633105547 and parameters: {'spatial_loss_factor': 1.1022845655639295}. Best is trial 10 with value: 4.924073916215163.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_025019-cn78hshf
wandb: Find logs at: ./wandb/offline-run-20250218_025019-cn78hshf/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:28,  5.13s/it]  3%|▎         | 2/65 [00:05<02:43,  2.59s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:56,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 5.012131434220534
total_train: 6.137414858891414
time taken to perform 1: 38.22
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:16,  4.94s/it]  3%|▎         | 2/65 [00:05<02:36,  2.48s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.95it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.97it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  1.99it/s] 82%|████████▏ | 53/65 [00:31<00:06,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 4.47516016960144
total_train: 5.395940347818228
time taken to perform 2: 38.18
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.20s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.99it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.97it/s] 71%|███████   | 46/65 [00:28<00:09,  1.98it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.99it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:08,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.86it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.99it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 4.205852046379676
total_train: 5.027845284877679
time taken to perform 3: 38.13
[6.137414858891414, 5.395940347818228, 5.027845284877679]
Using minimum loss from history: 5.027845284877679
[I 2025-02-18 02:54:11,552] Trial 12 finished with value: 5.027845284877679 and parameters: {'spatial_loss_factor': 1.0701188077108654}. Best is trial 10 with value: 4.924073916215163.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_025215-ec7ey8z7
wandb: Find logs at: ./wandb/offline-run-20250218_025215-ec7ey8z7/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.93s/it]  3%|▎         | 2/65 [00:05<02:38,  2.51s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 10.552889427771936
total_train: 11.678172830434946
time taken to perform 1: 38.16
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:24,  4.13s/it]  3%|▎         | 2/65 [00:04<02:17,  2.18s/it]  5%|▍         | 3/65 [00:05<01:27,  1.42s/it]  6%|▌         | 4/65 [00:05<01:04,  1.06s/it]  8%|▊         | 5/65 [00:06<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:07<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:08<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.77it/s] 17%|█▋        | 11/65 [00:09<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:10<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:11<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:12<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:13<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:14<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:15<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:16<00:22,  1.81it/s] 40%|████      | 26/65 [00:17<00:20,  1.86it/s] 42%|████▏     | 27/65 [00:17<00:19,  1.90it/s] 43%|████▎     | 28/65 [00:18<00:19,  1.93it/s] 45%|████▍     | 29/65 [00:18<00:18,  1.95it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.97it/s] 48%|████▊     | 31/65 [00:19<00:17,  1.97it/s] 49%|████▉     | 32/65 [00:20<00:16,  1.98it/s] 51%|█████     | 33/65 [00:20<00:16,  1.99it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.97it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.99it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.82it/s] 71%|███████   | 46/65 [00:27<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:28<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:29<00:07,  2.00it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.01it/s] 80%|████████  | 52/65 [00:30<00:06,  2.02it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.03it/s] 83%|████████▎ | 54/65 [00:31<00:05,  2.03it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.85it/s] 86%|████████▌ | 56/65 [00:32<00:04,  1.90it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.94it/s] 89%|████████▉ | 58/65 [00:33<00:03,  1.97it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:34<00:02,  2.00it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.02it/s] 95%|█████████▌| 62/65 [00:35<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:36<00:00,  2.03it/s]100%|██████████| 65/65 [00:37<00:00,  1.85it/s]100%|██████████| 65/65 [00:37<00:00,  1.74it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 9.422294913805448
total_train: 10.343075055342455
time taken to perform 2: 37.40
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:03,  4.75s/it]  3%|▎         | 2/65 [00:05<02:22,  2.26s/it]  5%|▍         | 3/65 [00:05<01:30,  1.46s/it]  6%|▌         | 4/65 [00:06<01:06,  1.08s/it]  8%|▊         | 5/65 [00:06<00:52,  1.14it/s]  9%|▉         | 6/65 [00:07<00:44,  1.33it/s] 11%|█         | 7/65 [00:07<00:38,  1.49it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.63it/s] 14%|█▍        | 9/65 [00:08<00:32,  1.73it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.66it/s] 17%|█▋        | 11/65 [00:09<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.83it/s] 20%|██        | 13/65 [00:10<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:11<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:12<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:13<00:23,  1.99it/s] 31%|███       | 20/65 [00:14<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.96it/s] 40%|████      | 26/65 [00:17<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.90it/s] 51%|█████     | 33/65 [00:21<00:16,  1.93it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:22<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.98it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.99it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:27<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 8.855277315775554
total_train: 9.677270546937601
time taken to perform 3: 37.67
[11.678172830434946, 10.343075055342455, 9.677270546937601]
Using minimum loss from history: 9.677270546937601
[I 2025-02-18 02:56:06,649] Trial 13 finished with value: 9.677270546937601 and parameters: {'spatial_loss_factor': 2.2531100492738476}. Best is trial 10 with value: 4.924073916215163.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_025411-vscuindu
wandb: Find logs at: ./wandb/offline-run-20250218_025411-vscuindu/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:01,  4.71s/it]  3%|▎         | 2/65 [00:06<02:51,  2.71s/it]  5%|▍         | 3/65 [00:06<01:45,  1.71s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.58it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.69it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 4.6857178321251505
total_train: 5.811001264131987
time taken to perform 1: 38.35
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:33,  5.21s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 4.18371692437392
total_train: 5.104497109926664
time taken to perform 2: 38.17
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.35s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:38,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.99it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 3.9319470368898832
total_train: 4.7539402863918205
time taken to perform 3: 38.14
[5.811001264131987, 5.104497109926664, 4.7539402863918205]
Using minimum loss from history: 4.7539402863918205
[I 2025-02-18 02:58:03,101] Trial 14 finished with value: 4.7539402863918205 and parameters: {'spatial_loss_factor': 1.0004271320638505}. Best is trial 14 with value: 4.7539402863918205.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_025606-qszikpsy
wandb: Find logs at: ./wandb/offline-run-20250218_025606-qszikpsy/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:01,  4.71s/it]  3%|▎         | 2/65 [00:05<02:28,  2.36s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.57it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.69it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.77it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:11<00:27,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.92it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:14<00:24,  1.84it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  2.00it/s] 40%|████      | 26/65 [00:17<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 9.920259857177735
total_train: 11.045543303856483
time taken to perform 1: 37.78
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:54,  4.60s/it]  3%|▎         | 2/65 [00:05<02:39,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:07<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:42,  1.38it/s] 12%|█▏        | 8/65 [00:08<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.75it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.90it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.85it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 8.857446718215943
total_train: 9.778226903768687
time taken to perform 2: 38.05
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.36s/it]  3%|▎         | 2/65 [00:05<02:37,  2.51s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 8.324421273745024
total_train: 9.146414517133664
time taken to perform 3: 38.01
[11.045543303856483, 9.778226903768687, 9.146414517133664]
Using minimum loss from history: 9.146414517133664
[I 2025-02-18 02:59:58,695] Trial 15 finished with value: 9.146414517133664 and parameters: {'spatial_loss_factor': 2.1180404093617193}. Best is trial 14 with value: 4.7539402863918205.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_025803-vbfm0xfl
wandb: Find logs at: ./wandb/offline-run-20250218_025803-vbfm0xfl/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:44,  5.38s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.58it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 11.281259434039777
total_train: 12.406542880718524
time taken to perform 1: 38.13
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:56,  5.57s/it]  3%|▎         | 2/65 [00:06<02:43,  2.60s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<01:00,  1.02s/it]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.65it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.75it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.78it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  1.99it/s] 35%|███▌      | 23/65 [00:16<00:21,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:18<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:20<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:22<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:25<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:26<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 10.072630053300124
total_train: 10.993410205841064
time taken to perform 2: 38.56
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:56,  5.58s/it]  3%|▎         | 2/65 [00:06<02:43,  2.60s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:28<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 9.4664765724769
total_train: 10.288469793857672
time taken to perform 3: 38.26
[12.406542880718524, 10.993410205841064, 10.288469793857672]
Using minimum loss from history: 10.288469793857672
[I 2025-02-18 03:01:55,398] Trial 16 finished with value: 10.288469793857672 and parameters: {'spatial_loss_factor': 2.408622467912661}. Best is trial 14 with value: 4.7539402863918205.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_025958-upa84uz4
wandb: Find logs at: ./wandb/offline-run-20250218_025958-upa84uz4/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:05,  5.71s/it]  3%|▎         | 2/65 [00:06<02:47,  2.65s/it]  5%|▍         | 3/65 [00:06<01:43,  1.68s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:23<00:15,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:25<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:28<00:09,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 17.71918932107779
total_train: 18.844472650381235
time taken to perform 1: 38.38
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:20,  5.01s/it]  3%|▎         | 2/65 [00:05<02:28,  2.36s/it]  5%|▍         | 3/65 [00:06<01:34,  1.52s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:17<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.83it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 15.820823009197529
total_train: 16.741603110386777
time taken to perform 2: 37.98
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:44,  5.39s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.84it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 14.868754611871182
total_train: 15.690747784345579
time taken to perform 3: 38.06
[18.844472650381235, 16.741603110386777, 15.690747784345579]
Using minimum loss from history: 15.690747784345579
[I 2025-02-18 03:03:51,610] Trial 17 finished with value: 15.690747784345579 and parameters: {'spatial_loss_factor': 3.783168333737786}. Best is trial 14 with value: 4.7539402863918205.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_030155-q5esvpce
wandb: Find logs at: ./wandb/offline-run-20250218_030155-q5esvpce/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:01,  4.71s/it]  3%|▎         | 2/65 [00:06<02:50,  2.70s/it]  5%|▍         | 3/65 [00:06<01:45,  1.71s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  2.00it/s] 40%|████      | 26/65 [00:18<00:20,  1.93it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.95it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:28<00:09,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.95it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 12.551818246107835
total_train: 13.677101604755109
time taken to perform 1: 38.13
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.82s/it]  3%|▎         | 2/65 [00:05<02:24,  2.29s/it]  5%|▍         | 3/65 [00:05<01:31,  1.48s/it]  6%|▌         | 4/65 [00:06<01:06,  1.10s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:17<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.83it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 11.207063623575063
total_train: 12.127843746772179
time taken to perform 2: 37.78
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:54,  4.60s/it]  3%|▎         | 2/65 [00:05<02:18,  2.20s/it]  5%|▍         | 3/65 [00:05<01:28,  1.43s/it]  6%|▌         | 4/65 [00:06<01:05,  1.07s/it]  8%|▊         | 5/65 [00:06<00:51,  1.16it/s]  9%|▉         | 6/65 [00:07<00:43,  1.35it/s] 11%|█         | 7/65 [00:07<00:38,  1.51it/s] 12%|█▏        | 8/65 [00:08<00:34,  1.64it/s] 14%|█▍        | 9/65 [00:08<00:32,  1.74it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.66it/s] 17%|█▋        | 11/65 [00:09<00:30,  1.76it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.83it/s] 20%|██        | 13/65 [00:10<00:27,  1.89it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:11<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:12<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:13<00:23,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:14<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:15<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:16<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:17<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:18<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:22<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:27<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:29<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:30<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:31<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:32<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:33<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:34<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:35<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:36<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.74it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 10.532642506330442
total_train: 11.354635703258026
time taken to perform 3: 37.40
[13.677101604755109, 12.127843746772179, 11.354635703258026]
Using minimum loss from history: 11.354635703258026
[I 2025-02-18 03:05:46,960] Trial 18 finished with value: 11.354635703258026 and parameters: {'spatial_loss_factor': 2.6798962642312247}. Best is trial 14 with value: 4.7539402863918205.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_030352-gpwzh3i8
wandb: Find logs at: ./wandb/offline-run-20250218_030352-gpwzh3i8/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:08<00:42,  1.36it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.51it/s] 14%|█▍        | 9/65 [00:09<00:34,  1.64it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.58it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.69it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.1252834402597867
spatial_difference_train: 6.341708638117864
total_train: 7.466992077460656
time taken to perform 1: 38.43
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:54,  5.54s/it]  3%|▎         | 2/65 [00:06<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:18<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:25<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:26<00:11,  2.01it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.82it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9207801736318149
spatial_difference_train: 5.662291086637056
total_train: 6.583071257517888
time taken to perform 2: 38.46
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:06,  5.73s/it]  3%|▎         | 2/65 [00:06<02:47,  2.66s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.98it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:03,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 3/3_____

mask_train: 0.8219932351356898
spatial_difference_train: 5.321543989426051
total_train: 6.143537225478735
time taken to perform 3: 38.47
[7.466992077460656, 6.583071257517888, 6.143537225478735]
Using minimum loss from history: 6.143537225478735
[I 2025-02-18 03:07:44,080] Trial 19 finished with value: 6.143537225478735 and parameters: {'spatial_loss_factor': 1.3539937590322872}. Best is trial 14 with value: 4.7539402863918205.
Best trial:
  Value:  4.7539402863918205
  Params: 
    spatial_loss_factor: 1.0004271320638505
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_030547-hlml3c20[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250218_030547-hlml3c20/logs[0m
