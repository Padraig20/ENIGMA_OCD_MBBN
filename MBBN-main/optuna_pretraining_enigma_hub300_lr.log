[I 2025-02-18 00:45:21,790] A new study created in memory with name: no-name-a83f912e-cb31-4166-b255-8f2bf6afedbe
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 95.71 MB
max cached memory: 116.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:09<10:18,  9.66s/it]  3%|▎         | 2/65 [00:11<05:00,  4.77s/it]  5%|▍         | 3/65 [00:12<03:17,  3.19s/it]  6%|▌         | 4/65 [00:13<02:19,  2.29s/it]  8%|▊         | 5/65 [00:13<01:38,  1.64s/it]finished warmup
  9%|▉         | 6/65 [00:14<01:14,  1.26s/it] 11%|█         | 7/65 [00:14<00:58,  1.01s/it] 12%|█▏        | 8/65 [00:15<00:48,  1.18it/s] 14%|█▍        | 9/65 [00:15<00:41,  1.36it/s] 15%|█▌        | 10/65 [00:16<00:41,  1.34it/s] 17%|█▋        | 11/65 [00:16<00:36,  1.49it/s] 18%|█▊        | 12/65 [00:17<00:32,  1.62it/s] 20%|██        | 13/65 [00:17<00:30,  1.72it/s] 22%|██▏       | 14/65 [00:18<00:28,  1.80it/s] 23%|██▎       | 15/65 [00:18<00:26,  1.86it/s] 25%|██▍       | 16/65 [00:19<00:25,  1.91it/s] 26%|██▌       | 17/65 [00:19<00:24,  1.94it/s] 28%|██▊       | 18/65 [00:20<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:20<00:23,  1.98it/s] 31%|███       | 20/65 [00:21<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:22<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:22<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:23<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:23<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:24<00:20,  1.98it/s] 40%|████      | 26/65 [00:24<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:25<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:25<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:26<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:26<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:27<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:27<00:17,  1.91it/s] 51%|█████     | 33/65 [00:28<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:28<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:29<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:29<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:30<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:30<00:13,  2.01it/s] 60%|██████    | 39/65 [00:31<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:31<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:32<00:12,  1.85it/s] 65%|██████▍   | 42/65 [00:32<00:12,  1.90it/s] 66%|██████▌   | 43/65 [00:33<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:33<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:34<00:10,  1.98it/s] 71%|███████   | 46/65 [00:34<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:35<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:35<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:36<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:37<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:37<00:07,  1.87it/s] 80%|████████  | 52/65 [00:38<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:38<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:39<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:39<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:40<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:40<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:41<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:41<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:42<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:42<00:02,  1.86it/s] 95%|█████████▌| 62/65 [00:43<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:43<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:44<00:00,  1.96it/s]100%|██████████| 65/65 [00:44<00:00,  1.98it/s]100%|██████████| 65/65 [00:44<00:00,  1.46it/s]

______epoch summary 1/3_____

mask_train: 1.4111701314265912
spatial_difference_train: 21.929937069232647
total_train: 23.34110726576585
time taken to perform 1: 44.68
Starting epoch 2/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:23,  5.05s/it]  3%|▎         | 2/65 [00:05<02:33,  2.43s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.78it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.82it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.1504851547571329
spatial_difference_train: 20.857715621361365
total_train: 22.008200865525467
time taken to perform 2: 38.16
Starting epoch 3/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.84s/it]  3%|▎         | 2/65 [00:05<02:24,  2.29s/it]  5%|▍         | 3/65 [00:05<01:31,  1.48s/it]  6%|▌         | 4/65 [00:06<01:07,  1.10s/it]  8%|▊         | 5/65 [00:06<00:53,  1.13it/s]  9%|▉         | 6/65 [00:07<00:44,  1.32it/s] 11%|█         | 7/65 [00:07<00:39,  1.48it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.62it/s] 14%|█▍        | 9/65 [00:08<00:32,  1.73it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:14<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:22<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.79it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.85it/s] 65%|██████▍   | 42/65 [00:25<00:12,  1.90it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.93it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:27<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.86it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.86it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.90it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 1.0415108836614169
spatial_difference_train: 20.261437049278847
total_train: 21.302947958921774
time taken to perform 3: 37.74
[23.34110726576585, 22.008200865525467, 21.302947958921774]
Using minimum loss from history: 21.302947958921774
[I 2025-02-18 00:47:26,453] Trial 0 finished with value: 21.302947958921774 and parameters: {'lr_init_phase2': 0.0001386656964278837, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.001606815440577772, 'lr_gamma_phase2': 0.9388934934329057, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1900}. Best is trial 0 with value: 21.302947958921774.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_004524-z8a2kag6
wandb: Find logs at: ./wandb/offline-run-20250218_004524-z8a2kag6/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29053.17 MB
max cached memory: 30038.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.92s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.3990700217393728
spatial_difference_train: 22.18956486628606
total_train: 23.588634989811823
time taken to perform 1: 38.01
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:39,  5.31s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.78it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.00it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.02it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.90it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.94it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.97it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.99it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.01it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.02it/s] 80%|████████  | 52/65 [00:31<00:06,  2.03it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.03it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.04it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.90it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.94it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.97it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.01it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.02it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.04it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.1070360224980575
spatial_difference_train: 20.558123163076548
total_train: 21.66515918144813
time taken to perform 2: 38.16
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:09,  5.77s/it]  3%|▎         | 2/65 [00:06<02:48,  2.68s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 3/3_____

mask_train: 0.971228899099888
spatial_difference_train: 19.46152609800681
total_train: 20.43275503500914
time taken to perform 3: 38.50
[23.588634989811823, 21.66515918144813, 20.43275503500914]
Using minimum loss from history: 20.43275503500914
[I 2025-02-18 00:49:22,868] Trial 1 finished with value: 20.43275503500914 and parameters: {'lr_init_phase2': 7.647118430348126e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.007527324257456687, 'lr_gamma_phase2': 0.9590685407428978, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 900}. Best is trial 1 with value: 20.43275503500914.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_004726-kqqxea9o
wandb: Find logs at: ./wandb/offline-run-20250218_004726-kqqxea9o/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.92s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:40,  1.63s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1464778799277084
spatial_difference_train: 19.42897588289701
total_train: 20.575453831599308
time taken to perform 1: 38.14
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:53,  5.52s/it]  3%|▎         | 2/65 [00:06<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:42,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.75it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.78it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:18<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:25<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:26<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9413275379400987
spatial_difference_train: 17.409720178750845
total_train: 18.351047743283786
time taken to perform 2: 38.50
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:43,  5.36s/it]  3%|▎         | 2/65 [00:05<02:38,  2.51s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8390515101261627
spatial_difference_train: 16.29080264751728
total_train: 17.12985417781732
time taken to perform 3: 38.15
[20.575453831599308, 18.351047743283786, 17.12985417781732]
Using minimum loss from history: 17.12985417781732
[I 2025-02-18 00:51:19,377] Trial 2 finished with value: 17.12985417781732 and parameters: {'lr_init_phase2': 0.00023557479882798014, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0022775358575319615, 'lr_gamma_phase2': 0.9484190158729512, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 1200}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_004923-h3nbe8y3
wandb: Find logs at: ./wandb/offline-run-20250218_004923-h3nbe8y3/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:58,  4.66s/it]  3%|▎         | 2/65 [00:05<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.2109997226641729
spatial_difference_train: 20.588320541381837
total_train: 21.799320220947266
time taken to perform 1: 38.07
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:37,  4.33s/it]  3%|▎         | 2/65 [00:04<02:14,  2.13s/it]  5%|▍         | 3/65 [00:05<01:28,  1.43s/it]  6%|▌         | 4/65 [00:06<01:05,  1.07s/it]  8%|▊         | 5/65 [00:06<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:07<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:08<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:09<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:10<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:11<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:12<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:13<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:14<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:15<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:17<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:18<00:19,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.00it/s] 51%|█████     | 33/65 [00:20<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:27<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:28<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:29<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:30<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:31<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:32<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:33<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:34<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:35<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:36<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.83it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 2/3_____

mask_train: 0.9841008025866288
spatial_difference_train: 18.646624733851507
total_train: 19.63072549379789
time taken to perform 2: 37.50
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.19s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:09,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.85it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.89it/s] 51%|█████     | 33/65 [00:21<00:16,  1.91it/s] 52%|█████▏    | 34/65 [00:22<00:16,  1.92it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.95it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.97it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8735555813862728
spatial_difference_train: 17.455243633954954
total_train: 18.32879918905405
time taken to perform 3: 38.10
[21.799320220947266, 19.63072549379789, 18.32879918905405]
Using minimum loss from history: 18.32879918905405
[I 2025-02-18 00:53:14,743] Trial 3 finished with value: 18.32879918905405 and parameters: {'lr_init_phase2': 0.00015395396159871276, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.007883968133255276, 'lr_gamma_phase2': 0.9730879658093793, 'lr_step_phase2': 4000, 'lr_warmup_phase2': 100}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_005119-phdejfxe
wandb: Find logs at: ./wandb/offline-run-20250218_005119-phdejfxe/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:02,  4.73s/it]  3%|▎         | 2/65 [00:05<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.95it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.89it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.92it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.96it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.298453527230483
spatial_difference_train: 20.914856661283054
total_train: 22.213310212355395
time taken to perform 1: 38.32
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:15,  4.92s/it]  3%|▎         | 2/65 [00:05<02:29,  2.38s/it]  5%|▍         | 3/65 [00:06<01:34,  1.52s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:17<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 1.0631771431519434
spatial_difference_train: 19.652431928194485
total_train: 20.715609139662522
time taken to perform 2: 37.90
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:43,  5.36s/it]  3%|▎         | 2/65 [00:05<02:37,  2.51s/it]  5%|▍         | 3/65 [00:06<01:38,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.86it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.9686555740160819
spatial_difference_train: 18.993471908569337
total_train: 19.962127548609025
time taken to perform 3: 38.19
[22.213310212355395, 20.715609139662522, 19.962127548609025]
Using minimum loss from history: 19.962127548609025
[I 2025-02-18 00:55:10,847] Trial 4 finished with value: 19.962127548609025 and parameters: {'lr_init_phase2': 0.00021375454106707791, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.009599941594416178, 'lr_gamma_phase2': 0.9220381873594055, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 1500}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_005315-i7n7gxlk
wandb: Find logs at: ./wandb/offline-run-20250218_005315-i7n7gxlk/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:05<05:22,  5.05s/it]  3%|▎         | 2/65 [00:05<02:30,  2.38s/it]  5%|▍         | 3/65 [00:06<01:34,  1.53s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:54,  1.10it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:45,  1.30it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.252794909477234
spatial_difference_train: 20.24871242229755
total_train: 21.501507245577297
time taken to perform 1: 37.87
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:12,  4.88s/it]  3%|▎         | 2/65 [00:05<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<01:01,  1.03s/it]  9%|▉         | 6/65 [00:08<00:50,  1.18it/s] 11%|█         | 7/65 [00:08<00:42,  1.36it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.52it/s] 14%|█▍        | 9/65 [00:09<00:34,  1.65it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.74it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.87it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:25<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.029229900928644
spatial_difference_train: 18.915913112346942
total_train: 19.94514298072228
time taken to perform 2: 38.34
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:43,  5.37s/it]  3%|▎         | 2/65 [00:05<02:38,  2.51s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:28,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.9409813630275238
spatial_difference_train: 18.238352800026917
total_train: 19.179334141657904
time taken to perform 3: 38.31
[21.501507245577297, 19.94514298072228, 19.179334141657904]
Using minimum loss from history: 19.179334141657904
[I 2025-02-18 00:57:07,165] Trial 5 finished with value: 19.179334141657904 and parameters: {'lr_init_phase2': 0.00027514977839428867, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.008110030200422166, 'lr_gamma_phase2': 0.9176461761898732, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 500}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_005511-qvr568nj
wandb: Find logs at: ./wandb/offline-run-20250218_005511-qvr568nj/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:03,  4.74s/it]  3%|▎         | 2/65 [00:06<03:01,  2.89s/it]  5%|▍         | 3/65 [00:06<01:51,  1.80s/it]  6%|▌         | 4/65 [00:07<01:18,  1.29s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]finished warmup
  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.52it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.65it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:11<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:12<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:13<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:14<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:25<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.2595112268741315
spatial_difference_train: 20.36313259418194
total_train: 21.62264369084285
time taken to perform 1: 38.54
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.29s/it]  3%|▎         | 2/65 [00:05<02:36,  2.48s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.0341626217732063
spatial_difference_train: 19.040061319791352
total_train: 20.074223811809834
time taken to perform 2: 38.21
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:33,  5.22s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.80it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.86it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.90it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.9449968573374626
spatial_difference_train: 18.36511137546637
total_train: 19.310108165251904
time taken to perform 3: 38.12
[21.62264369084285, 20.074223811809834, 19.310108165251904]
Using minimum loss from history: 19.310108165251904
[I 2025-02-18 00:59:03,784] Trial 6 finished with value: 19.310108165251904 and parameters: {'lr_init_phase2': 0.00026373268156615614, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0023843222592738714, 'lr_gamma_phase2': 0.989677109219534, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 1500}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_005707-8361odgr
wandb: Find logs at: ./wandb/offline-run-20250218_005707-8361odgr/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:02,  4.72s/it]  3%|▎         | 2/65 [00:05<02:38,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.2835339958851153
spatial_difference_train: 20.733634449885443
total_train: 22.017168455857497
time taken to perform 1: 37.97
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:13,  5.84s/it]  3%|▎         | 2/65 [00:06<02:50,  2.70s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:08<01:02,  1.03s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:09<00:42,  1.36it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.51it/s] 14%|█▍        | 9/65 [00:10<00:34,  1.63it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.74it/s] 17%|█▋        | 11/65 [00:11<00:29,  1.81it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.87it/s] 20%|██        | 13/65 [00:12<00:27,  1.91it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:13<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:14<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:15<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:16<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:17<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:18<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:20<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:22<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:25<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:11,  1.82it/s] 71%|███████   | 46/65 [00:29<00:10,  1.87it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.91it/s] 74%|███████▍  | 48/65 [00:30<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:31<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.99it/s] 80%|████████  | 52/65 [00:32<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:33<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:34<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:35<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:37<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.67it/s]

______epoch summary 2/3_____

mask_train: 1.051929048391489
spatial_difference_train: 19.448516713655913
total_train: 20.500445747375487
time taken to perform 2: 38.84
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:35,  5.24s/it]  3%|▎         | 2/65 [00:05<02:34,  2.46s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:45,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  2.00it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.9594684643623156
spatial_difference_train: 18.783497903285884
total_train: 19.742966392712717
time taken to perform 3: 38.00
[22.017168455857497, 20.500445747375487, 19.742966392712717]
Using minimum loss from history: 19.742966392712717
[I 2025-02-18 01:01:00,289] Trial 7 finished with value: 19.742966392712717 and parameters: {'lr_init_phase2': 0.0002293163271270701, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.002946934119522184, 'lr_gamma_phase2': 0.9684669800539949, 'lr_step_phase2': 4500, 'lr_warmup_phase2': 600}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_005904-3dkd3f57
wandb: Find logs at: ./wandb/offline-run-20250218_005904-3dkd3f57/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:02,  4.73s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.00it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.02it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.03it/s] 31%|███       | 20/65 [00:14<00:24,  1.85it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.90it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.94it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.97it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.99it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.01it/s] 40%|████      | 26/65 [00:17<00:19,  2.02it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.03it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.03it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.04it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:20<00:16,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.91it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.91it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 1/3_____

mask_train: 1.7888539424309364
spatial_difference_train: 23.52261613699106
total_train: 25.311470207801232
time taken to perform 1: 37.64
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:06,  4.79s/it]  3%|▎         | 2/65 [00:05<02:28,  2.35s/it]  5%|▍         | 3/65 [00:05<01:33,  1.51s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.78it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.84it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.92it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:14<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.98it/s] 34%|███▍      | 22/65 [00:15<00:21,  1.99it/s] 35%|███▌      | 23/65 [00:16<00:21,  2.00it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:22,  1.81it/s] 40%|████      | 26/65 [00:17<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:18<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.97it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.98it/s] 49%|████▉     | 32/65 [00:20<00:16,  1.99it/s] 51%|█████     | 33/65 [00:21<00:16,  2.00it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.81it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.99it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 1.4868831827090336
spatial_difference_train: 23.004892173180213
total_train: 24.4917753806481
time taken to perform 2: 38.02
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:32,  5.20s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 1.3416224546921558
spatial_difference_train: 22.683273618649213
total_train: 24.02489609351525
time taken to perform 3: 37.94
[25.311470207801232, 24.4917753806481, 24.02489609351525]
Using minimum loss from history: 24.02489609351525
[I 2025-02-18 01:02:55,672] Trial 8 finished with value: 24.02489609351525 and parameters: {'lr_init_phase2': 4.910002507997239e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0006249407308559175, 'lr_gamma_phase2': 0.9352400993654161, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 1900}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_010100-zsvh66bq
wandb: Find logs at: ./wandb/offline-run-20250218_010100-zsvh66bq/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:02,  4.72s/it]  3%|▎         | 2/65 [00:05<02:40,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:11<00:27,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.768510180253249
spatial_difference_train: 23.478160564716045
total_train: 25.246670884352465
time taken to perform 1: 38.18
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:59,  4.67s/it]  3%|▎         | 2/65 [00:05<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.4683173986581655
spatial_difference_train: 22.939872022775504
total_train: 24.40818955348088
time taken to perform 2: 38.14
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.25s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.00it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.01it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.02it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 1.323859772621057
spatial_difference_train: 22.606781954643054
total_train: 23.93064181988056
time taken to perform 3: 37.95
[25.246670884352465, 24.40818955348088, 23.93064181988056]
Using minimum loss from history: 23.93064181988056
[I 2025-02-18 01:04:51,663] Trial 9 finished with value: 23.93064181988056 and parameters: {'lr_init_phase2': 5.131891659529782e-05, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.003752547767594025, 'lr_gamma_phase2': 0.9360487030221998, 'lr_step_phase2': 4000, 'lr_warmup_phase2': 1000}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_010255-xslh5ezl
wandb: Find logs at: ./wandb/offline-run-20250218_010255-xslh5ezl/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:13,  4.90s/it]  3%|▎         | 2/65 [00:05<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1615667086381178
spatial_difference_train: 19.76950607299805
total_train: 20.931072733952448
time taken to perform 1: 38.30
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:15<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:21,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9513911664485931
spatial_difference_train: 17.7629766024076
total_train: 18.714367705125074
time taken to perform 2: 38.22
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:03,  5.68s/it]  3%|▎         | 2/65 [00:06<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.98it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.93it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.95it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.68it/s]

______epoch summary 3/3_____

mask_train: 0.848761848302988
spatial_difference_train: 16.60522384154491
total_train: 17.453985649500137
time taken to perform 3: 38.59
[20.931072733952448, 18.714367705125074, 17.453985649500137]
Using minimum loss from history: 17.453985649500137
[I 2025-02-18 01:06:48,515] Trial 10 finished with value: 17.453985649500137 and parameters: {'lr_init_phase2': 0.00020865451680888463, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.005114264131498259, 'lr_gamma_phase2': 0.9041113838039005, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 1300}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_010451-gs4gu7c0
wandb: Find logs at: ./wandb/offline-run-20250218_010451-gs4gu7c0/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:10,  4.86s/it]  3%|▎         | 2/65 [00:05<02:37,  2.51s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.168867680659661
spatial_difference_train: 19.912623684222883
total_train: 21.08149132361779
time taken to perform 1: 38.03
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.91s/it]  3%|▎         | 2/65 [00:05<02:28,  2.36s/it]  5%|▍         | 3/65 [00:06<01:34,  1.52s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.95it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:14<00:22,  1.99it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.00it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:17<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.956361671594473
spatial_difference_train: 17.91421862382155
total_train: 18.870580269740177
time taken to perform 2: 37.81
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:18,  4.98s/it]  3%|▎         | 2/65 [00:05<02:28,  2.35s/it]  5%|▍         | 3/65 [00:06<01:33,  1.51s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:53,  1.11it/s]  9%|▉         | 6/65 [00:07<00:45,  1.30it/s] 11%|█         | 7/65 [00:08<00:39,  1.47it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.61it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8553989300361047
spatial_difference_train: 16.74430673550337
total_train: 17.59970564719958
time taken to perform 3: 37.75
[21.08149132361779, 18.870580269740177, 17.59970564719958]
Using minimum loss from history: 17.59970564719958
[I 2025-02-18 01:08:43,861] Trial 11 finished with value: 17.59970564719958 and parameters: {'lr_init_phase2': 0.0001981334118436878, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0056249867815736775, 'lr_gamma_phase2': 0.9000558087388719, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 1300}. Best is trial 2 with value: 17.12985417781732.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_010648-adv64rxl
wandb: Find logs at: ./wandb/offline-run-20250218_010648-adv64rxl/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.83s/it]  3%|▎         | 2/65 [00:05<02:47,  2.67s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1257178636697622
spatial_difference_train: 18.74945052220271
total_train: 19.87516860961914
time taken to perform 1: 38.23
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:55,  4.62s/it]  3%|▎         | 2/65 [00:05<02:19,  2.21s/it]  5%|▍         | 3/65 [00:05<01:29,  1.44s/it]  6%|▌         | 4/65 [00:06<01:05,  1.07s/it]  8%|▊         | 5/65 [00:06<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:07<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:08<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:09<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:10<00:27,  1.91it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.78it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.84it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.88it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.92it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.94it/s] 31%|███       | 20/65 [00:14<00:22,  1.96it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.97it/s] 34%|███▍      | 22/65 [00:15<00:21,  1.98it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.99it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:17<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.90it/s] 43%|████▎     | 28/65 [00:18<00:19,  1.91it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.93it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.95it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.97it/s] 49%|████▉     | 32/65 [00:20<00:16,  1.97it/s] 51%|█████     | 33/65 [00:21<00:16,  1.98it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:29<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:30<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:31<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.97it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.99it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.98it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.81it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.9213499734034905
spatial_difference_train: 16.741371748997615
total_train: 17.662721853989822
time taken to perform 2: 37.82
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:11,  5.81s/it]  3%|▎         | 2/65 [00:06<02:49,  2.70s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:11<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:12<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:13<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:14<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:15<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:31<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:32<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:33<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.68it/s]

______epoch summary 3/3_____

mask_train: 0.8225959900097969
spatial_difference_train: 15.732044938894418
total_train: 16.55464101449037
time taken to perform 3: 38.61
[19.87516860961914, 17.662721853989822, 16.55464101449037]
Using minimum loss from history: 16.55464101449037
[I 2025-02-18 01:10:40,297] Trial 12 finished with value: 16.55464101449037 and parameters: {'lr_init_phase2': 0.0002984891274812916, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.004213248192619894, 'lr_gamma_phase2': 0.9535129164175445, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1300}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_010844-4xfofbxq
wandb: Find logs at: ./wandb/offline-run-20250218_010844-4xfofbxq/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:23,  5.05s/it]  3%|▎         | 2/65 [00:05<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:07<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.127121642919687
spatial_difference_train: 18.82805197789119
total_train: 19.95517366849459
time taken to perform 1: 38.23
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:33,  5.21s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:09,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.91it/s] 20%|██        | 13/65 [00:11<00:26,  1.95it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.82it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:14<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.01it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.02it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.03it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.85it/s] 40%|████      | 26/65 [00:18<00:20,  1.91it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.94it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.85it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.90it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.94it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.97it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.00it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.01it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.02it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.85it/s] 71%|███████   | 46/65 [00:28<00:09,  1.90it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.94it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.97it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.99it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.00it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.01it/s] 80%|████████  | 52/65 [00:31<00:06,  2.02it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.03it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.00it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.01it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.03it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.923214989900589
spatial_difference_train: 16.81570224761963
total_train: 17.738917270073525
time taken to perform 2: 37.89
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:19,  5.93s/it]  3%|▎         | 2/65 [00:06<02:52,  2.74s/it]  5%|▍         | 3/65 [00:06<01:46,  1.72s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:11<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:12<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:13<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:14<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:15<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:20<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:26<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:27<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:28<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:29<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:30<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:31<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:32<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:33<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:34<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:35<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.68it/s]

______epoch summary 3/3_____

mask_train: 0.8238643297782311
spatial_difference_train: 15.79212697836069
total_train: 16.61599132342216
time taken to perform 3: 38.76
[19.95517366849459, 17.738917270073525, 16.61599132342216]
Using minimum loss from history: 16.61599132342216
[I 2025-02-18 01:12:37,041] Trial 13 finished with value: 16.61599132342216 and parameters: {'lr_init_phase2': 0.00029051665136665765, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0040213728059261536, 'lr_gamma_phase2': 0.952587178658989, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 800}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_011040-c1lan7fx
wandb: Find logs at: ./wandb/offline-run-20250218_011040-c1lan7fx/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:02,  4.73s/it]  3%|▎         | 2/65 [00:06<02:49,  2.70s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1267472780667818
spatial_difference_train: 18.806688895592323
total_train: 19.93343614431528
time taken to perform 1: 38.28
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.35s/it]  3%|▎         | 2/65 [00:06<02:44,  2.62s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:07<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.99it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:25<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:26<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.96it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.98it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9226209117816044
spatial_difference_train: 16.79542969923753
total_train: 17.718050619272084
time taken to perform 2: 38.40
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:31,  5.19s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:54,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8234486656311231
spatial_difference_train: 15.775699248680702
total_train: 16.59914792867807
time taken to perform 3: 38.00
[19.93343614431528, 17.718050619272084, 16.59914792867807]
Using minimum loss from history: 16.59914792867807
[I 2025-02-18 01:14:33,571] Trial 14 finished with value: 16.59914792867807 and parameters: {'lr_init_phase2': 0.0002926636174704193, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00441536524577073, 'lr_gamma_phase2': 0.9515019987355189, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 700}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_011237-t2ie6cg5
wandb: Find logs at: ./wandb/offline-run-20250218_011237-t2ie6cg5/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:26,  5.11s/it]  3%|▎         | 2/65 [00:06<02:49,  2.69s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:15,  1.23s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.1264694360586314
spatial_difference_train: 18.78478252704327
total_train: 19.91125188974234
time taken to perform 1: 38.48
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:45,  5.40s/it]  3%|▎         | 2/65 [00:05<02:39,  2.52s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  1.99it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:22,  1.81it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:25<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:26<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.96it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9222874545134031
spatial_difference_train: 16.774702915778526
total_train: 17.696990357912505
time taken to perform 2: 38.39
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:56,  5.57s/it]  3%|▎         | 2/65 [00:06<02:43,  2.59s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:56,  1.05it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.80it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.86it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.91it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.95it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8229682995722845
spatial_difference_train: 15.758944663023337
total_train: 16.581912940587753
time taken to perform 3: 38.34
[19.91125188974234, 17.696990357912505, 16.581912940587753]
Using minimum loss from history: 16.581912940587753
[I 2025-02-18 01:16:30,535] Trial 15 finished with value: 16.581912940587753 and parameters: {'lr_init_phase2': 0.0002948863417291639, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.006255443793195467, 'lr_gamma_phase2': 0.9652230990189243, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 200}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_011433-tnyigxj7
wandb: Find logs at: ./wandb/offline-run-20250218_011433-tnyigxj7/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:58,  4.67s/it]  3%|▎         | 2/65 [00:05<02:48,  2.67s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:06<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.1394818984545194
spatial_difference_train: 19.25130398090069
total_train: 20.39078592153696
time taken to perform 1: 38.39
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:06,  4.79s/it]  3%|▎         | 2/65 [00:05<02:23,  2.27s/it]  5%|▍         | 3/65 [00:05<01:31,  1.47s/it]  6%|▌         | 4/65 [00:06<01:06,  1.09s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:17<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:18<00:19,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.81it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.81it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.9359018545884352
spatial_difference_train: 17.22980640117939
total_train: 18.165708248431866
time taken to perform 2: 37.83
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:28,  5.13s/it]  3%|▎         | 2/65 [00:05<02:32,  2.42s/it]  5%|▍         | 3/65 [00:06<01:36,  1.55s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:54,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.86it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.90it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.93it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.99it/s] 91%|█████████ | 59/65 [00:34<00:03,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.86it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.95it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8342302325444344
spatial_difference_train: 16.136054513393304
total_train: 16.970284745632075
time taken to perform 3: 38.08
[20.39078592153696, 18.165708248431866, 16.970284745632075]
Using minimum loss from history: 16.970284745632075
[I 2025-02-18 01:18:26,751] Trial 16 finished with value: 16.970284745632075 and parameters: {'lr_init_phase2': 0.0002507779593187378, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.006099400956315296, 'lr_gamma_phase2': 0.978869250000905, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 100}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_011630-5dljhu07
wandb: Find logs at: ./wandb/offline-run-20250218_011630-5dljhu07/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:00,  4.69s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:09,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:14<00:25,  1.80it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.89it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:16<00:21,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:17<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.99it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.2619879089868986
spatial_difference_train: 21.180617728600136
total_train: 22.442605590820314
time taken to perform 1: 38.06
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:46,  5.42s/it]  3%|▎         | 2/65 [00:05<02:40,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:11<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.95it/s] 22%|██▏       | 14/65 [00:12<00:25,  1.98it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.02it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.03it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.04it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.90it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.94it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.04it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.85it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.90it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.94it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.97it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.03it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.04it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.85it/s] 71%|███████   | 46/65 [00:28<00:09,  1.90it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.94it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.97it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.99it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.00it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.02it/s] 80%|████████  | 52/65 [00:31<00:06,  2.02it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.03it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.03it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.00it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.01it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.03it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 1.0168725380530723
spatial_difference_train: 19.316304456270657
total_train: 20.333176964979906
time taken to perform 2: 38.06
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:19,  5.93s/it]  3%|▎         | 2/65 [00:06<02:52,  2.75s/it]  5%|▍         | 3/65 [00:06<01:46,  1.73s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:11<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:12<00:28,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:13<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:14<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:15<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:19<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:26<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:27<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:28<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:29<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:30<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:31<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:32<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:33<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:34<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:35<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.67it/s]

______epoch summary 3/3_____

mask_train: 0.8985924647404597
spatial_difference_train: 18.14618334647937
total_train: 19.044775806329188
time taken to perform 3: 38.82
[22.442605590820314, 20.333176964979906, 19.044775806329188]
Using minimum loss from history: 19.044775806329188
[I 2025-02-18 01:20:23,463] Trial 17 finished with value: 19.044775806329188 and parameters: {'lr_init_phase2': 0.00012151296040964669, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0065988034850168265, 'lr_gamma_phase2': 0.9628431783412449, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 400}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_011827-0sznhkxt
wandb: Find logs at: ./wandb/offline-run-20250218_011827-0sznhkxt/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:06,  4.79s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:43,  1.66s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:07<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.57it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.69it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1885227386768047
spatial_difference_train: 20.25773444542518
total_train: 21.446257283137395
time taken to perform 1: 38.02
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:45,  5.40s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:11<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.94it/s] 22%|██▏       | 14/65 [00:12<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.01it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.02it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.03it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.86it/s] 40%|████      | 26/65 [00:18<00:20,  1.91it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.95it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.98it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.86it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.91it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.95it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.97it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.03it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  1.99it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9694329623992627
spatial_difference_train: 18.28465893085186
total_train: 19.254091952397275
time taken to perform 2: 38.13
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:55,  5.55s/it]  3%|▎         | 2/65 [00:06<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:09<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8628592133522034
spatial_difference_train: 17.096499467507385
total_train: 17.95935870928642
time taken to perform 3: 38.28
[21.446257283137395, 19.254091952397275, 17.95935870928642]
Using minimum loss from history: 17.95935870928642
[I 2025-02-18 01:22:19,697] Trial 18 finished with value: 17.95935870928642 and parameters: {'lr_init_phase2': 0.00017450411125563575, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.009247163167383929, 'lr_gamma_phase2': 0.9854450925752603, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1600}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_012023-m6apmwzx
wandb: Find logs at: ./wandb/offline-run-20250218_012023-m6apmwzx/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:56,  4.64s/it]  3%|▎         | 2/65 [00:05<02:43,  2.59s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:28,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.3108142165037302
spatial_difference_train: 21.608613762488734
total_train: 22.919427989079402
time taken to perform 1: 38.13
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:11,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.90it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.94it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.97it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.02it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.96it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.97it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.048617256604708
spatial_difference_train: 19.82358489403358
total_train: 20.872202154306265
time taken to perform 2: 38.20
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:14,  5.85s/it]  3%|▎         | 2/65 [00:06<02:50,  2.71s/it]  5%|▍         | 3/65 [00:06<01:45,  1.71s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:11<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:12<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:13<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:14<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:15<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:31<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.68it/s]

______epoch summary 3/3_____

mask_train: 0.9237025181452433
spatial_difference_train: 18.68073487893129
total_train: 19.6044373634534
time taken to perform 3: 38.62
[22.919427989079402, 20.872202154306265, 19.6044373634534]
Using minimum loss from history: 19.6044373634534
[I 2025-02-18 01:24:16,450] Trial 19 finished with value: 19.6044373634534 and parameters: {'lr_init_phase2': 0.00010102978686413056, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0066656633673909515, 'lr_gamma_phase2': 0.9618995410134599, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 300}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_012219-7kcdz5je
wandb: Find logs at: ./wandb/offline-run-20250218_012219-7kcdz5je/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.83s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.93it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1808041820159325
spatial_difference_train: 20.125569592989407
total_train: 21.306373713566707
time taken to perform 1: 38.02
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9643419008988601
spatial_difference_train: 18.14184710429265
total_train: 19.106189001523532
time taken to perform 2: 38.18
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:53,  5.52s/it]  3%|▎         | 2/65 [00:06<02:42,  2.57s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:56,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8594976522983648
spatial_difference_train: 16.958811251322427
total_train: 17.818308893839518
time taken to perform 3: 38.20
[21.306373713566707, 19.106189001523532, 17.818308893839518]
Using minimum loss from history: 17.818308893839518
[I 2025-02-18 01:26:12,733] Trial 20 finished with value: 17.818308893839518 and parameters: {'lr_init_phase2': 0.00018326845544770437, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.005012304877572768, 'lr_gamma_phase2': 0.9791912404724765, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1100}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_012416-6auy3f1r
wandb: Find logs at: ./wandb/offline-run-20250218_012416-6auy3f1r/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.92s/it]  3%|▎         | 2/65 [00:05<02:26,  2.33s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.09it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1294516471716074
spatial_difference_train: 18.935496139526368
total_train: 20.06494777386005
time taken to perform 1: 37.84
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:50,  4.54s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:05<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.91it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:14<00:22,  1.96it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.98it/s] 34%|███▍      | 22/65 [00:15<00:21,  1.99it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:18<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.97it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.97it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.97it/s] 51%|█████     | 33/65 [00:21<00:16,  1.99it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9258848392046415
spatial_difference_train: 16.918699858738826
total_train: 17.844584699777457
time taken to perform 2: 38.04
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.31s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.81it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8259299978231772
spatial_difference_train: 15.876174804491875
total_train: 16.702104793450772
time taken to perform 3: 38.19
[20.06494777386005, 17.844584699777457, 16.702104793450772]
Using minimum loss from history: 16.702104793450772
[I 2025-02-18 01:28:08,562] Trial 21 finished with value: 16.702104793450772 and parameters: {'lr_init_phase2': 0.0002799254636186638, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.004438536138600544, 'lr_gamma_phase2': 0.9534943793721951, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 700}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_012613-sy0y0c0p
wandb: Find logs at: ./wandb/offline-run-20250218_012613-sy0y0c0p/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.96s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1274275293717018
spatial_difference_train: 18.846473561800444
total_train: 19.97390107374925
time taken to perform 1: 38.17
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.35s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:00,  1.00s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:11<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.94it/s] 22%|██▏       | 14/65 [00:12<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.82it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.93it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:22,  2.01it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.02it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.03it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.04it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.86it/s] 40%|████      | 26/65 [00:18<00:20,  1.91it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.95it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.04it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.86it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.91it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.95it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.98it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.03it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.04it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.04it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.86it/s] 71%|███████   | 46/65 [00:28<00:09,  1.91it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.95it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.98it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.99it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.01it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.02it/s] 80%|████████  | 52/65 [00:31<00:06,  2.03it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.04it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.04it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.86it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.91it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.95it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.98it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.02it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.03it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.03it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.04it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.04it/s]100%|██████████| 65/65 [00:37<00:00,  1.86it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9235476177472335
spatial_difference_train: 16.83325303884653
total_train: 17.756800651550293
time taken to perform 2: 37.93
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:49,  5.46s/it]  3%|▎         | 2/65 [00:05<02:40,  2.55s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.00it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.01it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.02it/s] 31%|███       | 20/65 [00:15<00:24,  1.84it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8240904254791064
spatial_difference_train: 15.80638088813195
total_train: 16.630471307803422
time taken to perform 3: 38.06
[19.97390107374925, 17.756800651550293, 16.630471307803422]
Using minimum loss from history: 16.630471307803422
[I 2025-02-18 01:30:04,437] Trial 22 finished with value: 16.630471307803422 and parameters: {'lr_init_phase2': 0.00028867166855701953, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.003381889152002789, 'lr_gamma_phase2': 0.9453237095970647, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 300}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_012808-b95b7yag
wandb: Find logs at: ./wandb/offline-run-20250218_012808-b95b7yag/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:03,  4.74s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.89it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.97it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.99it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.01it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.02it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.03it/s] 31%|███       | 20/65 [00:14<00:24,  1.85it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.91it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.95it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.98it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.02it/s] 40%|████      | 26/65 [00:17<00:19,  2.03it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.04it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.04it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.04it/s] 46%|████▌     | 30/65 [00:19<00:18,  1.86it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.91it/s] 49%|████▉     | 32/65 [00:20<00:16,  1.95it/s] 51%|█████     | 33/65 [00:21<00:16,  1.98it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.02it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.03it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.04it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.04it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.86it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.91it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.95it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.98it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.02it/s] 71%|███████   | 46/65 [00:27<00:09,  2.03it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.04it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:31<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  2.00it/s] 86%|████████▌ | 56/65 [00:32<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:33<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 1/3_____

mask_train: 1.1406519229595478
spatial_difference_train: 19.28549288236178
total_train: 20.42614476130559
time taken to perform 1: 37.59
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:03,  4.75s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.94it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:14<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.01it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.02it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.03it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.85it/s] 40%|████      | 26/65 [00:17<00:20,  1.90it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.94it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:19<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.04it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.936946316407277
spatial_difference_train: 17.264158799098087
total_train: 18.201105132469763
time taken to perform 2: 37.85
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:14,  4.92s/it]  3%|▎         | 2/65 [00:05<02:26,  2.33s/it]  5%|▍         | 3/65 [00:05<01:32,  1.50s/it]  6%|▌         | 4/65 [00:06<01:07,  1.11s/it]  8%|▊         | 5/65 [00:06<00:53,  1.12it/s]  9%|▉         | 6/65 [00:07<00:44,  1.31it/s] 11%|█         | 7/65 [00:07<00:39,  1.48it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.61it/s] 14%|█▍        | 9/65 [00:08<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:27<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8351389811589167
spatial_difference_train: 16.165329830463115
total_train: 17.000468806731394
time taken to perform 3: 37.72
[20.42614476130559, 18.201105132469763, 17.000468806731394]
Using minimum loss from history: 17.000468806731394
[I 2025-02-18 01:31:59,327] Trial 23 finished with value: 17.000468806731394 and parameters: {'lr_init_phase2': 0.00024778536663240894, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.004632368097225767, 'lr_gamma_phase2': 0.9708089171130824, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 800}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_013004-1rbf3qw6
wandb: Find logs at: ./wandb/offline-run-20250218_013004-1rbf3qw6/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:06,  4.79s/it]  3%|▎         | 2/65 [00:05<02:29,  2.37s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.99it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.00it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.02it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.03it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.00it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1340133006756121
spatial_difference_train: 19.094554607684795
total_train: 20.228567798321063
time taken to perform 1: 37.79
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:22,  5.04s/it]  3%|▎         | 2/65 [00:05<02:30,  2.38s/it]  5%|▍         | 3/65 [00:06<01:34,  1.53s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:14<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.98it/s] 34%|███▍      | 22/65 [00:15<00:21,  1.99it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9306166800168845
spatial_difference_train: 17.07390805024367
total_train: 18.004524671114407
time taken to perform 2: 38.00
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:57,  5.59s/it]  3%|▎         | 2/65 [00:06<02:43,  2.60s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.83it/s] 20%|██        | 13/65 [00:11<00:27,  1.89it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:24,  2.00it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.01it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.84it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  2.00it/s] 40%|████      | 26/65 [00:18<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.03it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.86it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.91it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.95it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8298364333617382
spatial_difference_train: 16.004655045729418
total_train: 16.83449144607935
time taken to perform 3: 38.05
[20.228567798321063, 18.004524671114407, 16.83449144607935]
Using minimum loss from history: 16.83449144607935
[I 2025-02-18 01:33:55,141] Trial 24 finished with value: 16.83449144607935 and parameters: {'lr_init_phase2': 0.00026488822002492234, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.005666708914595642, 'lr_gamma_phase2': 0.926648306894177, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 500}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_013159-o3mr5ffn
wandb: Find logs at: ./wandb/offline-run-20250218_013159-o3mr5ffn/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:19,  4.98s/it]  3%|▎         | 2/65 [00:05<02:39,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  2.00it/s] 40%|████      | 26/65 [00:18<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1286077765318063
spatial_difference_train: 18.898110844538763
total_train: 20.026718579805813
time taken to perform 1: 37.86
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:38,  5.29s/it]  3%|▎         | 2/65 [00:05<02:36,  2.48s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.99it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.00it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.02it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.00it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.01it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.02it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.82it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.81it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9246243408093086
spatial_difference_train: 16.882726471240705
total_train: 17.807350796919604
time taken to perform 2: 38.22
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:54,  5.53s/it]  3%|▎         | 2/65 [00:06<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.824994693046961
spatial_difference_train: 15.846732843839206
total_train: 16.67172753260686
time taken to perform 3: 38.34
[20.026718579805813, 17.807350796919604, 16.67172753260686]
Using minimum loss from history: 16.67172753260686
[I 2025-02-18 01:35:51,321] Trial 25 finished with value: 16.67172753260686 and parameters: {'lr_init_phase2': 0.0002835749678604405, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.006896027982795477, 'lr_gamma_phase2': 0.9562520803936343, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 1700}. Best is trial 12 with value: 16.55464101449037.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_013355-admi6mp0
wandb: Find logs at: ./wandb/offline-run-20250218_013355-admi6mp0/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:10,  4.85s/it]  3%|▎         | 2/65 [00:06<02:48,  2.68s/it]  5%|▍         | 3/65 [00:06<01:45,  1.70s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:39,  1.44it/s] 14%|█▍        | 9/65 [00:09<00:35,  1.58it/s] 15%|█▌        | 10/65 [00:10<00:35,  1.54it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.66it/s] 18%|█▊        | 12/65 [00:11<00:30,  1.75it/s] 20%|██        | 13/65 [00:11<00:28,  1.82it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.88it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.1253518718939561
spatial_difference_train: 18.738929381737343
total_train: 19.86428119952862
time taken to perform 1: 38.42
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:31,  5.18s/it]  3%|▎         | 2/65 [00:05<02:33,  2.44s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9207698024236239
spatial_difference_train: 16.731492181924672
total_train: 17.652261990767258
time taken to perform 2: 38.08
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:21,  5.03s/it]  3%|▎         | 2/65 [00:05<02:29,  2.37s/it]  5%|▍         | 3/65 [00:06<01:34,  1.53s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:54,  1.11it/s]  9%|▉         | 6/65 [00:07<00:45,  1.30it/s] 11%|█         | 7/65 [00:08<00:39,  1.47it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.61it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:14<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8219784764143137
spatial_difference_train: 15.724087157616248
total_train: 16.546065623943623
time taken to perform 3: 37.70
[19.86428119952862, 17.652261990767258, 16.546065623943623]
Using minimum loss from history: 16.546065623943623
[I 2025-02-18 01:37:47,494] Trial 26 finished with value: 16.546065623943623 and parameters: {'lr_init_phase2': 0.00029956636997361785, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.002903383595113578, 'lr_gamma_phase2': 0.9430825962663223, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 200}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_013551-3q8ax3ek
wandb: Find logs at: ./wandb/offline-run-20250218_013551-3q8ax3ek/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:41,  5.33s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.88it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:25,  1.80it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:21<00:16,  1.93it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1258597208903387
spatial_difference_train: 18.75659236907959
total_train: 19.8824521284837
time taken to perform 1: 38.29
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:51,  5.49s/it]  3%|▎         | 2/65 [00:06<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:40,  1.63s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:25<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.00it/s] 63%|██████▎   | 41/65 [00:26<00:11,  2.01it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9214049825301537
spatial_difference_train: 16.748060395167425
total_train: 17.669465395120476
time taken to perform 2: 38.34
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:46,  5.41s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.822572662280156
spatial_difference_train: 15.737408858079176
total_train: 16.55998154175587
time taken to perform 3: 38.09
[19.8824521284837, 17.669465395120476, 16.55998154175587]
Using minimum loss from history: 16.55998154175587
[I 2025-02-18 01:39:43,991] Trial 27 finished with value: 16.55998154175587 and parameters: {'lr_init_phase2': 0.0002977437301715426, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00011829750430011714, 'lr_gamma_phase2': 0.9413297311989488, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 200}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_013747-mk0tsf5m
wandb: Find logs at: ./wandb/offline-run-20250218_013747-mk0tsf5m/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:29,  5.15s/it]  3%|▎         | 2/65 [00:05<02:35,  2.46s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.58it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.77it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.88it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.91it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.93it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.93it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.95it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1488862652045029
spatial_difference_train: 19.4873412499061
total_train: 20.63622753436749
time taken to perform 1: 38.21
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:00,  4.70s/it]  3%|▎         | 2/65 [00:05<02:36,  2.48s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9429107711865352
spatial_difference_train: 17.46952702448918
total_train: 18.41243785711435
time taken to perform 2: 37.99
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:20,  5.01s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8404546285286928
spatial_difference_train: 16.343027926713994
total_train: 17.183482595590444
time taken to perform 3: 38.08
[20.63622753436749, 18.41243785711435, 17.183482595590444]
Using minimum loss from history: 17.183482595590444
[I 2025-02-18 01:41:40,028] Trial 28 finished with value: 17.183482595590444 and parameters: {'lr_init_phase2': 0.00023075597706161897, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0004267081243629479, 'lr_gamma_phase2': 0.9300294287897305, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 300}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_013944-7inn84ab
wandb: Find logs at: ./wandb/offline-run-20250218_013944-7inn84ab/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.32s/it]  3%|▎         | 2/65 [00:05<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1391612713153545
spatial_difference_train: 19.24271618769719
total_train: 20.38187742966872
time taken to perform 1: 38.23
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:26,  5.10s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.94it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.95it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.01it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.02it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.03it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.00it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.02it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.00it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.01it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.02it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.00it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.01it/s] 80%|████████  | 52/65 [00:31<00:06,  2.02it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.03it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.03it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.90it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.94it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.97it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.01it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.02it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.03it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.04it/s]100%|██████████| 65/65 [00:37<00:00,  1.85it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9356832412573007
spatial_difference_train: 17.221158108344444
total_train: 18.156841344099778
time taken to perform 2: 37.95
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:46,  5.42s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.83it/s] 20%|██        | 13/65 [00:11<00:27,  1.89it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.97it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.99it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.01it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.02it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.03it/s] 31%|███       | 20/65 [00:15<00:24,  1.85it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.90it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.94it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.97it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.99it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.01it/s] 40%|████      | 26/65 [00:18<00:19,  2.02it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.03it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.03it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.04it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.91it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.95it/s] 51%|█████     | 33/65 [00:21<00:16,  1.98it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.04it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.91it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.834025652286334
spatial_difference_train: 16.12867494729849
total_train: 16.962700609060434
time taken to perform 3: 37.85
[20.38187742966872, 18.156841344099778, 16.962700609060434]
Using minimum loss from history: 16.962700609060434
[I 2025-02-18 01:43:35,763] Trial 29 finished with value: 16.962700609060434 and parameters: {'lr_init_phase2': 0.00025151923296806266, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0013202325358452614, 'lr_gamma_phase2': 0.943049926480194, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1800}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_014140-wfisuxn1
wandb: Find logs at: ./wandb/offline-run-20250218_014140-wfisuxn1/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.32s/it]  3%|▎         | 2/65 [00:05<02:38,  2.51s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:55,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:24,  2.00it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.01it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.02it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.00it/s] 40%|████      | 26/65 [00:18<00:19,  2.02it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.03it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.03it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.04it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.81it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.86it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 2.031431159606347
spatial_difference_train: 23.887473091712366
total_train: 25.918904289832483
time taken to perform 1: 38.07
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:00,  4.70s/it]  3%|▎         | 2/65 [00:05<02:20,  2.24s/it]  5%|▍         | 3/65 [00:05<01:29,  1.45s/it]  6%|▌         | 4/65 [00:06<01:05,  1.08s/it]  8%|▊         | 5/65 [00:06<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:07<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:08<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:09<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:10<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:14<00:22,  1.99it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.00it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.02it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:17<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:19<00:17,  2.00it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.01it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:27<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:28<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:29<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:30<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:31<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:32<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:33<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:34<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:35<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:36<00:00,  2.02it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 2/3_____

mask_train: 1.592045243886801
spatial_difference_train: 23.23569491459773
total_train: 24.827740141061636
time taken to perform 2: 37.57
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:46,  5.41s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.83it/s] 20%|██        | 13/65 [00:11<00:27,  1.89it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.97it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.99it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.01it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.02it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.03it/s] 31%|███       | 20/65 [00:15<00:24,  1.85it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.90it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.95it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.97it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.01it/s] 40%|████      | 26/65 [00:18<00:19,  2.02it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.03it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.04it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.04it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.86it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.91it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.95it/s] 51%|█████     | 33/65 [00:21<00:16,  1.98it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.04it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.95it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.98it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.86it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.95it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.98it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.86it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 1.3678584755995336
spatial_difference_train: 22.625050598535783
total_train: 23.99290909400353
time taken to perform 3: 37.80
[25.918904289832483, 24.827740141061636, 23.99290909400353]
Using minimum loss from history: 23.99290909400353
[I 2025-02-18 01:45:30,943] Trial 30 finished with value: 23.99290909400353 and parameters: {'lr_init_phase2': 1.9214596582709675e-05, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0014724541977661706, 'lr_gamma_phase2': 0.9387320128269733, 'lr_step_phase2': 5000, 'lr_warmup_phase2': 1400}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_014336-rvq5ohe5
wandb: Find logs at: ./wandb/offline-run-20250218_014336-rvq5ohe5/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:10,  4.85s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:06<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:56,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1254540415910574
spatial_difference_train: 18.74139508467454
total_train: 19.866849224384016
time taken to perform 1: 38.01
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.83s/it]  3%|▎         | 2/65 [00:05<02:37,  2.50s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<00:59,  1.00it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.94it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.00it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.00it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.01it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.02it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.85it/s] 71%|███████   | 46/65 [00:28<00:09,  1.90it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.94it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.97it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.99it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.01it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.02it/s] 80%|████████  | 52/65 [00:31<00:06,  2.02it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.03it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.03it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.85it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.90it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.94it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.97it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.01it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.02it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.03it/s]100%|██████████| 65/65 [00:37<00:00,  1.85it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9211337369221907
spatial_difference_train: 16.733791930858906
total_train: 17.65492570583637
time taken to perform 2: 37.93
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:21,  5.03s/it]  3%|▎         | 2/65 [00:05<02:29,  2.37s/it]  5%|▍         | 3/65 [00:06<01:34,  1.52s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:54,  1.11it/s]  9%|▉         | 6/65 [00:07<00:45,  1.30it/s] 11%|█         | 7/65 [00:08<00:39,  1.47it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.61it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.97it/s] 71%|███████   | 46/65 [00:28<00:09,  1.98it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8223384358944037
spatial_difference_train: 15.725932233761519
total_train: 16.548270680354193
time taken to perform 3: 37.86
[19.866849224384016, 17.65492570583637, 16.548270680354193]
Using minimum loss from history: 16.548270680354193
[I 2025-02-18 01:47:26,516] Trial 31 finished with value: 16.548270680354193 and parameters: {'lr_init_phase2': 0.00029931152662634753, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00244755409651277, 'lr_gamma_phase2': 0.9455950796346793, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 100}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_014531-rh28gk9h
wandb: Find logs at: ./wandb/offline-run-20250218_014531-rh28gk9h/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:13,  4.90s/it]  3%|▎         | 2/65 [00:05<02:42,  2.57s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:35,  1.57it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.77it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.125370407104492
spatial_difference_train: 18.74078069833609
total_train: 19.86615110544058
time taken to perform 1: 38.21
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:36,  5.26s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.920794494335468
spatial_difference_train: 16.733219990363487
total_train: 17.654014484698955
time taken to perform 2: 38.18
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:01,  5.64s/it]  3%|▎         | 2/65 [00:06<02:45,  2.63s/it]  5%|▍         | 3/65 [00:06<01:42,  1.66s/it]  6%|▌         | 4/65 [00:07<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:23<00:14,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:28<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.03it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.91it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.822036233315101
spatial_difference_train: 15.725472391568697
total_train: 16.54750862121582
time taken to perform 3: 38.22
[19.86615110544058, 17.654014484698955, 16.54750862121582]
Using minimum loss from history: 16.54750862121582
[I 2025-02-18 01:49:22,974] Trial 32 finished with value: 16.54750862121582 and parameters: {'lr_init_phase2': 0.0002993738453148411, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0022823699251286814, 'lr_gamma_phase2': 0.9413125616911999, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 100}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_014726-pxz7gf0z
wandb: Find logs at: ./wandb/offline-run-20250218_014726-pxz7gf0z/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:00,  4.70s/it]  3%|▎         | 2/65 [00:05<02:21,  2.25s/it]  5%|▍         | 3/65 [00:05<01:30,  1.46s/it]  6%|▌         | 4/65 [00:06<01:06,  1.08s/it]  8%|▊         | 5/65 [00:06<00:52,  1.14it/s]  9%|▉         | 6/65 [00:07<00:44,  1.33it/s] 11%|█         | 7/65 [00:07<00:39,  1.48it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.60it/s] 14%|█▍        | 9/65 [00:08<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:12<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:13<00:23,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:22<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.00it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:25<00:12,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:27<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 1/3_____

mask_train: 1.1330738516954275
spatial_difference_train: 19.06233940124512
total_train: 20.195413266695464
time taken to perform 1: 37.66
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:06<06:24,  6.01s/it]  3%|▎         | 2/65 [00:06<02:54,  2.77s/it]  5%|▍         | 3/65 [00:07<01:48,  1.74s/it]  6%|▌         | 4/65 [00:07<01:16,  1.26s/it]  8%|▊         | 5/65 [00:08<01:02,  1.05s/it]  9%|▉         | 6/65 [00:08<00:50,  1.16it/s] 11%|█         | 7/65 [00:09<00:43,  1.35it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.51it/s] 14%|█▍        | 9/65 [00:10<00:34,  1.64it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.74it/s] 17%|█▋        | 11/65 [00:11<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:12<00:27,  1.93it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:13<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:14<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:15<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:16<00:22,  1.98it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.94it/s] 38%|███▊      | 25/65 [00:18<00:22,  1.77it/s] 40%|████      | 26/65 [00:19<00:21,  1.84it/s] 42%|████▏     | 27/65 [00:19<00:20,  1.88it/s] 43%|████▎     | 28/65 [00:20<00:19,  1.92it/s] 45%|████▍     | 29/65 [00:20<00:18,  1.95it/s] 46%|████▌     | 30/65 [00:21<00:17,  1.97it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.98it/s] 49%|████▉     | 32/65 [00:22<00:16,  2.00it/s] 51%|█████     | 33/65 [00:22<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:23<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.81it/s] 55%|█████▌    | 36/65 [00:24<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:25<00:13,  1.94it/s] 60%|██████    | 39/65 [00:25<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:26<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:27<00:11,  1.98it/s] 66%|██████▌   | 43/65 [00:27<00:11,  2.00it/s] 68%|██████▊   | 44/65 [00:28<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.82it/s] 71%|███████   | 46/65 [00:29<00:10,  1.86it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.91it/s] 74%|███████▍  | 48/65 [00:30<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:31<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:06,  2.00it/s] 80%|████████  | 52/65 [00:32<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:33<00:05,  2.03it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:34<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:35<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:36<00:02,  2.00it/s] 94%|█████████▍| 61/65 [00:36<00:01,  2.01it/s] 95%|█████████▌| 62/65 [00:37<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:38<00:00,  2.03it/s]100%|██████████| 65/65 [00:39<00:00,  1.84it/s]100%|██████████| 65/65 [00:39<00:00,  1.67it/s]

______epoch summary 2/3_____

mask_train: 0.9296426731806535
spatial_difference_train: 17.042194923987754
total_train: 17.971837557279148
time taken to perform 2: 39.04
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:18,  4.98s/it]  3%|▎         | 2/65 [00:05<02:28,  2.36s/it]  5%|▍         | 3/65 [00:06<01:34,  1.52s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:54,  1.10it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8289292350793496
spatial_difference_train: 15.9782013966487
total_train: 16.807130613082496
time taken to perform 3: 37.85
[20.195413266695464, 17.971837557279148, 16.807130613082496]
Using minimum loss from history: 16.807130613082496
[I 2025-02-18 01:51:19,312] Trial 33 finished with value: 16.807130613082496 and parameters: {'lr_init_phase2': 0.000267865815900095, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0023418670848042874, 'lr_gamma_phase2': 0.9444039607647847, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 100}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_014923-ia2jp5b2
wandb: Find logs at: ./wandb/offline-run-20250218_014923-ia2jp5b2/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.96s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.88it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:25,  1.78it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.84it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.89it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.92it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.94it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.96it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.97it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.98it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:21<00:16,  1.92it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.95it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:28<00:09,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.02it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.86it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.95it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.98it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.91it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.95it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.98it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.1347340657160832
spatial_difference_train: 19.117406610342172
total_train: 20.25214057335487
time taken to perform 1: 38.15
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<04:59,  4.68s/it]  3%|▎         | 2/65 [00:05<02:41,  2.57s/it]  5%|▍         | 3/65 [00:06<01:40,  1.63s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:07<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:08<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.65it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.74it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.86it/s] 20%|██        | 13/65 [00:11<00:27,  1.90it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.83it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.88it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.92it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.94it/s] 31%|███       | 20/65 [00:15<00:22,  1.96it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.97it/s] 34%|███▍      | 22/65 [00:16<00:21,  1.98it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.98it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.99it/s] 38%|███▊      | 25/65 [00:17<00:22,  1.81it/s] 40%|████      | 26/65 [00:18<00:20,  1.87it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.00it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.01it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.02it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.90it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.94it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.97it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.03it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.04it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.85it/s] 71%|███████   | 46/65 [00:28<00:09,  1.91it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.95it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.98it/s] 75%|███████▌  | 49/65 [00:29<00:08,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.01it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.02it/s] 80%|████████  | 52/65 [00:31<00:06,  2.03it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.03it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.04it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.86it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.91it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.95it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.98it/s] 91%|█████████ | 59/65 [00:34<00:03,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.01it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.02it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.03it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.04it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.04it/s]100%|██████████| 65/65 [00:38<00:00,  1.85it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9314881430222438
spatial_difference_train: 17.09643300129817
total_train: 18.027921082423283
time taken to perform 2: 38.08
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:23,  5.06s/it]  3%|▎         | 2/65 [00:05<02:30,  2.38s/it]  5%|▍         | 3/65 [00:06<01:34,  1.53s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:54,  1.10it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.91it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.89it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.92it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8304458667070438
spatial_difference_train: 16.023474350953713
total_train: 16.853920183426293
time taken to perform 3: 38.00
[20.25214057335487, 18.027921082423283, 16.853920183426293]
Using minimum loss from history: 16.853920183426293
[I 2025-02-18 01:53:15,517] Trial 34 finished with value: 16.853920183426293 and parameters: {'lr_init_phase2': 0.0002627804909661014, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0029822876538641947, 'lr_gamma_phase2': 0.9492776955132992, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 200}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_015119-tttb8d0y
wandb: Find logs at: ./wandb/offline-run-20250218_015119-tttb8d0y/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:23,  5.06s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.99it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.00it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.02it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.02it/s] 31%|███       | 20/65 [00:14<00:24,  1.84it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.90it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.94it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.97it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.99it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.01it/s] 40%|████      | 26/65 [00:17<00:19,  2.02it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.03it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.03it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.04it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.91it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.95it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.98it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.86it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.95it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.98it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 1/3_____

mask_train: 1.125579114143665
spatial_difference_train: 18.746517709585337
total_train: 19.87209683931791
time taken to perform 1: 37.65
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:09,  4.84s/it]  3%|▎         | 2/65 [00:05<02:33,  2.43s/it]  5%|▍         | 3/65 [00:06<01:36,  1.55s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9211675387162429
spatial_difference_train: 16.738597935896653
total_train: 17.659765478280875
time taken to perform 2: 37.95
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:35,  5.24s/it]  3%|▎         | 2/65 [00:05<02:34,  2.46s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.61it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.89it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.99it/s] 26%|██▌       | 17/65 [00:13<00:23,  2.01it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.02it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.03it/s] 31%|███       | 20/65 [00:14<00:24,  1.85it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.90it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.94it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.97it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.99it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.01it/s] 40%|████      | 26/65 [00:17<00:19,  2.02it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.03it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.03it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.04it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.91it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.95it/s] 51%|█████     | 33/65 [00:21<00:16,  1.98it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.00it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.04it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.86it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.91it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.95it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.98it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.00it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.04it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.86it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.95it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.98it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 3/3_____

mask_train: 0.8223433959178436
spatial_difference_train: 15.729798297393016
total_train: 16.55214169331086
time taken to perform 3: 37.64
[19.87209683931791, 17.659765478280875, 16.55214169331086]
Using minimum loss from history: 16.55214169331086
[I 2025-02-18 01:55:10,494] Trial 35 finished with value: 16.55214169331086 and parameters: {'lr_init_phase2': 0.00029878313116341715, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0020417219446516835, 'lr_gamma_phase2': 0.9330577599207137, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 400}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_015315-tflq34ss
wandb: Find logs at: ./wandb/offline-run-20250218_015315-tflq34ss/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:42,  5.35s/it]  3%|▎         | 2/65 [00:06<02:53,  2.75s/it]  5%|▍         | 3/65 [00:06<01:47,  1.73s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:35,  1.57it/s] 17%|█▋        | 11/65 [00:11<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.77it/s] 20%|██        | 13/65 [00:12<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.89it/s] 23%|██▎       | 15/65 [00:13<00:25,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:14<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:15<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.00it/s] 77%|███████▋  | 50/65 [00:31<00:08,  1.80it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.86it/s] 80%|████████  | 52/65 [00:32<00:06,  1.90it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.93it/s] 83%|████████▎ | 54/65 [00:33<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:34<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:35<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.68it/s]

______epoch summary 1/3_____

mask_train: 1.1483963902180012
spatial_difference_train: 19.47741963313176
total_train: 20.625816051776592
time taken to perform 1: 38.77
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:58,  5.60s/it]  3%|▎         | 2/65 [00:06<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<01:01,  1.02s/it]  9%|▉         | 6/65 [00:08<00:49,  1.19it/s] 11%|█         | 7/65 [00:08<00:42,  1.37it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.52it/s] 14%|█▍        | 9/65 [00:09<00:34,  1.64it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.75it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.88it/s] 20%|██        | 13/65 [00:11<00:27,  1.92it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:18<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:20<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:21<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:22<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:25<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:26<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9426646466438587
spatial_difference_train: 17.45935086470384
total_train: 18.402015524644117
time taken to perform 2: 38.51
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:46,  5.42s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:39,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.02it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.03it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.03it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.04it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.86it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.95it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.98it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.00it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.03it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 3/3_____

mask_train: 0.8403276171439733
spatial_difference_train: 16.334120916708923
total_train: 17.174448531713242
time taken to perform 3: 37.90
[20.625816051776592, 18.402015524644117, 17.174448531713242]
Using minimum loss from history: 17.174448531713242
[I 2025-02-18 01:57:07,486] Trial 36 finished with value: 17.174448531713242 and parameters: {'lr_init_phase2': 0.00023156989945147477, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0018315497093682517, 'lr_gamma_phase2': 0.9162426112947649, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 400}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_015510-c6mu1l3f
wandb: Find logs at: ./wandb/offline-run-20250218_015510-c6mu1l3f/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:07,  4.81s/it]  3%|▎         | 2/65 [00:05<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<00:56,  1.05it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:19,  2.00it/s] 40%|████      | 26/65 [00:18<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.02it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.03it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.03it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.94it/s] 51%|█████     | 33/65 [00:21<00:16,  1.97it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.99it/s] 54%|█████▍    | 35/65 [00:22<00:14,  2.01it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.02it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.03it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.03it/s] 60%|██████    | 39/65 [00:24<00:12,  2.04it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.97it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.99it/s] 69%|██████▉   | 45/65 [00:27<00:09,  2.01it/s] 71%|███████   | 46/65 [00:28<00:09,  2.02it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.03it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.03it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.04it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.91it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.97it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:04,  2.01it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.03it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.04it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.2535781741142273
spatial_difference_train: 20.263990666316104
total_train: 21.517568940382738
time taken to perform 1: 37.87
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:06<06:24,  6.01s/it]  3%|▎         | 2/65 [00:06<02:54,  2.77s/it]  5%|▍         | 3/65 [00:07<01:47,  1.74s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:08<01:02,  1.04s/it]  9%|▉         | 6/65 [00:08<00:50,  1.17it/s] 11%|█         | 7/65 [00:09<00:42,  1.35it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.51it/s] 14%|█▍        | 9/65 [00:10<00:34,  1.64it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.74it/s] 17%|█▋        | 11/65 [00:11<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.87it/s] 20%|██        | 13/65 [00:12<00:27,  1.91it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:13<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:14<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:15<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:16<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:17<00:20,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:18<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.95it/s] 45%|████▍     | 29/65 [00:20<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:22<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:24<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:25<00:13,  1.95it/s] 60%|██████    | 39/65 [00:25<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:26<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:26<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:27<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:27<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:28<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.82it/s] 71%|███████   | 46/65 [00:29<00:10,  1.87it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:30<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:31<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.99it/s] 80%|████████  | 52/65 [00:32<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:33<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:34<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:35<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:37<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:38<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.67it/s]

______epoch summary 2/3_____

mask_train: 1.0298049931342785
spatial_difference_train: 18.93242366497333
total_train: 19.96222868699294
time taken to perform 2: 38.95
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:48,  5.44s/it]  3%|▎         | 2/65 [00:05<02:40,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.62it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.95it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.94it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.95it/s] 40%|████      | 26/65 [00:18<00:19,  1.96it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.97it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.85it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:22<00:16,  1.93it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.95it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.96it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:04,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.02it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.03it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.94it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.97it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.9414600448730664
spatial_difference_train: 18.255189983661356
total_train: 19.19665006979918
time taken to perform 3: 38.34
[21.517568940382738, 19.96222868699294, 19.19665006979918]
Using minimum loss from history: 19.19665006979918
[I 2025-02-18 01:59:04,399] Trial 37 finished with value: 19.19665006979918 and parameters: {'lr_init_phase2': 0.00027359284070245526, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.002986743635408879, 'lr_gamma_phase2': 0.9324394153784553, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 100}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_015707-1qp0o8ln
wandb: Find logs at: ./wandb/offline-run-20250218_015707-1qp0o8ln/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.97s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:06<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1414568598453816
spatial_difference_train: 19.305070466261643
total_train: 20.446527275672327
time taken to perform 1: 38.07
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:17,  4.96s/it]  3%|▎         | 2/65 [00:05<02:32,  2.42s/it]  5%|▍         | 3/65 [00:06<01:35,  1.55s/it]  6%|▌         | 4/65 [00:06<01:09,  1.14s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.83it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.87it/s] 20%|██        | 13/65 [00:11<00:27,  1.91it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.84it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:14<00:22,  1.97it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.98it/s] 34%|███▍      | 22/65 [00:15<00:21,  1.98it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.99it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.99it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9377193230849046
spatial_difference_train: 17.283868327507605
total_train: 18.22158759190486
time taken to perform 2: 38.08
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:58,  5.61s/it]  3%|▎         | 2/65 [00:06<02:44,  2.61s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.8357336307183291
spatial_difference_train: 16.18217110756116
total_train: 17.017904707101675
time taken to perform 3: 38.34
[20.446527275672327, 18.22158759190486, 17.017904707101675]
Using minimum loss from history: 17.017904707101675
[I 2025-02-18 02:01:00,976] Trial 38 finished with value: 17.017904707101675 and parameters: {'lr_init_phase2': 0.0002460821394426276, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.001818862414183044, 'lr_gamma_phase2': 0.9280589767311431, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 500}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_015904-iepe5n71
wandb: Find logs at: ./wandb/offline-run-20250218_015904-iepe5n71/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:05<05:20,  5.00s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:09,  1.13s/it]  8%|▊         | 5/65 [00:07<00:54,  1.10it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.70it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:14<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.2951721814962533
spatial_difference_train: 20.8773563678448
total_train: 22.17252851632925
time taken to perform 1: 37.89
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:24,  5.07s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:36,  1.56s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:07<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:08<00:37,  1.53it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.65it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.74it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.81it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.86it/s] 20%|██        | 13/65 [00:11<00:27,  1.90it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.84it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.95it/s] 31%|███       | 20/65 [00:15<00:22,  1.96it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.97it/s] 34%|███▍      | 22/65 [00:16<00:21,  1.98it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.99it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  1.99it/s] 51%|█████     | 33/65 [00:21<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.83it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.0606653497769283
spatial_difference_train: 19.60996602865366
total_train: 20.670631320659933
time taken to perform 2: 38.24
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:10,  5.79s/it]  3%|▎         | 2/65 [00:06<02:48,  2.68s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 3/3_____

mask_train: 0.9666079872693771
spatial_difference_train: 18.949654779678735
total_train: 19.916262739132613
time taken to perform 3: 38.51
[22.17252851632925, 20.670631320659933, 19.916262739132613]
Using minimum loss from history: 19.916262739132613
[I 2025-02-18 02:02:57,383] Trial 39 finished with value: 19.916262739132613 and parameters: {'lr_init_phase2': 0.00021689960829544648, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.0010858336938156144, 'lr_gamma_phase2': 0.9230014507038056, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 400}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_020101-q2e97lnz
wandb: Find logs at: ./wandb/offline-run-20250218_020101-q2e97lnz/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:33,  5.21s/it]  3%|▎         | 2/65 [00:06<02:52,  2.74s/it]  5%|▍         | 3/65 [00:06<01:46,  1.72s/it]  6%|▌         | 4/65 [00:07<01:15,  1.24s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.58it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.69it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.2300003959582402
spatial_difference_train: 20.831120828481822
total_train: 22.061121280376728
time taken to perform 1: 38.49
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:50,  5.48s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.996422854753641
spatial_difference_train: 18.917405502612773
total_train: 19.91382839496319
time taken to perform 2: 38.34
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:35,  5.24s/it]  3%|▎         | 2/65 [00:05<02:35,  2.46s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:39,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.96it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.99it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8828783056674859
spatial_difference_train: 17.731281388111604
total_train: 18.614159730764534
time taken to perform 3: 38.06
[22.061121280376728, 19.91382839496319, 18.614159730764534]
Using minimum loss from history: 18.614159730764534
[I 2025-02-18 02:04:54,394] Trial 40 finished with value: 18.614159730764534 and parameters: {'lr_init_phase2': 0.00014002025873439866, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0025083430947487116, 'lr_gamma_phase2': 0.9386598613078564, 'lr_step_phase2': 3000, 'lr_warmup_phase2': 200}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_020257-h0tz7xgq
wandb: Find logs at: ./wandb/offline-run-20250218_020257-h0tz7xgq/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:16,  4.95s/it]  3%|▎         | 2/65 [00:05<02:42,  2.59s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.77it/s] 20%|██        | 13/65 [00:11<00:28,  1.83it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.88it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.91it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.93it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.93it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.95it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.89it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.125854399571052
spatial_difference_train: 18.75820088019738
total_train: 19.88405532836914
time taken to perform 1: 38.31
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:34,  5.22s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.95it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.97it/s] 31%|███       | 20/65 [00:15<00:22,  1.99it/s] 32%|███▏      | 21/65 [00:15<00:22,  2.00it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.01it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.02it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.96it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9214813250761765
spatial_difference_train: 16.749604790027323
total_train: 17.671086149949293
time taken to perform 2: 38.05
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:06,  5.73s/it]  3%|▎         | 2/65 [00:06<02:47,  2.66s/it]  5%|▍         | 3/65 [00:06<01:43,  1.68s/it]  6%|▌         | 4/65 [00:07<01:14,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:22<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 3/3_____

mask_train: 0.8225497267185113
spatial_difference_train: 15.738675234867976
total_train: 16.561224991235978
time taken to perform 3: 38.44
[19.88405532836914, 17.671086149949293, 16.561224991235978]
Using minimum loss from history: 16.561224991235978
[I 2025-02-18 02:06:50,911] Trial 41 finished with value: 16.561224991235978 and parameters: {'lr_init_phase2': 0.00029758913876240447, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.003545232265073279, 'lr_gamma_phase2': 0.9582010801661682, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 100}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_020454-zchm2etv
wandb: Find logs at: ./wandb/offline-run-20250218_020454-zchm2etv/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:12,  4.89s/it]  3%|▎         | 2/65 [00:05<02:39,  2.54s/it]  5%|▍         | 3/65 [00:06<01:40,  1.61s/it]  6%|▌         | 4/65 [00:06<01:11,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.07it/s]  9%|▉         | 6/65 [00:07<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1291180243858925
spatial_difference_train: 18.91629758981558
total_train: 20.045415555513824
time taken to perform 1: 38.07
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:55,  5.56s/it]  3%|▎         | 2/65 [00:06<02:43,  2.59s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:07<01:12,  1.20s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.85it/s] 18%|█▊        | 12/65 [00:11<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.95it/s] 22%|██▏       | 14/65 [00:12<00:25,  1.97it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.02it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.03it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.04it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:18<00:20,  1.90it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.94it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.04it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.86it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.91it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.95it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.98it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.03it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.04it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.04it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.86it/s] 71%|███████   | 46/65 [00:28<00:09,  1.91it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.95it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.98it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.02it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.03it/s] 80%|████████  | 52/65 [00:31<00:06,  2.03it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.04it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.04it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.87it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.92it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.95it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.98it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.02it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.03it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.04it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.04it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.04it/s]100%|██████████| 65/65 [00:38<00:00,  1.86it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 2/3_____

mask_train: 0.9254020035266877
spatial_difference_train: 16.90017423629761
total_train: 17.825576166006236
time taken to perform 2: 38.06
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:54,  5.53s/it]  3%|▎         | 2/65 [00:06<02:42,  2.58s/it]  5%|▍         | 3/65 [00:06<01:41,  1.63s/it]  6%|▌         | 4/65 [00:07<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.825614784619747
spatial_difference_train: 15.860977324461325
total_train: 16.686592067816317
time taken to perform 3: 38.26
[20.045415555513824, 17.825576166006236, 16.686592067816317]
Using minimum loss from history: 16.686592067816317
[I 2025-02-18 02:08:47,038] Trial 42 finished with value: 16.686592067816317 and parameters: {'lr_init_phase2': 0.0002817821425408324, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0021486903973548773, 'lr_gamma_phase2': 0.9470512034498954, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 1200}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_020651-lhc4ikcl
wandb: Find logs at: ./wandb/offline-run-20250218_020651-lhc4ikcl/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:12,  4.88s/it]  3%|▎         | 2/65 [00:06<02:48,  2.68s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:14,  1.23s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:08<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.90it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.96it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.81it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.87it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.91it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.94it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.98it/s] 40%|████      | 26/65 [00:18<00:19,  1.99it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.80it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.98it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.99it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.00it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.96it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.97it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.98it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.99it/s] 91%|█████████ | 59/65 [00:35<00:03,  2.00it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.81it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.134567952156067
spatial_difference_train: 19.110116665179913
total_train: 20.244684542142426
time taken to perform 1: 38.47
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:46,  5.41s/it]  3%|▎         | 2/65 [00:05<02:39,  2.53s/it]  5%|▍         | 3/65 [00:06<01:39,  1.60s/it]  6%|▌         | 4/65 [00:06<01:11,  1.17s/it]  8%|▊         | 5/65 [00:07<01:00,  1.01s/it]  9%|▉         | 6/65 [00:08<00:49,  1.20it/s] 11%|█         | 7/65 [00:08<00:42,  1.38it/s] 12%|█▏        | 8/65 [00:09<00:37,  1.54it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.75it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.82it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.87it/s] 20%|██        | 13/65 [00:11<00:27,  1.91it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.94it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:21,  2.00it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.00it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:17,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:23<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:24<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.98it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.02it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:30<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:31<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:32<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:01,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 2/3_____

mask_train: 0.9314044626859518
spatial_difference_train: 17.089227492992695
total_train: 18.020631907536433
time taken to perform 2: 38.37
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.32s/it]  3%|▎         | 2/65 [00:05<02:37,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.28it/s] 11%|█         | 7/65 [00:08<00:40,  1.45it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.65it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.75it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.8303617920631018
spatial_difference_train: 16.0174437889686
total_train: 16.847805541600938
time taken to perform 3: 37.95
[20.244684542142426, 18.020631907536433, 16.847805541600938]
Using minimum loss from history: 16.847805541600938
[I 2025-02-18 02:10:43,543] Trial 43 finished with value: 16.847805541600938 and parameters: {'lr_init_phase2': 0.00026344827004960947, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.0027846153990164373, 'lr_gamma_phase2': 0.9354865816477278, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 300}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_020847-xb0sy9p0
wandb: Find logs at: ./wandb/offline-run-20250218_020847-xb0sy9p0/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:10,  4.85s/it]  3%|▎         | 2/65 [00:05<02:46,  2.64s/it]  5%|▍         | 3/65 [00:06<01:43,  1.67s/it]  6%|▌         | 4/65 [00:06<01:13,  1.21s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]finished warmup
  9%|▉         | 6/65 [00:07<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.57it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.69it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.77it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.88it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.91it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.95it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.97it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:25,  1.80it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.96it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.97it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.98it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.2519843009802012
spatial_difference_train: 20.235376064593975
total_train: 21.487360294048603
time taken to perform 1: 38.38
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:08,  4.83s/it]  3%|▎         | 2/65 [00:05<02:30,  2.40s/it]  5%|▍         | 3/65 [00:06<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:48,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.86it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.91it/s] 20%|██        | 13/65 [00:11<00:26,  1.95it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.98it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.82it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:14<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.02it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.02it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.02it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.03it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:17<00:20,  1.89it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.93it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.96it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:19<00:17,  2.00it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.01it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.02it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.03it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.94it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.97it/s] 60%|██████    | 39/65 [00:24<00:13,  1.99it/s] 62%|██████▏   | 40/65 [00:24<00:12,  2.00it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.01it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.02it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.84it/s] 71%|███████   | 46/65 [00:28<00:10,  1.89it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.94it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.97it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.99it/s] 77%|███████▋  | 50/65 [00:30<00:07,  2.01it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:30<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:31<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.83it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.00it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.01it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.02it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.03it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.03it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 1.0286510155751154
spatial_difference_train: 18.901466648395246
total_train: 19.93011762178861
time taken to perform 2: 37.73
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:34,  5.22s/it]  3%|▎         | 2/65 [00:05<02:34,  2.45s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:55,  1.09it/s]  9%|▉         | 6/65 [00:07<00:45,  1.29it/s] 11%|█         | 7/65 [00:08<00:39,  1.46it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.59it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.71it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.74it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.99it/s] 60%|██████    | 39/65 [00:24<00:12,  2.00it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.99it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.98it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.99it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.91it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.94it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.96it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 3/3_____

mask_train: 0.9405260336704743
spatial_difference_train: 18.223593022273135
total_train: 19.164119055332282
time taken to perform 3: 38.02
[21.487360294048603, 19.93011762178861, 19.164119055332282]
Using minimum loss from history: 19.164119055332282
[I 2025-02-18 02:12:39,603] Trial 44 finished with value: 19.164119055332282 and parameters: {'lr_init_phase2': 0.00027648726204714544, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.001009767253669254, 'lr_gamma_phase2': 0.9405894689914974, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 1000}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_021043-fb4ygk5b
wandb: Find logs at: ./wandb/offline-run-20250218_021043-fb4ygk5b/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:18,  4.97s/it]  3%|▎         | 2/65 [00:05<02:34,  2.46s/it]  5%|▍         | 3/65 [00:06<01:47,  1.73s/it]  6%|▌         | 4/65 [00:07<01:15,  1.25s/it]  8%|▊         | 5/65 [00:07<00:58,  1.02it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.66it/s] 15%|█▌        | 10/65 [00:10<00:35,  1.57it/s] 17%|█▋        | 11/65 [00:10<00:32,  1.68it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.77it/s] 20%|██        | 13/65 [00:11<00:28,  1.83it/s] 22%|██▏       | 14/65 [00:12<00:27,  1.88it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.91it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.94it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:21<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  2.00it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 1/3_____

mask_train: 1.125675082206726
spatial_difference_train: 18.74990458855262
total_train: 19.875579540546124
time taken to perform 1: 38.26
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:07,  4.81s/it]  3%|▎         | 2/65 [00:05<02:35,  2.47s/it]  5%|▍         | 3/65 [00:06<01:37,  1.57s/it]  6%|▌         | 4/65 [00:06<01:10,  1.15s/it]  8%|▊         | 5/65 [00:07<00:59,  1.02it/s]  9%|▉         | 6/65 [00:07<00:48,  1.22it/s] 11%|█         | 7/65 [00:08<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.86it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.91it/s] 20%|██        | 13/65 [00:11<00:26,  1.95it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.98it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.81it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.87it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:14<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.02it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.03it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.04it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.84it/s] 40%|████      | 26/65 [00:17<00:20,  1.90it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.94it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.97it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.99it/s] 46%|████▌     | 30/65 [00:19<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.03it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.04it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.85it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.90it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.95it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.97it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:24<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.03it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.04it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.04it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.05it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.85it/s] 71%|███████   | 46/65 [00:28<00:10,  1.90it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.84it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.89it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.9211662755562708
spatial_difference_train: 16.74179969934317
total_train: 17.662965928591216
time taken to perform 2: 37.78
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<06:09,  5.78s/it]  3%|▎         | 2/65 [00:06<02:48,  2.68s/it]  5%|▍         | 3/65 [00:06<01:44,  1.69s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.63it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.73it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.81it/s] 20%|██        | 13/65 [00:11<00:27,  1.87it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:19<00:19,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.89it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.94it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 3/3_____

mask_train: 0.8224047391842573
spatial_difference_train: 15.73238878494654
total_train: 16.55479349478697
time taken to perform 3: 38.53
[19.875579540546124, 17.662965928591216, 16.55479349478697]
Using minimum loss from history: 16.55479349478697
[I 2025-02-18 02:14:35,960] Trial 45 finished with value: 16.55479349478697 and parameters: {'lr_init_phase2': 0.00029844125892640146, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.003917356351641428, 'lr_gamma_phase2': 0.9485299421205503, 'lr_step_phase2': 1000, 'lr_warmup_phase2': 600}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_021239-k1ci6n7h
wandb: Find logs at: ./wandb/offline-run-20250218_021239-k1ci6n7h/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:03,  4.75s/it]  3%|▎         | 2/65 [00:05<02:31,  2.41s/it]  5%|▍         | 3/65 [00:06<01:38,  1.58s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:55,  1.08it/s]  9%|▉         | 6/65 [00:07<00:46,  1.27it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.59it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.70it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:12<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:23,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.82it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.01it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:20<00:18,  1.85it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.90it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  2.00it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.01it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.02it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.85it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.90it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.94it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  2.00it/s] 71%|███████   | 46/65 [00:28<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.85it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.90it/s] 80%|████████  | 52/65 [00:31<00:06,  1.94it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  2.00it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.02it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 1/3_____

mask_train: 1.1374865220143244
spatial_difference_train: 19.19693327683669
total_train: 20.334419690645657
time taken to perform 1: 37.82
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:24,  5.07s/it]  3%|▎         | 2/65 [00:05<02:30,  2.39s/it]  5%|▍         | 3/65 [00:06<01:35,  1.53s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:09<00:31,  1.77it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.95it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.80it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.86it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.91it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.94it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:23,  1.80it/s] 35%|███▌      | 23/65 [00:16<00:22,  1.86it/s] 37%|███▋      | 24/65 [00:17<00:21,  1.91it/s] 38%|███▊      | 25/65 [00:17<00:22,  1.77it/s] 40%|████      | 26/65 [00:18<00:21,  1.84it/s] 42%|████▏     | 27/65 [00:18<00:20,  1.89it/s] 43%|████▎     | 28/65 [00:19<00:19,  1.93it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.95it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.97it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.00it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.83it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.88it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.92it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.00it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.00it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:38<00:00,  1.82it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 0.9340704170557169
spatial_difference_train: 17.175385541182298
total_train: 18.109455886253944
time taken to perform 2: 38.24
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:20,  5.01s/it]  3%|▎         | 2/65 [00:05<02:28,  2.36s/it]  5%|▍         | 3/65 [00:06<01:33,  1.51s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:53,  1.11it/s]  9%|▉         | 6/65 [00:07<00:45,  1.31it/s] 11%|█         | 7/65 [00:08<00:39,  1.48it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.62it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.72it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.66it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.76it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.83it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:14<00:24,  1.84it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.93it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.96it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:19<00:19,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:27<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.85it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.90it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  2.00it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 3/3_____

mask_train: 0.832794173558553
spatial_difference_train: 16.089887946691267
total_train: 16.92268208723802
time taken to perform 3: 37.63
[20.334419690645657, 18.109455886253944, 16.92268208723802]
Using minimum loss from history: 16.92268208723802
[I 2025-02-18 02:16:31,549] Trial 46 finished with value: 16.92268208723802 and parameters: {'lr_init_phase2': 0.00025558838371316785, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.003315764645119664, 'lr_gamma_phase2': 0.9147122776308068, 'lr_step_phase2': 1500, 'lr_warmup_phase2': 200}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_021436-hoe9unyx
wandb: Find logs at: ./wandb/offline-run-20250218_021436-hoe9unyx/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:03,  4.75s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:41,  1.64s/it]  6%|▌         | 4/65 [00:06<01:12,  1.19s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.43it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:34,  1.61it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:10<00:29,  1.80it/s] 20%|██        | 13/65 [00:11<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:21<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.80it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.86it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.94it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.96it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.71it/s]

______epoch summary 1/3_____

mask_train: 1.1442505148740916
spatial_difference_train: 19.372287427462066
total_train: 20.516537974430964
time taken to perform 1: 38.06
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:04<05:04,  4.76s/it]  3%|▎         | 2/65 [00:05<02:22,  2.27s/it]  5%|▍         | 3/65 [00:05<01:31,  1.47s/it]  6%|▌         | 4/65 [00:06<01:06,  1.10s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:07<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.78it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.90it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.79it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.85it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.90it/s] 28%|██▊       | 18/65 [00:13<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:14<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.82it/s] 40%|████      | 26/65 [00:17<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.91it/s] 43%|████▎     | 28/65 [00:18<00:19,  1.94it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.96it/s] 46%|████▌     | 30/65 [00:19<00:17,  1.98it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.99it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.00it/s] 51%|█████     | 33/65 [00:21<00:15,  2.01it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.01it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.82it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.87it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.91it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.94it/s] 60%|██████    | 39/65 [00:24<00:13,  1.96it/s] 62%|██████▏   | 40/65 [00:24<00:12,  1.98it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.99it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.99it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.00it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.01it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.82it/s] 71%|███████   | 46/65 [00:28<00:10,  1.87it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.91it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.94it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.98it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.99it/s] 80%|████████  | 52/65 [00:31<00:06,  1.99it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.99it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.99it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.81it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.87it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.91it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.94it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.96it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.98it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.99it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.00it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.00it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.01it/s]100%|██████████| 65/65 [00:37<00:00,  1.83it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.9398374919707958
spatial_difference_train: 17.351953961299017
total_train: 18.29179146840022
time taken to perform 2: 37.86
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:20,  5.01s/it]  3%|▎         | 2/65 [00:05<02:28,  2.36s/it]  5%|▍         | 3/65 [00:06<01:34,  1.52s/it]  6%|▌         | 4/65 [00:06<01:08,  1.12s/it]  8%|▊         | 5/65 [00:07<00:54,  1.11it/s]  9%|▉         | 6/65 [00:07<00:45,  1.30it/s] 11%|█         | 7/65 [00:08<00:39,  1.47it/s] 12%|█▏        | 8/65 [00:08<00:35,  1.61it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.73it/s] 15%|█▌        | 10/65 [00:09<00:33,  1.66it/s] 17%|█▋        | 11/65 [00:10<00:30,  1.76it/s] 18%|█▊        | 12/65 [00:10<00:28,  1.84it/s] 20%|██        | 13/65 [00:11<00:27,  1.90it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.93it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.96it/s] 25%|██▍       | 16/65 [00:12<00:24,  1.98it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:13<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:14<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.89it/s] 34%|███▍      | 22/65 [00:15<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:16<00:20,  1.98it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:17<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.01it/s] 43%|████▎     | 28/65 [00:18<00:18,  2.02it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.02it/s] 46%|████▌     | 30/65 [00:19<00:18,  1.84it/s] 48%|████▊     | 31/65 [00:20<00:17,  1.89it/s] 49%|████▉     | 32/65 [00:20<00:17,  1.93it/s] 51%|█████     | 33/65 [00:21<00:16,  1.96it/s] 52%|█████▏    | 34/65 [00:21<00:15,  1.98it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:22<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.01it/s] 58%|█████▊    | 38/65 [00:23<00:13,  2.02it/s] 60%|██████    | 39/65 [00:24<00:12,  2.02it/s] 62%|██████▏   | 40/65 [00:24<00:13,  1.84it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.89it/s] 65%|██████▍   | 42/65 [00:25<00:11,  1.93it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.96it/s] 68%|██████▊   | 44/65 [00:26<00:10,  1.98it/s] 69%|██████▉   | 45/65 [00:27<00:10,  2.00it/s] 71%|███████   | 46/65 [00:27<00:09,  2.01it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.01it/s] 74%|███████▍  | 48/65 [00:28<00:08,  2.02it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.02it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.84it/s] 78%|███████▊  | 51/65 [00:30<00:07,  1.89it/s] 80%|████████  | 52/65 [00:31<00:06,  1.93it/s] 82%|████████▏ | 53/65 [00:31<00:06,  1.96it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.98it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  2.01it/s] 88%|████████▊ | 57/65 [00:33<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.02it/s] 91%|█████████ | 59/65 [00:34<00:02,  2.02it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.84it/s] 94%|█████████▍| 61/65 [00:35<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:36<00:01,  1.96it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.98it/s]100%|██████████| 65/65 [00:37<00:00,  1.99it/s]100%|██████████| 65/65 [00:37<00:00,  1.73it/s]

______epoch summary 3/3_____

mask_train: 0.8375400876387572
spatial_difference_train: 16.240727199652255
total_train: 17.078267293098644
time taken to perform 3: 37.63
[20.516537974430964, 18.29179146840022, 17.078267293098644]
Using minimum loss from history: 17.078267293098644
[I 2025-02-18 02:18:26,851] Trial 47 finished with value: 17.078267293098644 and parameters: {'lr_init_phase2': 0.0002403328270602025, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.00213078495976099, 'lr_gamma_phase2': 0.9340037140008219, 'lr_step_phase2': 2000, 'lr_warmup_phase2': 2000}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_021631-l322z038
wandb: Find logs at: ./wandb/offline-run-20250218_021631-l322z038/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]initializing warmup
  2%|▏         | 1/65 [00:04<05:13,  4.90s/it]  3%|▎         | 2/65 [00:05<02:47,  2.66s/it]  5%|▍         | 3/65 [00:06<01:44,  1.68s/it]  6%|▌         | 4/65 [00:07<01:14,  1.22s/it]  8%|▊         | 5/65 [00:07<00:57,  1.04it/s]finished warmup
  9%|▉         | 6/65 [00:08<00:47,  1.24it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.56it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.60it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.71it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.79it/s] 20%|██        | 13/65 [00:11<00:28,  1.85it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.93it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.97it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:15<00:25,  1.79it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.85it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.95it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.97it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.98it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.98it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.97it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.79it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.86it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.90it/s] 51%|█████     | 33/65 [00:22<00:16,  1.93it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.97it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.00it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.88it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.2509073239106399
spatial_difference_train: 20.21729548527644
total_train: 21.468202972412108
time taken to perform 1: 38.43
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:40,  5.31s/it]  3%|▎         | 2/65 [00:05<02:36,  2.49s/it]  5%|▍         | 3/65 [00:06<01:38,  1.59s/it]  6%|▌         | 4/65 [00:06<01:10,  1.16s/it]  8%|▊         | 5/65 [00:07<00:59,  1.01it/s]  9%|▉         | 6/65 [00:08<00:48,  1.21it/s] 11%|█         | 7/65 [00:08<00:41,  1.39it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:31,  1.76it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.84it/s] 18%|█▊        | 12/65 [00:11<00:28,  1.89it/s] 20%|██        | 13/65 [00:11<00:26,  1.93it/s] 22%|██▏       | 14/65 [00:11<00:26,  1.96it/s] 23%|██▎       | 15/65 [00:12<00:28,  1.77it/s] 25%|██▍       | 16/65 [00:13<00:26,  1.84it/s] 26%|██▌       | 17/65 [00:13<00:25,  1.89it/s] 28%|██▊       | 18/65 [00:14<00:24,  1.93it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.96it/s] 31%|███       | 20/65 [00:15<00:22,  1.98it/s] 32%|███▏      | 21/65 [00:15<00:22,  1.99it/s] 34%|███▍      | 22/65 [00:16<00:21,  2.00it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.01it/s] 37%|███▋      | 24/65 [00:17<00:20,  2.01it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.83it/s] 40%|████      | 26/65 [00:18<00:20,  1.88it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.92it/s] 43%|████▎     | 28/65 [00:19<00:18,  1.95it/s] 45%|████▍     | 29/65 [00:19<00:18,  1.98it/s] 46%|████▌     | 30/65 [00:20<00:17,  1.99it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.00it/s] 49%|████▉     | 32/65 [00:21<00:16,  2.01it/s] 51%|█████     | 33/65 [00:21<00:15,  2.02it/s] 52%|█████▏    | 34/65 [00:22<00:15,  2.02it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.84it/s] 55%|█████▌    | 36/65 [00:23<00:15,  1.89it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.93it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.95it/s] 60%|██████    | 39/65 [00:24<00:13,  1.97it/s] 62%|██████▏   | 40/65 [00:25<00:12,  1.99it/s] 63%|██████▎   | 41/65 [00:25<00:12,  2.00it/s] 65%|██████▍   | 42/65 [00:26<00:11,  2.01it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.01it/s] 68%|██████▊   | 44/65 [00:27<00:10,  2.02it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.83it/s] 71%|███████   | 46/65 [00:28<00:10,  1.88it/s] 72%|███████▏  | 47/65 [00:29<00:09,  1.92it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.95it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.97it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:07,  2.00it/s] 80%|████████  | 52/65 [00:31<00:06,  2.00it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.01it/s] 83%|████████▎ | 54/65 [00:32<00:05,  2.01it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.82it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.88it/s] 88%|████████▊ | 57/65 [00:34<00:04,  1.92it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.95it/s] 91%|█████████ | 59/65 [00:35<00:03,  1.97it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.99it/s] 94%|█████████▍| 61/65 [00:36<00:02,  2.00it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:37<00:00,  2.01it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:38<00:00,  1.84it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 2/3_____

mask_train: 1.0278585493564605
spatial_difference_train: 18.881943952120267
total_train: 19.909802598219652
time taken to perform 2: 38.24
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:50,  5.48s/it]  3%|▎         | 2/65 [00:05<02:41,  2.56s/it]  5%|▍         | 3/65 [00:06<01:40,  1.62s/it]  6%|▌         | 4/65 [00:07<01:12,  1.18s/it]  8%|▊         | 5/65 [00:07<00:56,  1.06it/s]  9%|▉         | 6/65 [00:08<00:46,  1.26it/s] 11%|█         | 7/65 [00:08<00:40,  1.44it/s] 12%|█▏        | 8/65 [00:09<00:35,  1.58it/s] 14%|█▍        | 9/65 [00:09<00:32,  1.70it/s] 15%|█▌        | 10/65 [00:10<00:33,  1.64it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.74it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.82it/s] 20%|██        | 13/65 [00:11<00:27,  1.88it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.92it/s] 23%|██▎       | 15/65 [00:12<00:25,  1.95it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.97it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.99it/s] 28%|██▊       | 18/65 [00:14<00:23,  2.00it/s] 29%|██▉       | 19/65 [00:14<00:22,  2.01it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:15<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:16<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:17<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:18<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:19<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.83it/s] 48%|████▊     | 31/65 [00:20<00:18,  1.88it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.92it/s] 51%|█████     | 33/65 [00:21<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:22<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:23<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:24<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:25<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:26<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:26<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.99it/s] 71%|███████   | 46/65 [00:28<00:09,  2.00it/s] 72%|███████▏  | 47/65 [00:28<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:29<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:31<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:35<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:36<00:01,  1.93it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:37<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.99it/s]100%|██████████| 65/65 [00:38<00:00,  1.70it/s]

______epoch summary 3/3_____

mask_train: 0.9398811856905619
spatial_difference_train: 18.203677955040565
total_train: 19.14355920644907
time taken to perform 3: 38.21
[21.468202972412108, 19.909802598219652, 19.14355920644907]
Using minimum loss from history: 19.14355920644907
[I 2025-02-18 02:20:23,613] Trial 48 finished with value: 19.14355920644907 and parameters: {'lr_init_phase2': 0.0002783361804333719, 'lr_policy_phase3': 'SGDR', 'weight_decay_phase2': 0.002649464920560148, 'lr_gamma_phase2': 0.9556989949010829, 'lr_step_phase2': 2500, 'lr_warmup_phase2': 1400}. Best is trial 26 with value: 16.546065623943623.
/pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/splits/ENIGMA_OCD/ENIGMA_OCD_reconstruction_ROI_316_seq_len_700_split1.txt
loading splits
length of train_idx: 2094
length of val_idx: 0
length of test_idx: 0
workers: 32
length of training generator is: 65
self.task: MBBN_pretraining
Number of parameters of the model: 25078192
There are no checkpoints or weights from previous steps
Single GPU or CPU training
self.gpu: None
self.device: cuda
moved model to: cuda:0
mbbn_pretraining
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_021827-fy912ol2
wandb: Find logs at: ./wandb/offline-run-20250218_021827-fy912ol2/logs
wandb: Tracking run with wandb version 0.19.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
using mask loss
using spatial_difference loss
Starting epoch 1/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:59,  5.62s/it]  3%|▎         | 2/65 [00:06<02:44,  2.62s/it]  5%|▍         | 3/65 [00:06<01:42,  1.65s/it]  6%|▌         | 4/65 [00:07<01:13,  1.20s/it]  8%|▊         | 5/65 [00:07<00:57,  1.05it/s]  9%|▉         | 6/65 [00:08<00:47,  1.25it/s] 11%|█         | 7/65 [00:08<00:40,  1.42it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.68it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.58it/s] 17%|█▋        | 11/65 [00:10<00:31,  1.69it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.78it/s] 20%|██        | 13/65 [00:11<00:28,  1.84it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.89it/s] 23%|██▎       | 15/65 [00:12<00:26,  1.92it/s] 25%|██▍       | 16/65 [00:13<00:25,  1.95it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.96it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.98it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.98it/s] 31%|███       | 20/65 [00:15<00:24,  1.80it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.86it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.90it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.93it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.95it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.97it/s] 40%|████      | 26/65 [00:18<00:19,  1.98it/s] 42%|████▏     | 27/65 [00:19<00:19,  1.99it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.00it/s] 45%|████▍     | 29/65 [00:20<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.81it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.94it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.96it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.98it/s] 55%|█████▌    | 36/65 [00:23<00:14,  1.99it/s] 57%|█████▋    | 37/65 [00:24<00:13,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  2.01it/s] 60%|██████    | 39/65 [00:25<00:12,  2.01it/s] 62%|██████▏   | 40/65 [00:25<00:13,  1.82it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.87it/s] 65%|██████▍   | 42/65 [00:26<00:12,  1.91it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:27<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:28<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:09,  2.00it/s] 74%|███████▍  | 48/65 [00:29<00:08,  2.00it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:30<00:08,  1.82it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.87it/s] 80%|████████  | 52/65 [00:31<00:06,  1.91it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:32<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.98it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.99it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.00it/s] 89%|████████▉ | 58/65 [00:34<00:03,  2.01it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.82it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.87it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.69it/s]

______epoch summary 1/3_____

mask_train: 1.1252935106937703
spatial_difference_train: 18.737053357637844
total_train: 19.862346766545222
time taken to perform 1: 38.57
Starting epoch 2/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:05<05:26,  5.10s/it]  3%|▎         | 2/65 [00:05<02:31,  2.40s/it]  5%|▍         | 3/65 [00:06<01:35,  1.54s/it]  6%|▌         | 4/65 [00:06<01:08,  1.13s/it]  8%|▊         | 5/65 [00:07<00:58,  1.03it/s]  9%|▉         | 6/65 [00:07<00:47,  1.23it/s] 11%|█         | 7/65 [00:08<00:41,  1.41it/s] 12%|█▏        | 8/65 [00:08<00:36,  1.57it/s] 14%|█▍        | 9/65 [00:09<00:33,  1.69it/s] 15%|█▌        | 10/65 [00:09<00:30,  1.79it/s] 17%|█▋        | 11/65 [00:10<00:29,  1.86it/s] 18%|█▊        | 12/65 [00:10<00:27,  1.91it/s] 20%|██        | 13/65 [00:11<00:26,  1.95it/s] 22%|██▏       | 14/65 [00:11<00:25,  1.98it/s] 23%|██▎       | 15/65 [00:12<00:27,  1.82it/s] 25%|██▍       | 16/65 [00:12<00:26,  1.88it/s] 26%|██▌       | 17/65 [00:13<00:24,  1.92it/s] 28%|██▊       | 18/65 [00:13<00:23,  1.96it/s] 29%|██▉       | 19/65 [00:14<00:23,  1.99it/s] 31%|███       | 20/65 [00:14<00:22,  2.00it/s] 32%|███▏      | 21/65 [00:15<00:21,  2.02it/s] 34%|███▍      | 22/65 [00:15<00:21,  2.03it/s] 35%|███▌      | 23/65 [00:16<00:20,  2.03it/s] 37%|███▋      | 24/65 [00:16<00:20,  2.04it/s] 38%|███▊      | 25/65 [00:17<00:21,  1.85it/s] 40%|████      | 26/65 [00:17<00:20,  1.90it/s] 42%|████▏     | 27/65 [00:18<00:19,  1.95it/s] 43%|████▎     | 28/65 [00:18<00:18,  1.98it/s] 45%|████▍     | 29/65 [00:19<00:18,  2.00it/s] 46%|████▌     | 30/65 [00:19<00:17,  2.01it/s] 48%|████▊     | 31/65 [00:20<00:16,  2.02it/s] 49%|████▉     | 32/65 [00:20<00:16,  2.03it/s] 51%|█████     | 33/65 [00:21<00:15,  2.04it/s] 52%|█████▏    | 34/65 [00:21<00:15,  2.04it/s] 54%|█████▍    | 35/65 [00:22<00:16,  1.86it/s] 55%|█████▌    | 36/65 [00:22<00:15,  1.91it/s] 57%|█████▋    | 37/65 [00:23<00:14,  1.95it/s] 58%|█████▊    | 38/65 [00:23<00:13,  1.98it/s] 60%|██████    | 39/65 [00:24<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:24<00:12,  2.01it/s] 63%|██████▎   | 41/65 [00:25<00:11,  2.02it/s] 65%|██████▍   | 42/65 [00:25<00:11,  2.03it/s] 66%|██████▌   | 43/65 [00:26<00:10,  2.03it/s] 68%|██████▊   | 44/65 [00:26<00:10,  2.03it/s] 69%|██████▉   | 45/65 [00:27<00:10,  1.85it/s] 71%|███████   | 46/65 [00:28<00:10,  1.90it/s] 72%|███████▏  | 47/65 [00:28<00:09,  1.93it/s] 74%|███████▍  | 48/65 [00:29<00:08,  1.96it/s] 75%|███████▌  | 49/65 [00:29<00:08,  1.98it/s] 77%|███████▋  | 50/65 [00:30<00:07,  1.99it/s] 78%|███████▊  | 51/65 [00:30<00:06,  2.01it/s] 80%|████████  | 52/65 [00:31<00:06,  2.01it/s] 82%|████████▏ | 53/65 [00:31<00:05,  2.02it/s] 83%|████████▎ | 54/65 [00:31<00:05,  2.02it/s] 85%|████████▍ | 55/65 [00:32<00:05,  1.85it/s] 86%|████████▌ | 56/65 [00:33<00:04,  1.90it/s] 88%|████████▊ | 57/65 [00:33<00:04,  1.93it/s] 89%|████████▉ | 58/65 [00:34<00:03,  1.96it/s] 91%|█████████ | 59/65 [00:34<00:03,  1.98it/s] 92%|█████████▏| 60/65 [00:35<00:02,  2.00it/s] 94%|█████████▍| 61/65 [00:35<00:01,  2.01it/s] 95%|█████████▌| 62/65 [00:36<00:01,  2.01it/s] 97%|█████████▋| 63/65 [00:36<00:00,  2.02it/s] 98%|█████████▊| 64/65 [00:37<00:00,  2.02it/s]100%|██████████| 65/65 [00:37<00:00,  1.84it/s]100%|██████████| 65/65 [00:37<00:00,  1.72it/s]

______epoch summary 2/3_____

mask_train: 0.9207626539927263
spatial_difference_train: 16.729736650907075
total_train: 17.65049922649677
time taken to perform 2: 37.74
Starting epoch 3/3
max allocated memory: 29054.95 MB
max cached memory: 30278.00 MB
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:06<06:23,  6.00s/it]  3%|▎         | 2/65 [00:06<02:54,  2.77s/it]  5%|▍         | 3/65 [00:07<01:47,  1.74s/it]  6%|▌         | 4/65 [00:07<01:16,  1.25s/it]  8%|▊         | 5/65 [00:08<00:59,  1.02it/s]  9%|▉         | 6/65 [00:08<00:48,  1.22it/s] 11%|█         | 7/65 [00:09<00:41,  1.40it/s] 12%|█▏        | 8/65 [00:09<00:36,  1.55it/s] 14%|█▍        | 9/65 [00:10<00:33,  1.67it/s] 15%|█▌        | 10/65 [00:10<00:34,  1.62it/s] 17%|█▋        | 11/65 [00:11<00:31,  1.72it/s] 18%|█▊        | 12/65 [00:11<00:29,  1.80it/s] 20%|██        | 13/65 [00:12<00:27,  1.86it/s] 22%|██▏       | 14/65 [00:12<00:26,  1.91it/s] 23%|██▎       | 15/65 [00:13<00:25,  1.94it/s] 25%|██▍       | 16/65 [00:13<00:24,  1.96it/s] 26%|██▌       | 17/65 [00:14<00:24,  1.98it/s] 28%|██▊       | 18/65 [00:14<00:23,  1.99it/s] 29%|██▉       | 19/65 [00:15<00:22,  2.00it/s] 31%|███       | 20/65 [00:15<00:24,  1.83it/s] 32%|███▏      | 21/65 [00:16<00:23,  1.88it/s] 34%|███▍      | 22/65 [00:16<00:22,  1.92it/s] 35%|███▌      | 23/65 [00:17<00:21,  1.95it/s] 37%|███▋      | 24/65 [00:17<00:20,  1.97it/s] 38%|███▊      | 25/65 [00:18<00:20,  1.99it/s] 40%|████      | 26/65 [00:18<00:19,  2.00it/s] 42%|████▏     | 27/65 [00:19<00:18,  2.00it/s] 43%|████▎     | 28/65 [00:19<00:18,  2.01it/s] 45%|████▍     | 29/65 [00:20<00:17,  2.01it/s] 46%|████▌     | 30/65 [00:20<00:19,  1.82it/s] 48%|████▊     | 31/65 [00:21<00:18,  1.87it/s] 49%|████▉     | 32/65 [00:21<00:17,  1.91it/s] 51%|█████     | 33/65 [00:22<00:16,  1.95it/s] 52%|█████▏    | 34/65 [00:22<00:15,  1.97it/s] 54%|█████▍    | 35/65 [00:23<00:15,  1.99it/s] 55%|█████▌    | 36/65 [00:23<00:14,  2.00it/s] 57%|█████▋    | 37/65 [00:24<00:14,  2.00it/s] 58%|█████▊    | 38/65 [00:24<00:13,  1.99it/s] 60%|██████    | 39/65 [00:25<00:13,  2.00it/s] 62%|██████▏   | 40/65 [00:26<00:13,  1.83it/s] 63%|██████▎   | 41/65 [00:26<00:12,  1.88it/s] 65%|██████▍   | 42/65 [00:27<00:11,  1.92it/s] 66%|██████▌   | 43/65 [00:27<00:11,  1.95it/s] 68%|██████▊   | 44/65 [00:28<00:10,  1.97it/s] 69%|██████▉   | 45/65 [00:28<00:10,  1.98it/s] 71%|███████   | 46/65 [00:29<00:09,  1.99it/s] 72%|███████▏  | 47/65 [00:29<00:08,  2.00it/s] 74%|███████▍  | 48/65 [00:30<00:08,  2.01it/s] 75%|███████▌  | 49/65 [00:30<00:07,  2.01it/s] 77%|███████▋  | 50/65 [00:31<00:08,  1.83it/s] 78%|███████▊  | 51/65 [00:31<00:07,  1.88it/s] 80%|████████  | 52/65 [00:32<00:06,  1.92it/s] 82%|████████▏ | 53/65 [00:32<00:06,  1.95it/s] 83%|████████▎ | 54/65 [00:33<00:05,  1.97it/s] 85%|████████▍ | 55/65 [00:33<00:05,  1.99it/s] 86%|████████▌ | 56/65 [00:34<00:04,  2.00it/s] 88%|████████▊ | 57/65 [00:34<00:03,  2.01it/s] 89%|████████▉ | 58/65 [00:35<00:03,  2.00it/s] 91%|█████████ | 59/65 [00:35<00:02,  2.01it/s] 92%|█████████▏| 60/65 [00:36<00:02,  1.83it/s] 94%|█████████▍| 61/65 [00:36<00:02,  1.89it/s] 95%|█████████▌| 62/65 [00:37<00:01,  1.92it/s] 97%|█████████▋| 63/65 [00:37<00:01,  1.95it/s] 98%|█████████▊| 64/65 [00:38<00:00,  1.97it/s]100%|██████████| 65/65 [00:38<00:00,  1.98it/s]100%|██████████| 65/65 [00:38<00:00,  1.68it/s]

______epoch summary 3/3_____

mask_train: 0.8219393727106926
spatial_difference_train: 15.722681025969676
total_train: 16.544620318290516
time taken to perform 3: 38.77
[19.862346766545222, 17.65049922649677, 16.544620318290516]
Using minimum loss from history: 16.544620318290516
[I 2025-02-18 02:22:20,613] Trial 49 finished with value: 16.544620318290516 and parameters: {'lr_init_phase2': 0.0002997629843186465, 'lr_policy_phase3': 'step', 'weight_decay_phase2': 0.003943007063831548, 'lr_gamma_phase2': 0.9312175695276039, 'lr_step_phase2': 3500, 'lr_warmup_phase2': 400}. Best is trial 49 with value: 16.544620318290516.
Best trial:
  Value:  16.544620318290516
  Params: 
    lr_init_phase2: 0.0002997629843186465
    lr_policy_phase3: step
    weight_decay_phase2: 0.003943007063831548
    lr_gamma_phase2: 0.9312175695276039
    lr_step_phase2: 3500
    lr_warmup_phase2: 400
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /pscratch/sd/p/pakmasha/ENIGMA_OCD_MBBN_git/ENIGMA_OCD_MBBN/MBBN-main/wandb/offline-run-20250218_022023-eg875lhl[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250218_022023-eg875lhl/logs[0m
